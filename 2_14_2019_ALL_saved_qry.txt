



SELECT * FROM STG_INVOICE_DETAILS  ----DOP
SELECT * FROM INVOICE_DETAILS WHERE INVOICE_ID =  1022  1058  ---  CT1071BAQAINTPR7004   inv for pi srv and multiple advance recoupment
ORDER BY CREATED_DATE DESC
SELECT * FROM INVOICE
---WHERE INVOICE_ID = 1059   ----1058
WHERE INVOICE_NUMBER = '180100828'  INVOICE_ID = 1022
----  
-------------------------------------
----DISBURSE Invoice - budget advance
---
---
--- PAYMENT_ID PAYMENT_VOUCHER_NUM ----budget advance---
8128	180100890A1
8129	180100891A1
8127	180100889A1
---1st set of queries
SELECT * FROM PAYMENT
ORDER BY CREATED_DATE DESC;    ---165009

update  PAYMENT set STATUS_ID =65,DISBURSEMENT_DATE = '31-JAN-2018',CHECK_EFT_NUM = 'MANUAL000000030',PROCESS_FLAG=0,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where PAYMENT_ID = 165008;   ---- 8128;
commit;
update  PAYMENT set STATUS_ID =65,DISBURSEMENT_DATE = '31-JAN-2018',CHECK_EFT_NUM = 'MANUAL000000030',PROCESS_FLAG=0,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where PAYMENT_ID = 8129;
commit;
update  PAYMENT set STATUS_ID =65,DISBURSEMENT_DATE = '31-JAN-2018',CHECK_EFT_NUM = 'MANUAL000000030',PROCESS_FLAG=0,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where PAYMENT_ID = 8127;
commit;
--2nd set of queries to disburse the budget advance so that invoice can be recoup against
SELECT * FROM BUDGET_ADVANCE ORDER BY CREATED_DATE DESC; 

update BUDGET_ADVANCE set PREV_STATUS_ID= 93,STATUS_ID = 125,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where BUDGET_ADVANCE_ID IN (12578);
----(4361,4362,4363);
commit;
-----2nd query
---
---

---

SELECT * FROM PAYMENT ORDEr BY CREATED_DATE DESC 
WHERE PAYMENT_VOUCHER_NUM = '180100889A1'  
8128

'180100888P1'   PAYMENT_ID = 8107   '180100869P1' PAYMENT_ID = 7927

SELECT * FROM SUB_BUDGET
WHERE SUB_BUDGET_ID = 70192  

SELECT * FROM SUB_BUDGET
WHERE SUB_BUDGET_ID = 70065  70068


SELECT * FROM PROGRAM_INCOME
WHERE SUB_BUDGET_ID = 70192

SELECT ENTRY_TYPE_ID, ENTRY_TYPE FROM ENTRY_TYPE_MASTER 
WHERE ENTRY_TYPE_ID IN (11,1)

SELECT * FROM INVOICE_COST_CENTER_DETAILS
ORDER BY CREATED_DATE DESC 

SELECT * FROM INVOICE_SERVICES_DETAILS
ORDER BY CREATED_DATE DESC 

SELECT * FROM BUDGET
WHERE BUDGET_ID = 8707

SELECT * FROM PAYMENT  ORDER BY CREATED_DATE DESC 
WHERE PAYMENT_VOUCHER_NUM = '180100885A1' '150800327A1'        '180100884P1'

SELECT * FROM BUDGET_ADVANCE
ORDER BY CREATED_DATE DESC 

CONTRACT_ID = 40024   CT1071BAQAINTPR7003	 IN TST2 DHS 
BUDGET_ID = 8712

SELECT * FROM STG_ADVANCE_INFORMATION

SELECT * FROM INTERFACE_ERROR_MASTER
ORDER BY ERROR_CODE

SELECT * FROM STG_APT_EPIN

SELECT * FROM CONTRACT
WHERE CONTRACT_ID IN (25273,25275,25274)

SELECT * FROM BUDGET
WHERE CONTRACT_ID IN (25273,25275,25274)


SELECT * FROM PAYMENT ORDER BY CREATED_DATE DESC  7889
WHERE PAYMENT_VOUCHER_NUM IN ('180100869P1'

8013
8012
8011
8010
8009
8008
8007
60639999123654483370
60639999123654483371
60639999123654483372
60639999123654483373
60639999123654483374
60639999123654483375
60639999123654483376

Agency Advance Inbound 1_30_2018 
CT1071BAQAINTPR7004 used DHS

SELECT * FROM CONTRACT '
WHERE CONTRACT_TITLE IN ( 'Auto CONT 004 , 'BAQA Post-R7 Interface - PI and SVS')

SELECT * FROM CONTRACT 
WHERE EXT_EPIN = 'CT1071BAQAINTPR7004' 

UPDATE CONTRACT 
SET ORGANIZATION_ID = 'Org_4981'
WHERE CONTRACT_ID = 38523;
COMMIT;

SELECT * FROM BUDGET
where CONTRACT_ID = 38523  BUDGET_ID = 9030

SELECT * FROM PAYMENT
WHERE PAYMENT_ID = 4867

SELECT * FROM REF_PAYMENT_INFORMATION
ORDER BY ETL_PROCESSED_DATE DESC 

SELECT COUNT(*), PAYMENT_ID 
FROM REF_PAYMENT_INFORMATION
GROUP BY PAYMENT_ID 
HAVING COUNT(PAYMENT_ID) > 1;

SELECT * FROM REF_PAYMENT_INFORMATION
WHERE PAYMENT_ID NOT IN (1827,1828
,1847
,1848
,1872
,1873
,1874
,1875
,1907
,1908
,1909
,1910
,1911
,1913
,1914
,1947
,1987
,2167
,2211
,2212
,2214
,2215
,2216
,2234
,2248
,2407
,2408
,2750
,2751
,2753
,2847
,3007
,3070
,3071
,3388
,3410
,3411
,3947
,3948
,4127
,4128
,4167
,4407
,4408
,4867)

WITH SUB_BUDGET_DETAILS AS
(SELECT
SS.FK_ID,
SS.FISCAL_YEAR,
SUM(SS.SUB_BUDGET_AMOUNT) AS FISCAL_YEAR_AMOUNT  FROM STG_SUBBUDGET SS GROUP BY SS.FK_ID,SS.FISCAL_YEAR
)
SELECT
SEQ_BUDGET_ID.NEXTVAL as BUDGET_ID,
'1' as BUDGET_TYPE_ID,
C.CONTRACT_ID,
SS.FISCAL_YEAR AS FISCAL_YEAR_ID,
SS.FISCAL_YEAR_AMOUNT,
C.AGENCY_ID,
C.ORGANIZATION_ID,
C.PROGRAM_ID,
TO_DATE('01-JUL-'||SS.FISCAL_YEAR,'DD-MON-YY') as BUDGET_START_DATE,
TO_DATE('30-JUN-'||(SS.FISCAL_YEAR+1),'DD-MON-YY') as BUDGET_END_DATE, (SELECT BUDGET_ID FROM BUDGET WHERE CONTRACT_ID=C.PARENT_CONTRACT_ID AND FISCAL_YEAR_ID=SS.FISCAL_YEAR AND DELETE_FLAG=0 AND ACTIVE_FLAG=1) AS PARENT_ID, C.EXT_CT_NUMBER FROM STG_CONTRACT_INFORMATION SCI,
  SUB_BUDGET_DETAILS SS,CONTRACT C
WHERE SCI.PK_ID=SS.FK_ID
AND C.EXT_EPIN=SCI.EXT_EPIN
AND C.EXT_CT_NUMBER=SCI.EXT_CT_NUMBER
AND C.CONTRACT_TYPE_ID!=6
and C.STATUS_ID=192
AND C.CONTRACT_ID NOT IN (SELECT CONTRACT_ID FROM BUDGET) AND SCI.XML_CHECK = 'True'-- Oracle Fatal Error




UPDATE PAYMENT 
SET PROCESS_FLAG = '1'
WHERE PAYMENT_VOUCHER_NUM IN (
'180100819P3',
'180100868A1',
'180100819P1',
'180100825A1',
'180100825A2',
'180100826A1',
'181100675P1',
'180100819P2',
'180100819P4',
'180100823P1',
'180100826A2',
'180100875A1');
COMMIT;

SELECT * FROM PAYMENT 
WHERE PROCESS_FLAG = '1'




SELECT DISTINCT P.AGENCY_ID,
  P.VENDOR_ADDRESS_ID,
  P.BUDGET_FISCAL_YEAR_ID,
  P.PAYMENT_VOUCHER_NUM,
  0 AS DOC_UNIT_CD,
  P.FISCAL_YEAR_ID,
  P.PAYMENT_APPROVED_DATE,
  P.PERIOD,
  P.PAYEE_VENDOR_ADDRESS_ID,
  P.PAYEE_VENDOR_ID,
  PA.PAYMENT_AMOUNT,
  P.PAYMENT_SUBMITTED_DATE,
  P.ORGANIZATION_ID,
  I.INVOICE_START_DATE,
  I.INVOICE_END_DATE,
  nvl(I.INVOICE_SUBMITTED_DATE,I.CREATED_DATE) AS INVOICE_SUBMITTED_DATE,
  I.PROVIDER_INVOICE_NUMBER,
  I.INVOICE_NUMBER,
  PA.ACCOUNTING_LINE,
  NVL(PA.REPORTING_CATEGORY,'null') AS REPORTING_CATEGORY,
  PA.UNIT_OF_APPROPRIATION,
  PA.COMMODITY_LINE,
  '--' AS DOC_VEND_LN_NO,
  PA.BUDGET_CODE,
  PA.FUND_CD AS FUND,
  PA.OBJECT_CODE,
  NVL(PA.RFED_DOC_CD, 'null')     AS REF_DOC_CODE,
  PA.RFED_COMM_LN_NO              AS REF_COMMODITY_LINE,
  PA.RFED_DOC_DEPT_CD             AS REF_DOC_DEPT,
  PA.RFED_DOC_ID                  AS REF_DOC_ID,
  PA.RFED_VEND_LN_NO              AS REF_VENDOR_LINE,
  PA.RFED_ACTG_LN_NO              AS REF_ACCOUNTING_LINE,
  NVL(PA.SUB_OBJECT_CODE, 'null') AS SUB_OBJECT_CODE,
  C.CONTRACT_AMOUNT,
  C.AGENCY_ID AS CONTRACT_AGENCY_ID,
  C.EXT_DOC_VERSION,
  NVL(PA.RFED_DOC_DEPT_CD,'null') AS AGENCY_CODE,
  NVL(RV.VEND_CUST_CD, 'null') VEND_CUST_CD,
  C.EXT_COMMODITY_CODE,
  PA.PAYMENT_ALLOCATION_ID,
  P.PAYMENT_ID,
  P.BUDGET_ADVANCE_ID,
  B.BUDGET_START_DATE,
  P.PAYMENT_VOUCHER_NUM
  || TO_CHAR(TO_NUMBER(PA.COMMODITY_LINE)) AS XPK_PR_DOC_COMM,
  --ROW_NUMBER() OVER (PARTITION BY P.PAYMENT_VOUCHER_NUM ORDER BY 1) AS VEND_INV_LN_NO
  DENSE_RANK() OVER (PARTITION BY P.PAYMENT_VOUCHER_NUM ORDER BY TO_CHAR(TO_NUMBER(PA.COMMODITY_LINE))) AS VEND_INV_LN_NO,
  PA.CL_CODE,
  NVL(IV.DEPT_CD,'null') AS DEPT_CD,
  BA.BUDGET_ADVANCE_NUMBER,
  IV.LN_TYP,
  PA.PAYMENT_AMOUNT AS QTY,
  IV.UNIT_MEAS_CD,
  IV.UNIT_PRICE
FROM HHSA_APP.CONTRACT C,
  HHSA_APP.BUDGET B,
  HHSA_APP.INVOICE I,
  HHSA_APP.PAYMENT P,
  HHSA_APP.ORGANIZATION O,
  HHSA_APP.REF_VENDOR_V R,
  HHSA_APP.PAYMENT_ALLOCATION PA,
  HHSA_APP.BUDGET_ADVANCE BA,
  (SELECT TRIM(DOC_CD
    || DOC_DEPT_CD
    || DOC_ID) AS EXT_CT_NUMBER,
    DEPT_CD,
    DOC_ACTG_LN_NO,
    DOC_COMM_LN_NO,
    QTY,
    UNIT_MEAS_CD,
    UNIT_PRICE,
    LN_TYP
  FROM
    (SELECT A.DOC_CD,
      A.DOC_DEPT_CD,
      A.DOC_ID,
      A.DOC_VERS_NO,
      A.DEPT_CD,
      A.DOC_ACTG_LN_NO,
      A.DOC_COMM_LN_NO,
      RANK() OVER (PARTITION BY A.DOC_CD, A.DOC_DEPT_CD, A.DOC_ID ORDER BY A.DOC_VERS_NO DESC) AS My_Rank,
      C.QTY,
      C.UNIT_MEAS_CD,
      C.UNIT_PRICE,
      C.LN_TYP
    FROM REF_CONTRACTS_A A
    JOIN REF_CONTRACTS_C C
    ON TRIM(A.DOC_CD)          = TRIM(c.DOC_CD)
    AND TRIM(A.DOC_DEPT_CD)    =TRIM(C.DOC_DEPT_CD)
    AND TRIM(A.DOC_ID)         =TRIM(C.DOC_ID)
    AND TRIM(A.DOC_COMM_LN_NO) = TRIM(C.DOC_COMM_LN_NO)
    AND TRIM(A.DOC_VERS_NO)    =TRIM(C.DOC_VERS_NO)
    )
  WHERE My_Rank = 1
  ) IV,
 HHSA_APP.REF_CONTRACTS_V RV
WHERE C.CONTRACT_ID     = B.CONTRACT_ID
AND C.CONTRACT_ID       = P.CONTRACT_ID
AND P.CONTRACT_ID       = I.CONTRACT_ID (+)
AND P.BUDGET_ID         = B.BUDGET_ID
AND P.INVOICE_ID        = I.INVOICE_ID(+)
AND P.ORGANIZATION_ID   = O.ORGANIZATION_ID(+)
AND P.PAYMENT_ID        = PA.PAYMENT_ID
AND O.EIN_ID_NN         = R.TIN(+)
AND P.BUDGET_ADVANCE_ID = BA.BUDGET_ADVANCE_ID(+)
AND PA.RFED_DOC_CD
  || PA.RFED_DOC_DEPT_CD
  || PA. RFED_DOC_ID      = IV.EXT_CT_NUMBER(+)
AND PA.ACCOUNTING_LINE    = IV.DOC_ACTG_LN_NO(+)
AND PA.COMMODITY_LINE     = IV.DOC_COMM_LN_NO(+)
--AND R.VEND_CUST_CD        = RT.VEND_CUST_CD
--AND RT.PRVNT_NEW_SPND_IND = 0
AND P.PROCESS_FLAG        = '1'
AND SYSTIMESTAMP         >= B.BUDGET_START_DATE
AND PA.PAYMENT_AMOUNT     > 0
AND P.DELETE_FLAG         = '0'
AND P.STATUS_ID          IN
  (SELECT STATUS_ID
  FROM HHSA_APP.STATUS_MASTER_R2_R3
  WHERE PROCESS_TYPE = 'Payment'
  AND STATUS         = 'Approved'
  )
AND RV.DOC_CD=PA.RFED_DOC_CD
AND RV.DOC_DEPT_CD=PA.RFED_DOC_DEPT_CD
AND RV.DOC_ID=PA.RFED_DOC_ID--


SELECT * FROM CONTRACT WHERE 
(EXT_CT_NUMBER = 'CT1071BAQAINTPR7004'   ---'DHS'  
or  EXT_CT_NUMBER = 'CT126020160001188')

UPDATE CONTRACT SET ORGANIZATION_ID = 'Org_4981'   ---- ACS budget mod pending approval
WHERE CONTRACT_TITLE = 'TT361.05.2';
COMMIT;

UPDATE CONTRACT SET PROGRAM_ID = 78;

SELECT PROGRAM_ID FROM CONTRACT
WHERE CONTRACT_TITLE = 'TT361.05.2';

COMMIT;
ROLLBACK;

CT1071BAQAPOSTR7001   budget mod in progress.

select distinct '1 - ROW: 4) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023';


select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_AWARD_EPIN in('RMINTINVTR002A039');


select 'INTEGRATION_ID' as Col, max(INTEGRATION_ID) as MAX_VAL, cast (substr(max(INTEGRATION_ID),-10) as NUMBER) + 1 as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID like('MANUAL000%') union all
select 'REF_APT_EPIN_ID' as Col, cast( max(REF_APT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(REF_APT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER union all
select 'PROCUREMENT_EPIN_ID' as Col, cast( max(PROCUREMENT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(PROCUREMENT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER;


/* Check if INTEGRATION_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID in('MANUAL0000000010038') union all

/* Check if REF_APT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where REF_APT_EPIN_ID in('20181101033563') union all

/* Check if PROCUREMENT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_EPIN_ID in('20181101033563');




/* Create EPINs - Insert Statement */	
SET autocommit off	
SET define off	
whenever SQLERROR exit rollback	
	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 39 - AMD','RMINTINVTR002A039','A','50','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR039',null,null,null,null,null,null,'AMND','MANUAL0000000010038','20181101033563','20181101033563',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
	
commit;	
	
  

SET autocommit off	
SET define off	
whenever SQLERROR exit rollback	
	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 40 - AMD','RMINTINVTR002A040','A','21','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR040',null,null,null,null,null,null,'AMND','MANUAL0000000010040','20181101033564','20181101033564',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
	
commit;	 
  
  
	
/* Create EPINs - Rollback Statement */	
SET autocommit off	
SET define off	
whenever SQLERROR exit rollback	
	
delete from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID = 'MANUAL0000000010038';	
	
commit;	


PROGRAM_ID = 78

SELECT * FROM CONTRACT 
WHERE CONTRACT_TITLE = 'TT361.05.2';

SELECT * FROM CONTRACT WHERE 
EXT_CT_NUMBER = 'CT126020160001188'


--------------------------------------------
amendment epin   AMendment in bound ----
use:
RMINTINVTR002A039   award -epin
20181101033563

CONTRACT = CT1071BAQAPOSTR7001   DHS  --- pending budget mod


SELECT * FROM REF_APT_EPIN_MASTER  ----ORDER BY CREATED_DATE DESC 
WHERE AWARD_EPIN_ID = 'RMINTINVTR002A039'


select * from CONTRACT where PARENT_CONTRACT_ID = 41484;
select * from BUDGET where contract_id in(select contract_id from CONTRACT where PARENT_CONTRACT_ID = 41484);


SELECT * FROM SUB_BUDGET WHERE SUB_BUDGET_NAME = 'Test Amendment'  ---- DHS ok amendment inbound

SELECT * FROM CONTRACT_FINANCIALS WHERE BUDGET_CODE = 'ehju' AND OBJECT_CODE ='tyki' AND AMOUNT = 50

SELECT * FROM CONTRACT 
WHERE EXT_EPIN = 'RMINTINVTR002A039'

---Create amendment E-PINS to be used to test amendment inbound 

/* Create EPINs - Insert Statement */	
SET autocommit off	
SET define off	
whenever SQLERROR exit rollback	
	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 41 - AMD','RMINTINVTR002A041','A','10','YMCA of Greater New York','VD001302025',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR041',null,null,null,null,null,null,'AMND','MANUAL0000000010041','20181101033565','20181101033565',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 48 - AMD','RMINTINVTR002A042','A','10','YMCA of Greater New York','VD001302026',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR042',null,null,null,null,null,null,'AMND','MANUAL0000000010042','20181101033566','20181101033566',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 42 - AMD','RMINTINVTR002A043','A','10','YMCA of Greater New York','VD001302027',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR043',null,null,null,null,null,null,'AMND','MANUAL0000000010043','20181101033567','20181101033567',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 43 - AMD','RMINTINVTR002A044','A','10','YMCA of Greater New York','VD001302028',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR044',null,null,null,null,null,null,'AMND','MANUAL0000000010044','20181101033568','20181101033568',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 44 - AMD','RMINTINVTR002A045','A','10','YMCA of Greater New York','VD001302029',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR045',null,null,null,null,null,null,'AMND','MANUAL0000000010045','20181101033569','20181101033569',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 45 - AMD','RMINTINVTR002A046','A','10','YMCA of Greater New York','VD001302030',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR046',null,null,null,null,null,null,'AMND','MANUAL0000000010046','20181101033570','20181101033570',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 46 - AMD','RMINTINVTR002A047','A','10','YMCA of Greater New York','VD001302031',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR047',null,null,null,null,null,null,'AMND','MANUAL0000000010047','20181101033571','20181101033571',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 47 - AMD','RMINTINVTR002A048','A','10','YMCA of Greater New York','VD001302032',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR048',null,null,null,null,null,null,'AMND','MANUAL0000000010048','20181101033572','20181101033572',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 49 - AMD','RMINTINVTR002A049','A','10','YMCA of Greater New York','VD001302033',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR049',null,null,null,null,null,null,'AMND','MANUAL0000000010049','20181101033573','20181101033573',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 50 - AMD','RMINTINVTR002A050','A','10','YMCA of Greater New York','VD001302034',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR050',null,null,null,null,null,null,'AMND','MANUAL0000000010050','20181101033574','20181101033574',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	

commit;	

SELECT * FROM  HHSA_APP.REF_APT_EPIN_MASTER
WHERE PROCUREMENT_AWARD_EPIN IN ('RMINTINVTR002A040',  'RMINTINVTR002A041')

---vendor fms for amend
UPDATE REF_APT_EPIN_MASTER
SET VENDOR_FMS_ID = 'VD001302023'
WHERE PROCUREMENT_AWARD_EPIN IN ('RMINTINVTR002A042',  'RMINTINVTR002A041','RMINTINVTR002A043','RMINTINVTR002A044','RMINTINVTR002A045','RMINTINVTR002A046','RMINTINVTR002A047','RMINTINVTR002A048','RMINTINVTR002A049','RMINTINVTR002A050');
commit;

SELECT * FROM REF_APT_EPIN_MASTER
---SET VENDOR_FMS_ID = 'VD001302023'
WHERE PROCUREMENT_AWARD_EPIN IN ('RMINTINVTR002A041')

CONTRACT = CT1071BAQAPOSTR7001   DHS  --- pending budget mod


SELECT * FROM CONTRACT
WHERE EXT_CT_NUMBER = 'CT1071BAQAPRER7R030'      'CT1071BAQAPOSTR7001'     41484 42083 41843 

----Register amendment contractss contract_type_id = 2  (1 base contract)
UPDATE CONTRACT
SET STATUS_ID = 118
WHERE CONTRACT_ID IN (38494);           -----( 42083,41843);
Commit;

----

! Contract End Date can not fall into a Fiscal Year which is lesser than a Fiscal Year of which a Budget has been configured

! CONTRACT_END_DATE is not lesser than the start date of the latest fiscal year base budget which exists for that contract in Pending Submission, Pending Approval, Returned for Revision, or Active status.
chnage the date of amendment less than contract end date
----

SELECT * FROM BUDGET
WHERE CONTRACT_ID IN (41484,42083,41843) ----
SELECT * FROM PAYMENT
WHERE PAYMENT_VOUCHER_NUM = '180200893P1'  8147 
---------------------------------------------------------
/* TO IDENTIFY THE FOLLOWING
CONTRACT = REGISTERED
BUDGET = ACTIVE
INVOICE = PENDING
*/
SELECT * FROM HHSA_APP.INVOICE
WHERE BUDGET_ID IN 
(
    SELECT BUDGET_ID FROM HHSA_APP.BUDGET
    WHERE CT_NUMBER IN 
    (
        SELECT EXT_CT_NUMBER FROM HHSA_APP.CONTRACT 
        WHERE STATUS_ID = 62 AND EXT_CT_NUMBER IS NOT NULL
        
    ) AND STATUS_ID = 85
)
AND STATUS_ID = 72
;
-------------------------------------------------------
/* TO IDENTIFY THE FOLLOWING
CONTRACT = REGISTERED
BUDGET = ACTIVE
INVOICE = APPROVED
PAYMENT = PENDING APPROVAL
*/
SELECT * FROM HHSA_APP.PAYMENT
WHERE INVOICE_ID IN (
    SELECT INVOICE_ID FROM HHSA_APP.INVOICE
    WHERE BUDGET_ID IN 
    (
        SELECT BUDGET_ID FROM HHSA_APP.BUDGET
        WHERE CT_NUMBER IN 
        (
            SELECT EXT_CT_NUMBER FROM HHSA_APP.CONTRACT 
            WHERE STATUS_ID = 62 AND EXT_CT_NUMBER IS NOT NULL
            
        ) AND STATUS_ID = 85
    )
    AND STATUS_ID = 73
    )AND STATUS_ID = 63
;
----
/* TO IDENTIFY THE FOLLOWING   XXX   Cannot initiate modification while there are outstanding invoices or payments for this contract
CONTRACT = REGISTERED
BUDGET MOD = PENDING APPROVAL
*/
SELECT * FROM HHSA_APP.BUDGET
WHERE BUDGET_TYPE_ID = 3
AND ---STATUS_ID = 82 AND 
CT_NUMBER IS NOT NULL
;
/* TO IDENTIFY THE FOLLOWING     XXX  Cannot initiate update while there are outstanding invoices or payments for this contract
CONTRACT = REGISTERED
CONTRACT CONFIG UPDATE  = PENDING APPROVAL
*/
SELECT * FROM HHSA_APP.BUDGET
WHERE CT_NUMBER IN 
(
    SELECT EXT_CT_NUMBER FROM HHSA_APP.CONTRACT
    WHERE CONTRACT_TYPE_ID = 4 AND EXT_CT_NUMBER IS NOT NULL AND STATUS_ID =59
)AND STATUS_ID IN (106) AND BUDGET_TYPE_ID = 4
;
---
/* TO IDENTIFY THE FOLLOWING
CONTRACT = REGISTERED
AMENDMENT = PENDING OR INPRGRESS
*/
SELECT * FROM HHSA_APP.BUDGET
WHERE CT_NUMBER IN 
(
    SELECT EXT_CT_NUMBER FROM HHSA_APP.CONTRACT
    WHERE CONTRACT_TYPE_ID = 2 AND EXT_CT_NUMBER IS NOT NULL AND STATUS_ID =59
)
---AND STATUS_ID NOT IN (86,85,84) 
---AND 
---BUDGET_TYPE_ID = 2
;



select distinct '1 - ROW: 4) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023';
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_AWARD_EPIN in('RMINTINVTR002A051');

select 'INTEGRATION_ID' as Col, max(INTEGRATION_ID) as MAX_VAL, cast (substr(max(INTEGRATION_ID),-10) as NUMBER) + 1 as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID like('MANUAL000%') union all
select 'REF_APT_EPIN_ID' as Col, cast( max(REF_APT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(REF_APT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER union all
select 'PROCUREMENT_EPIN_ID' as Col, cast( max(PROCUREMENT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(PROCUREMENT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER;

/* Check if INTEGRATION_ID(s) exist in the TST database. This query should return 0 records. */	
select * from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID in('MANUAL0000000010051','MANUAL0000000010052','MANUAL0000000010053','MANUAL0000000010054','MANUAL0000000010055','MANUAL0000000010056') union all	
	
/* Check if REF_APT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */	
select * from HHSA_APP.REF_APT_EPIN_MASTER where REF_APT_EPIN_ID in('20181101033576','20181101033576','20181101033576','20181101033576','20181101033576','20181101033576') union all	
	
/* Check if PROCUREMENT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */	
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_EPIN_ID in('20181101033576','20181101033576','20181101033576','20181101033576','20181101033576','20181101033576');	


/* Create EPINs - Insert Statement */
SET autocommit off
SET define off
whenever SQLERROR exit rollback

---insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 51 - AMD','RMINTINVTR002A051','A','5','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR051',null,null,null,null,null,null,'AMND','MANUAL0000000010051','20181101033576','20181101033576',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 52 - AMD','RMINTINVTR002A052','A','5','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR052',null,null,null,null,null,null,'AMND','MANUAL0000000010052','20181101033576','20181101033576',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 53- AMD','RMINTINVTR002A053','A','5','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR053',null,null,null,null,null,null,'AMND','MANUAL0000000010053','20181101033576','20181101033576',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 54 - AMD','RMINTINVTR002A054','A','5','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR054',null,null,null,null,null,null,'AMND','MANUAL0000000010054','20181101033576','20181101033576',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 55 - AMD','RMINTINVTR002A055','A','5','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR055',null,null,null,null,null,null,'AMND','MANUAL0000000010055','20181101033576','20181101033576',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('RM INTERFACE TST 56 - AMD','RMINTINVTR002A056','A','5','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-18','DD-MON-RR HH.MI.SS.FF AM'),'Drop-In Centers','DHS','781','781','CT1781BAINTTABSR056',null,null,null,null,null,null,'AMND','MANUAL0000000010056','20181101033576','20181101033576',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');

commit;

Open a tab enter invoice
if try to enter invoice in second tab it generates the error message
(Invoices are opened in multiple tabs in a browser.Please close all the tabs and open invoice list again.)

Save the first invoice then swithch to the second tab
try it again

it works ok.



STG: 2/5/2018

USe this contract for testing
CT1071BAQAPRER7R038

SELECT * FROM PAYMENT  --invoice 1
WHERE PAYMENT_VOUCHER_NUM = '180200240P1'   ---165011
'180100212P1'  PAYMENT_ID = 165006 

180100212

SELECT * FROM PAYMENT  --invoice 1  advance
WHERE PAYMENT_VOUCHER_NUM = '181200173A1'  PAYMENT_ID = 164878 





8714 
SQ-REF_PAYMENT_information

SELECT 
    X.PAYMENT_ID,
    X.AGENCY_CODE,
    X.ORGANIZATION_LEGAL_NAME,
    X.EIN_ID_NN,
    V.VEND_CUST_CD,
    X.CHECK_EFT_NUM,
    X.FISCAL_YEAR,
    X.PERIOD,
    X.PAYMENT_AMOUNT,
    VA.VENDOR_ADDRESS,
    X.PAYEE_NAME,
    X.PAYEE_VENDOR_ID,
    PVA.PAYEE_VENDOR_ADDRESS,
    X.PAYMENT_SUBMITTED_DATE,
    X.PAYMENT_APPROVED_DATE,
    X.PAYMENT_APPROVED_BY,
    X.STATUS,
    X.DISBURSEMENT_DATE,
    X.CREATED_DATE,
    X.MODIFIED_DATE,
	DBMS_CRYPTO.HASH(UTL_RAW.CAST_TO_RAW(UPPER(TRIM(X.PAYMENT_ID))  || UPPER(TRIM(X.AGENCY_CODE))  || UPPER(TRIM(X.ORGANIZATION_LEGAL_NAME))  || UPPER(TRIM(X.EIN_ID_NN))  || UPPER(TRIM(V.VEND_CUST_CD))  || UPPER(TRIM(X.CHECK_EFT_NUM))  || UPPER(TRIM(X.FISCAL_YEAR))  || UPPER(TRIM(X.PERIOD))  || UPPER(TRIM(X.PAYMENT_AMOUNT))  || UPPER(TRIM(VA.AD_ID))  || UPPER(TRIM(X.PAYEE_NAME))  || UPPER(TRIM(X.PAYEE_VENDOR_ID))  || UPPER(TRIM(PVA.AD_ID))  || UPPER(TRIM(TO_CHAR(X.PAYMENT_SUBMITTED_DATE,'YYYYMMDDHH24MISS')))  || UPPER(TRIM(TO_CHAR(X.PAYMENT_APPROVED_DATE,'YYYYMMDDHH24MISS')))  || UPPER(TRIM(X.MODIFIED_BY_USERID))  || UPPER(TRIM(X.STATUS)) || UPPER(TRIM(TO_CHAR(X.DISBURSEMENT_DATE,'YYYYMMDDHH24MISS')))),2) AS SRC_INTEGRATION_ID,    
	X.ROW_WID,
    X.TGT_INTEGRATION_ID   
	FROM 
(SELECT 
    P.PAYMENT_ID,
    P.VENDOR_ADDRESS_ID,
	P.PAYEE_VENDOR_ADDRESS_ID ,
    N.AGENCY_CODE,
    O.ORGANIZATION_LEGAL_NAME,
    O.EIN_ID_NN,
    P.CHECK_EFT_NUM,
    F.FISCAL_YEAR,
    P.PERIOD,
    P.PAYMENT_AMOUNT,
    P.PAYEE_NAME,
    P.PAYEE_VENDOR_ID,
    P.PAYMENT_SUBMITTED_DATE,
    P.PAYMENT_APPROVED_DATE,
    (SELECT EMAIL_ID FROM HHSA_APP.CITY_USER_DETAILS C WHERE C.USER_ID = P.MODIFIED_BY_USERID) as PAYMENT_APPROVED_BY,
    SM.STATUS,
    P.DISBURSEMENT_DATE,
    P.CREATED_DATE,
    P.MODIFIED_DATE,   
    P.MODIFIED_BY_USERID,   
    T.ROW_WID,
    T.INTEGRATION_ID AS TGT_INTEGRATION_ID,	
    P.CT_NUMBER ,
    P.PAYMENT_VOUCHER_NUM
FROM
    HHSA_APP.PAYMENT P,
    HHSA_APP.ORGANIZATION O,
    HHSA_APP.NYC_AGENCY_DETAILS N,
    HHSA_APP.FISCAL_YEAR F,
    HHSA_APP.STATUS_MASTER_R2_R3 SM,
	HHSA_APP.REF_PAYMENT_INFORMATION T
WHERE
    P.ORGANIZATION_ID = O.ORGANIZATION_ID(+) 
AND P.AGENCY_ID = N.AGENCY_ID(+)
AND P.FISCAL_YEAR_ID = F.FISCAL_YEAR_ID(+)
AND P.PAYMENT_ID = T.PAYMENT_ID(+)
AND P.STATUS_ID = SM.STATUS_ID
AND
(
( P.DELETE_FLAG = '0'
AND SM.PROCESS_TYPE = 'Payment' AND SM.STATUS in ('Approved','Disbursed'))
OR
( P.DELETE_FLAG = '1'
AND SM.PROCESS_TYPE = 'Payment' AND SM.STATUS in ('Rejected'))
)
AND P.MODIFIED_DATE >= TO_DATE('02-05-2008','MM-DD-YYYY') 
) X,
	 (SELECT DISTINCT
CV.VEND_CUST_CD,
CV.DOC_CD||CV.DOC_DEPT_CD||CV.DOC_ID AS CT_NUMBER
FROM HHSA_APP.REF_CONTRACTS_V CV
) V,
(SELECT DISTINCT
RA.VEND_CUST_CD,
RA.STR_1_NM ||' '|| RA.STR_2_NM ||' '|| RA.CITY_NM ||' '|| RA.ST ||' '|| RA.ZIP ||' '|| RA.CTRY as VENDOR_ADDRESS,
RA.AD_ID AS AD_ID,
CV.DOC_CD||CV.DOC_DEPT_CD||CV.DOC_ID AS CT_NUMBER
FROM HHSA_APP.REF_VENDOR_A RA, HHSA_APP.REF_CONTRACTS_V CV
WHERE  RA.VEND_CUST_CD=CV.VEND_CUST_CD
) VA,
	 (SELECT DISTINCT
RA.VEND_CUST_CD,
RA.STR_1_NM ||' '|| RA.STR_2_NM ||' '|| RA.CITY_NM ||' '|| RA.ST ||' '|| RA.ZIP ||' '|| RA.CTRY as PAYEE_VENDOR_ADDRESS,
RA.AD_ID AS AD_ID
FROM HHSA_APP.REF_VENDOR_A RA
) PVA
WHERE 
 X.VENDOR_ADDRESS_ID = VA.AD_ID(+)
AND X.CT_NUMBER=VA.CT_NUMBER(+)
AND X.CT_NUMBER=V.CT_NUMBER(+)
AND X.PAYEE_VENDOR_ID   = PVA.VEND_CUST_CD(+)
AND X.PAYEE_VENDOR_ADDRESS_ID = PVA.AD_ID(+)


------

Acacia Network Housing, Inc.


SELECT DISTINCT
RA.VEND_CUST_CD,
RA.STR_1_NM ||' '|| RA.STR_2_NM ||' '|| RA.CITY_NM ||' '|| RA.ST ||' '|| RA.ZIP ||' '|| RA.CTRY as VENDOR_ADDRESS,
RA.AD_ID AS AD_ID,
CV.DOC_CD||CV.DOC_DEPT_CD||CV.DOC_ID AS CT_NUMBER
FROM HHSA_APP.REF_VENDOR_A RA, HHSA_APP.REF_CONTRACTS_V CV
WHERE  RA.VEND_CUST_CD=CV.VEND_CUST_CD

--------
FMS_VEND_CUST_CD = is 
0002375758

SELECT * FROM  HHSA_APP.REF_VENDOR_A
WHERE ORGANIZATION_NAME LIKE '%Aca%'



---------
SELECT *
FROM USER_TAB_COLUMNS 
WHERE COLUMN_NAME LIKE 'FMS_VEND_CUST_CD%'  

SELECT * FROM REF_PAYMENT_INFORMATION


-----
SELECT * FROM CONTRACT
WHERE CONTRACT_ID = 25274
----


SELECT * FROM REF_VENDOR_A 
SELECT * FROM ASSIGNMENT
SELECT * FROM REF_VENDOR_V     ----Org_5704

ACACIA NETWORK HOUSING INC

SELECT * FROM ORGANIZATION




---------


SELECT * FROM BUDGET


------


SELECT * FROM CONTRACT
WHERE  CONTRACT_TITLE = 'STGCTR2'    CONTRACT_ID = 38500 38499  ---
CONTRACT_ID = 25491

SELECT * FROM REF_DISB_A   ----trkg_dt 
ORDER BY CREATED_DATE DESC 

-----
WITH SUB_BUDGET_DETAILS AS
(SELECT
SS.FK_ID,
SS.FISCAL_YEAR,
SUM(SS.SUB_BUDGET_AMOUNT) AS FISCAL_YEAR_AMOUNT  FROM STG_SUBBUDGET SS GROUP BY SS.FK_ID,SS.FISCAL_YEAR
)
SELECT
SEQ_BUDGET_ID.NEXTVAL as BUDGET_ID,
'1' as BUDGET_TYPE_ID,
C.CONTRACT_ID,
SS.FISCAL_YEAR AS FISCAL_YEAR_ID,
SS.FISCAL_YEAR_AMOUNT,
C.AGENCY_ID,
C.ORGANIZATION_ID,
C.PROGRAM_ID,
TO_DATE('01-JUL-'||SS.FISCAL_YEAR,'DD-MON-YY') as BUDGET_START_DATE,
TO_DATE('30-JUN-'||(SS.FISCAL_YEAR+1),'DD-MON-YY') as BUDGET_END_DATE, 
(SELECT BUDGET_ID FROM BUDGET WHERE CONTRACT_ID=C.PARENT_CONTRACT_ID AND FISCAL_YEAR_ID=SS.FISCAL_YEAR AND DELETE_FLAG=0 AND ACTIVE_FLAG=1) AS PARENT_ID,
 C.EXT_CT_NUMBER FROM STG_CONTRACT_INFORMATION SCI,
  SUB_BUDGET_DETAILS SS,CONTRACT C
WHERE SCI.PK_ID=SS.FK_ID

-----
SELECT * 
FROM BUDGET 
WHERE DELETE_FLAG=0 
AND ACTIVE_FLAG=1

-----------------

Issue: Amendment inbound interface ETL job fails and sub-budgets are not created when there is modification in progress for a contract. The workflow is wf_AGENCY_AMENDMENT_INBOUND and it fails at session s_HHSA_SIL_SQL_AGENCY_INBOUND_BUDGET_AMENDMENT


Technical issue details: The ETL SQL Query in  s_HHSA_SIL_SQL_AGENCY_INBOUND_BUDGET_AMENDMENT is as below. The current query while selecting Budget Parent ID, is not checking for base budget type (BUDGET_TYPE_ID=2). If there is a budget modification in progress, the BUDGET_ID corresponding to that modification (BUDGET_TYPE_ID=3) also gets pulled along with the Base BUDGET_ID, while selecting the BUDGET PARENT_ID. Hence the ETL SQL Query fails with error "ORA-01427: single-row subquery returns more than one row".

Current SQL:

WITH SUB_BUDGET_DETAILS AS
(SELECT
SS.FK_ID,
SS.FISCAL_YEAR,
SUM(SS.SUB_BUDGET_AMOUNT) AS FISCAL_YEAR_AMOUNT  FROM STG_SUBBUDGET SS GROUP BY SS.FK_ID,SS.FISCAL_YEAR
)
SELECT
SEQ_BUDGET_ID.NEXTVAL as BUDGET_ID,
'1' as BUDGET_TYPE_ID,
C.CONTRACT_ID,
SS.FISCAL_YEAR AS FISCAL_YEAR_ID,
SS.FISCAL_YEAR_AMOUNT,
C.AGENCY_ID,
C.ORGANIZATION_ID,
C.PROGRAM_ID,
TO_DATE('01-JUL-'||SS.FISCAL_YEAR,'DD-MON-YY') as BUDGET_START_DATE,
TO_DATE('30-JUN-'||(SS.FISCAL_YEAR+1),'DD-MON-YY') as BUDGET_END_DATE, 
(SELECT BUDGET_ID FROM BUDGET WHERE CONTRACT_ID=C.PARENT_CONTRACT_ID AND FISCAL_YEAR_ID=SS.FISCAL_YEAR AND DELETE_FLAG=0 AND ACTIVE_FLAG=1) AS PARENT_ID,
 C.EXT_CT_NUMBER FROM STG_CONTRACT_INFORMATION SCI,
  SUB_BUDGET_DETAILS SS,CONTRACT C
WHERE SCI.PK_ID=SS.FK_ID
----AND C.EXT_EPIN=SCI.EXT_EPIN
---AND C.EXT_CT_NUMBER=SCI.EXT_CT_NUMBER
---AND C.CONTRACT_TYPE_ID!=6
----and C.STATUS_ID=192
----AND C.CONTRACT_ID NOT IN (SELECT CONTRACT_ID FROM BUDGET) AND SCI.XML_CHECK = 'True'


-----------------
SELECT * FROM HHSA_APP.REF_PAYMENT_INFORMATION T
WHERE PAYMENT_ID = 80350

SELECT * FROM HHSA_APP.PAYMENT WHERE PAYMENT_VOUCHER_NUM = '180200236P1'   --- 165007
WHERE PAYMENT_ID = 80350


SELECT * FROM PAYMENT 
ORDER BY CREATED_DATE DESC   --> once the advance request view task is completed.  165010



SELECT * FROM STAFF_DETAILS
ORDER BY FIRST_NAME DESC
--------


/* AWARDED_VENDOR_NAME / VENDOR_FMS_ID: */
select distinct '1 - ROW: 4) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '2 - ROW: 5) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '3 - ROW: 6) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '4 - ROW: 7) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '5 - ROW: 8) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '6 - ROW: 9) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '7 - ROW: 10) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '8 - ROW: 11) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '9 - ROW: 12) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '10 - ROW: 13) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '11 - ROW: 14) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '12 - ROW: 15) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '13 - ROW: 16) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '14 - ROW: 17) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '15 - ROW: 18) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '16 - ROW: 19) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '17 - ROW: 20) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '18 - ROW: 21) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '19 - ROW: 22) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '20 - ROW: 23) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '21 - ROW: 24) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '22 - ROW: 25) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '23 - ROW: 26) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '24 - ROW: 27) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '25 - ROW: 28) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '26 - ROW: 29) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023';

/* Check if EPIN(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_AWARD_EPIN in('BAINTTABSR001','BAINTTABSR002','BAINTTABSR003','BAINTTABSR004','BAINTTABSR005','BAINTTABSR006','BAINTTABSR007','BAINTTABSR008','BAINTTABSR009','BAINTTABSR010','BAINTTABSR011','BAINTTABSR012','BAINTTABSR013','BAINTTABSR014','BAINTTABSR015','BAINTTABSR016','BAINTTABSR017','BAINTTABSR018','BAINTTABSR019','BAINTTABSR020','BAINTTABSR021','BAINTTABSR022','BAINTTABSR023','BAINTTABSR024','BAINTTABSR025','BAINTTABSR026');

/* Check for latest INTEGRATION_ID, REF_APT_EPIN_ID and PROCUREMENT_EPIN_ID in REF_APT_EPIN_MASTER in the TST database. */
select 'INTEGRATION_ID' as Col, max(INTEGRATION_ID) as MAX_VAL, cast (substr(max(INTEGRATION_ID),-10) as NUMBER) + 1 as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID like('MANUAL000%') union all
select 'REF_APT_EPIN_ID' as Col, cast( max(REF_APT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(REF_APT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER union all
select 'PROCUREMENT_EPIN_ID' as Col, cast( max(PROCUREMENT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(PROCUREMENT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER;


/* Check if INTEGRATION_ID(s) exist in the STG database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID in('MANUALSTG001','MANUALSTG002','MANUALSTG003') union all

/* Check if REF_APT_EPIN_ID(s) exist in the STG database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where REF_APT_EPIN_ID in('20181101033579','20181101033580','20181101033581') union all

/* Check if PROCUREMENT_EPIN_ID(s) exist in the STG database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_EPIN_ID in('20181101033579','20181101033580','20181101033581');



/* Create EPINs - Insert Statement */
SET autocommit off
SET define off
whenever SQLERROR exit rollback

extra in stg    STGCTR001       BACTRSTG001    
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQA INTERFACE TABS TST 1','BACTRSTG001','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CT1781STGCTR001',null,null,null,null,null,null,'RQS','MANUALSTG001','20181101033579','20181101033579',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQA INTERFACE TABS TST 2','BACTRSTG002','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CT1781STGCTR002',null,null,null,null,null,null,'RQS','MANUALSTG002','20181101033580','20181101033580',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQA INTERFACE TABS TST 3','BACTRSTG003','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CT1781STGCTR003',null,null,null,null,null,null,'RQS','MANUALSTG003','20181101033581','20181101033581',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');

commit;

SELECT *   ------DESCRIPTION, AGENCY_DIVISION
FROM HHSA_APP.REF_APT_EPIN_MASTER
WHERE AGENCY_DIVISION IN ( 'DHS' , 'DOP')
AND (DESCRIPTION LIKE 'BAQA%' or PROCUREMENT_AWARD_EPIN LIKE 'BACTRSTG%')

UPDATE REF_APT_EPIN_MASTER
SET AWARD_AGENCY_ID  = 071
WHERE PROCUREMENT_AWARD_EPIN LIKE 'BACTRSTG%'

UPDATE REF_APT_EPIN_MASTER
SET PROJECT_PROGRAM  = 'Drop-In Centers'
WHERE PROCUREMENT_AWARD_EPIN LIKE 'BACTRSTG%'

UPDATE REF_APT_EPIN_MASTER
SET AGENCY_ID  = '071'
WHERE PROCUREMENT_AWARD_EPIN LIKE 'BACTRSTG%'

UPDATE REF_APT_EPIN_MASTER
SET AGENCY_DIVISION  = 'DHS'
WHERE PROCUREMENT_AWARD_EPIN LIKE 'BACTRSTG%'

SELECT * FROM 
CONTRACT
WHERE CONTRACT_TITLE = 'STGCTR2'

UPDATE CONTRACT
SET EXT_CT_NUMBER = 'STGCTR2'
WHERE CONTRACT_TITLE = 'STGCTR2'

UPDATE CONTRACT
SET STATUS_ID = 118
WHERE CONTRACT_TITLE = 'STGCTR2';

commit;

-------
select distinct '1 - ROW: 4) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023';

/* Check if EPIN(s) exist in the STG database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_AWARD_EPIN in('BASTGCTRA1');

/* Check for latest INTEGRATION_ID, REF_APT_EPIN_ID and PROCUREMENT_EPIN_ID in REF_APT_EPIN_MASTER in the STG database. */
select 'INTEGRATION_ID' as Col, max(INTEGRATION_ID) as MAX_VAL, cast (substr(max(INTEGRATION_ID),-10) as NUMBER) + 1 as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID like('MANUAL000%') union all
select 'REF_APT_EPIN_ID' as Col, cast( max(REF_APT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(REF_APT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER union all
select 'PROCUREMENT_EPIN_ID' as Col, cast( max(PROCUREMENT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(PROCUREMENT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER;


/* Check if INTEGRATION_ID(s) exist in the STG database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID in('MANUALMANSTGCTR2A001') union all

/* Check if REF_APT_EPIN_ID(s) exist in the STG database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where REF_APT_EPIN_ID in('20181101033583') union all

/* Check if PROCUREMENT_EPIN_ID(s) exist in the STG database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_EPIN_ID in('20181101033583');


-----------------------------------------------------------------------------------------------------
/* Create EPINs - Insert Statement */	 BASTGCTRA1  AMND for stgctr2  2/7/2018 -- Amendment in STG
SET autocommit off	
SET define off	
whenever SQLERROR exit rollback	
	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQA','BASTGCTRA1','A','3000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CT1781STGCTR2A001',null,null,null,null,null,null,'AMND','MANUALMANSTGCTR2A001','20181101033583','20181101033583',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
	
commit;	
--------------------------------------------------------------------------------------------------------

------

------

------

-------
SELECT * FROM 
CONTRACT
WHERE CONTRACT_TITLE = 'STGCTR2'

SELECT * FROM PAYMENT
WHERE PAYMENT_VOUCHER_NUM = '180200242P1'  ----165013       '180200237A1'    --   165008

SELECT * FROM HHSA_APP.REF_PAYMENT_INFORMATION WHERE rowid NOT IN ( SELECT MAX(ROWID) FROM HHSA_APP.REF_PAYMENT_INFORMATION GROUP BY PAYMENT_ID ); 

164762
164763
164761
164753


SELECT PAYMENT_ID, COUNT(*)   FROM 
HHSA_APP.REF_PAYMENT_INFORMATION 
GROUP BY PAYMENT_ID
HAVING COUNT(PAYMENT_ID) > 1 


Use also 8714 8913  CT107120151420508  in STG DHS --- 2/7/2018   has got pay allocation good
acacianetworkhousingtest@mailinator.com

---------2/8/2018 Thursday
The STG database needed to be updated so DHS can have Services/Cost-CentersI created a new contract:

Contract Title: BAQA R7 CNT PI SVS
CT#: CT1071BAQACNTR7R001

R
----------

SELECT * FROM PAYMENT
WHERE PAYMENT_VOUCHER_NUM = '180200250A1'     PAYMENT_ID = 165019    165020
HACWSTG

SELECT * FROM 


Fix TARUN implemented in STG 2/9/2018

-------
alter table  WC_BUDGET_SERVICES_F add (ACTIVE_FLAG  CHAR(1 BYTE) );
alter table  WC_BUDGET_COST_CENTER_F add (ACTIVE_FLAG  CHAR(1 BYTE) );
-------



----
Please review and confirm the following:
New York City Procurement rules require that all proposals be reviewed and rated based only on the criteria and other factors,
if any, prescribed in the RFP. Any personal knowledge about a proposer relevant to a prescribed criterion 
(or applicable subcriterion) or factor (e.g. prior performance) must communicated with the Agency Chief Contracting Officer.
Such knowledge must not have any bearing on the scoring of the Proposal, which must be based solely on the content and quality.
Proposals must be independently read and awarded points according to the criteria prescribed in this task.

 Yes, I have read and accept the above conditions.
-----


CTRSTG2152018 in STG2  created to test. 

Register contract:
UPDATE CONTRACT
SET STATUS_ID = 118
--SET EXT_CT_NUMBER = 'CTRSTG2152018'
WHERE CONTRACT_TITLE = 'CTRSTG2152018';
commit;



----2_20_2018
Start workflow for 

Please run wf_APT_EPIN workflow in STG environment
Please run s_HHSA_SDE_SQL_STG_APT_EPIN  (Start workflow from Task)



EXT_CT_NUMBER = 'BASTG101';




----Amend epins in STG 

insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BASTG-AMD2','RMINTINVTR002A2022','A','102','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CTSTGAMD2020',null,null,null,null,null,null,'AMND','MANUAL2022','990000638','990000638',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BASTG-AMD3','RMINTINVTR002A2023','A','103','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CTSTGAMD2020',null,null,null,null,null,null,'AMND','MANUAL2023','990000639','990000639',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BASTG-AMD4','RMINTINVTR002A2024','A','104','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CTSTGAMD2020',null,null,null,null,null,null,'AMND','MANUAL2024','990000640','990000640',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BASTG-AMD5','RMINTINVTR002A2025','A','105','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CTSTGAMD2020',null,null,null,null,null,null,'AMND','MANUAL2025','990000641','990000641',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BASTG-AMD6','RMINTINVTR002A2026','A','106','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CTSTGAMD2020',null,null,null,null,null,null,'AMND','MANUAL2026','990000642','990000642',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BASTG-AMD7','RMINTINVTR002A2027','A','107','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CTSTGAMD2020',null,null,null,null,null,null,'AMND','MANUAL2027','990000643','990000643',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BASTG-AMD8','RMINTINVTR002A2028','A','108','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CTSTGAMD2020',null,null,null,null,null,null,'AMND','MANUAL2028','990000644','990000644',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BASTG-AMD9','RMINTINVTR002A2029','A','109','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CTSTGAMD2020',null,null,null,null,null,null,'AMND','MANUAL2029','990000645','990000645',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BASTG-AMD10','RMINTINVTR002A2030','A','110','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CTSTGAMD2020',null,null,null,null,null,null,'AMND','MANUAL2030','990000646','990000646',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BASTG-AMD11','RMINTINVTR002A2031','A','111','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','781','781','CTSTGAMD2020',null,null,null,null,null,null,'AMND','MANUAL2031','990000647','990000647',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
commit;
-----






------
------
Disbursement:
------
ADVANCE DISBURSEMENT QUERIES:
---1st set of queries
SELECT * FROM PAYMENT
ORDER BY CREATED_DATE DESC    ---165009

update  PAYMENT set STATUS_ID =65,DISBURSEMENT_DATE = '20-FEB-2018',CHECK_EFT_NUM = 'MANUAL000000030',PROCESS_FLAG=0,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where PAYMENT_ID = 164856;   ---- 8128;
commit;

--2nd set of queries to disburse the budget advance so that invoice can be recoup against
SELECT * FROM BUDGET_ADVANCE ORDER BY CREATED_DATE DESC 

update BUDGET_ADVANCE set PREV_STATUS_ID= 93,STATUS_ID = 125,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where BUDGET_ADVANCE_ID IN (12417);
-----
-----
-----


Please run s_HHSA_SDE_SQL_STG_APT_EPIN  (Start workflow from Task) in stage environment.

Please run  wf_AGENCY_AMENDMENT_INBOUND (start workflow) in STG

Please run  wf_AGENCY_ADVANCE_INBOUND (start workflow) in STG

Please update the $$START_DT parameter to 02-21-2018
in /informatica/pc/ParamFiles/HHSA_AGENCY_OUTBOUND_STARTER_KIT_param.prm in STG
and run the following workflow in STG
 
wf_Agency_Payment_Outbound_Starter_Kit
wf_Agency_Budget_Outbound_Starter_Kit
wf_Agency_Contract_Outbound_Starter_Kit
wf_Agency_Invoice_Outbound_Starter_Kit

Please keep this ticket open until test is complete.

Thanks.



----
8833

---INV
---STATUS

SELECT A.STATUS_ID, B.STATUS, A.INVOICE_ID, A.INVOICE_NUMBER, A.CONTRACT_ID, A.BUDGET_ID, A.AGENCY_ID, A.CT_NUMBER  
FROM HHSA_APP.INVOICE A , HHSA_APP.STATUS_MASTER_R2_R3 B
WHERE A.STATUS_ID = B.STATUS_ID
AND A.STATUS_ID IN (70,71)


---
SELECT DISTINCT A.STATUS_ID, B.STATUS  
FROM HHSA_APP.INVOICE A , HHSA_APP.STATUS_MASTER_R2_R3 B
WHERE A.STATUS_ID = B.STATUS_ID
---
70	Pending Submission
74	Withdrawn
72	Pending Approval
75	Suspended
73	Approved
71	Returned for Revision
-----


----

----------------------------
---------
In TST
CT1071RMCNTAMDTR001     Inv and Request advance 23.18 
---Inv
SELECT A.CREATED_DATE,  A.STATUS_ID, B.STATUS, A.INVOICE_ID, A.INVOICE_NUMBER, A.CONTRACT_ID, A.BUDGET_ID, A.AGENCY_ID, A.CT_NUMBER  
FROM HHSA_APP.INVOICE A , HHSA_APP.STATUS_MASTER_R2_R3 B, HHSA_APP.CONTRACT C
WHERE A.STATUS_ID = B.STATUS_ID
--AND A.STATUS_ID IN (70,71)
AND A.CONTRACT_ID =C.CONTRACT_ID
AND C.EXT_CT_NUMBER = 'CT1071RMCNTAMDTR001'
ORDER BY A.CREATED_DATE DESC

--Payment
SELECT A.*, B.STATUS_ID, B.STATUS 
FROM HHSA_APP.PAYMENT A , HHSA_APP.STATUS_MASTER_R2_R3 B, HHSA_APP.CONTRACT C
WHERE A.STATUS_ID = B.STATUS_ID
AND A.CONTRACT_ID =C.CONTRACT_ID
AND C.EXT_CT_NUMBER = 'CT1071RMCNTAMDTR001'
ORDER BY A.CREATED_DATE DESC


--Budget_Advance
SELECT B.STATUS_ID, B.STATUS, A.*
FROM HHSA_APP.BUDGET_ADVANCE A , HHSA_APP.STATUS_MASTER_R2_R3 B, HHSA_APP.CONTRACT C
WHERE A.STATUS_ID = B.STATUS_ID
AND A.CONTRACT_ID =C.CONTRACT_ID
AND C.EXT_CT_NUMBER = 'CT1071RMCNTAMDTR001'
ORDER BY A.CREATED_DATE DESC

-------
-------

SELECT A.STATUS_ID, B.STATUS, A.INVOICE_ID, A.INVOICE_NUMBER, A.CONTRACT_ID, A.BUDGET_ID, A.AGENCY_ID, A.CT_NUMBER  
FROM HHSA_APP.INVOICE A , HHSA_APP.STATUS_MASTER_R2_R3 B
WHERE A.STATUS_ID = B.STATUS_ID
AND A.STATUS_ID IN (70,71)


SELECT A.*, B.STATUS_ID, B.STATUS 
FROM HHSA_APP.PAYMENT A , HHSA_APP.STATUS_MASTER_R2_R3 B
WHERE A.STATUS_ID = B.STATUS_ID
---AND A.STATUS_ID IN (70,71)

109	Pending FMS Action
65	Disbursed
66	Suspended
63	Pending Approval
165	Deleted
64	Approved


SELECT DISTINCT B.STATUS_ID, B.STATUS 
FROM HHSA_APP.BUDGET_ADVANCE A , HHSA_APP.STATUS_MASTER_R2_R3 B
WHERE A.STATUS_ID = B.STATUS_ID



In TST
CT1071RMCNTAMDTR001     Inv and Request advance 23.18 
---Inv
SELECT A.CREATED_DATE,  A.STATUS_ID, B.STATUS, A.INVOICE_ID, A.INVOICE_NUMBER, A.CONTRACT_ID, A.BUDGET_ID, A.AGENCY_ID, A.CT_NUMBER  
FROM HHSA_APP.INVOICE A , HHSA_APP.STATUS_MASTER_R2_R3 B, HHSA_APP.CONTRACT C
WHERE A.STATUS_ID = B.STATUS_ID
--AND A.STATUS_ID IN (70,71)
AND A.CONTRACT_ID =C.CONTRACT_ID
AND C.EXT_CT_NUMBER = 'CT1071RMCNTAMDTR001'
ORDER BY A.CREATED_DATE DESC


-------3/19/2018
QC6534 Analysis----
----------------------
----
Total $ payment voucher
----------------------------

select pvn, sum(allopayment) as ttp
from (
  SELECT pay.DELETE_FLAG, pay.INVOICE_ID, pay.payment_voucher_num as pvn, pay.CREATED_DATE , pay.PAYMENT_ID, pay.BUDGET_FISCAL_YEAR_ID , allo.BFY ,  allo.REMAINING_AMOUNT,  pay.AGENCY_ID, allo.PAYMENT_AMOUNT as allopayment
  FROM HHSA_APP.PAYMENT pay ,
(SELECT PAYMENT_ID, BFY, REMAINING_AMOUNT, PAYMENT_AMOUNT 
  FROM HHSA_APP.PAYMENT_ALLOCATION
WHERE PAYMENT_ID IN (
 SELECT DISTINCT PAYMENT_ID FROM HHSA_APP.PAYMENT_ALLOCATION
        GROUP BY PAYMENT_ID
        HAVING COUNT(*) > 0
)) allo
where pay.PAYMENT_ID = allo.PAYMENT_ID (+)  and PAY.invoice_id is not null AND 
--AGENCY_ID = 'ACS' 
---AND PAY.STATUS_ID = 65
--AND 
pay.PAYMENT_AMOUNT > 0
)
where BUDGET_FISCAL_YEAR_ID = BFY and allopayment > 0
and DELETE_FLAG <> '1'
group by pvn
--ORDER BY CREATED_DATE DESC
;


-----

----------------------

/* ALL*/
select *
from (
  SELECT pay.DELETE_FLAG, pay.INVOICE_ID, pay.payment_voucher_num, pay.CREATED_DATE , pay.PAYMENT_ID, pay.BUDGET_FISCAL_YEAR_ID , allo.BFY ,  allo.REMAINING_AMOUNT,  pay.AGENCY_ID, allo.PAYMENT_AMOUNT as allopayment
  FROM HHSA_APP.PAYMENT pay ,
(SELECT PAYMENT_ID, BFY, REMAINING_AMOUNT, PAYMENT_AMOUNT 
  FROM HHSA_APP.PAYMENT_ALLOCATION
WHERE PAYMENT_ID IN (
 SELECT DISTINCT PAYMENT_ID FROM HHSA_APP.PAYMENT_ALLOCATION
        GROUP BY PAYMENT_ID
        HAVING COUNT(*) > 0
)) allo
where pay.PAYMENT_ID = allo.PAYMENT_ID (+)  and PAY.invoice_id is not null AND 
--AGENCY_ID = 'ACS' 
---AND PAY.STATUS_ID = 65
--AND 
pay.PAYMENT_AMOUNT > 0
)
where BUDGET_FISCAL_YEAR_ID = BFY and allopayment > 0
and DELETE_FLAG <> '1'
ORDER BY CREATED_DATE DESC
;


------


---------
---Inv
------
In TST
CT1071RMCNTAMDTR001     Inv and Request advance 23.18 
---Inv
SELECT A.CREATED_DATE,  A.STATUS_ID, B.STATUS, A.INVOICE_ID, A.INVOICE_NUMBER, A.CONTRACT_ID, A.BUDGET_ID, A.AGENCY_ID, A.CT_NUMBER  
FROM HHSA_APP.INVOICE A , HHSA_APP.STATUS_MASTER_R2_R3 B, HHSA_APP.CONTRACT C
WHERE A.STATUS_ID = B.STATUS_ID
--AND A.STATUS_ID IN (70,71)
AND A.CONTRACT_ID =C.CONTRACT_ID
AND C.EXT_CT_NUMBER = 'CT1071RMCNTAMDTR001'
ORDER BY A.CREATED_DATE DESC
-----------
----------
--Payment
----------
SELECT A.*, B.STATUS_ID, B.STATUS 
FROM HHSA_APP.PAYMENT A , HHSA_APP.STATUS_MASTER_R2_R3 B, HHSA_APP.CONTRACT C
WHERE A.STATUS_ID = B.STATUS_ID
AND A.CONTRACT_ID =C.CONTRACT_ID
--AND C.EXT_CT_NUMBER = 'CT1071RMCNTAMDTR001'
ORDER BY A.CREATED_DATE DESC


----------------
--Budget_Advance
----------------
SELECT B.STATUS_ID, B.STATUS, A.*
FROM HHSA_APP.BUDGET_ADVANCE A , HHSA_APP.STATUS_MASTER_R2_R3 B, HHSA_APP.CONTRACT C
WHERE A.STATUS_ID = B.STATUS_ID
AND A.CONTRACT_ID =C.CONTRACT_ID
AND C.EXT_CT_NUMBER = 'CT1071RMCNTAMDTR001'
ORDER BY A.CREATED_DATE DESC
------
-Budget - Contract
------

SELECT B.CONTRACT_TITLE, A.* FROM BUDGET A,  CONTRACT B
WHERE A.CONTRACT_ID = B.CONTRACT_ID
AND B.AGENCY_ID = 'DHS'
AND B.CONTRACT_TITLE IN ('BAQTST 1', 'BAQTST 2' , 'BAQTST 3', 'BAQTST 4', 'BAQTST 5')
ORDER BY B.CONTRACT_TITLE, A.CREATED_DATE
------
------
------>
Disbursement:
------
ADVANCE DISBURSEMENT QUERIES:
---1st set of queries
SELECT * FROM PAYMENT
ORDER BY CREATED_DATE DESC    ---165009

update  PAYMENT set STATUS_ID =65,DISBURSEMENT_DATE = '20-FEB-2018',CHECK_EFT_NUM = 'MANUAL000000030',PROCESS_FLAG=0,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where PAYMENT_ID = 164856;   ---- 8128;
commit;

--2nd set of queries to disburse the budget advance so that invoice can be recoup against
SELECT * FROM BUDGET_ADVANCE ORDER BY CREATED_DATE DESC 

update BUDGET_ADVANCE set PREV_STATUS_ID= 93,STATUS_ID = 125,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where BUDGET_ADVANCE_ID IN (12417);
-----
-----
Starter Kit
-----
Please run s_HHSA_SDE_SQL_STG_APT_EPIN  (Start workflow from Task) in stage environment.

Please run  wf_AGENCY_AMENDMENT_INBOUND (start workflow) in STG

Please run  wf_AGENCY_ADVANCE_INBOUND (start workflow) in STG

Please update the $$START_DT parameter to 02-21-2018
in /informatica/pc/ParamFiles/HHSA_AGENCY_OUTBOUND_STARTER_KIT_param.prm in STG
and run the following workflow in STG
 
wf_Agency_Payment_Outbound_Starter_Kit
wf_Agency_Budget_Outbound_Starter_Kit
wf_Agency_Contract_Outbound_Starter_Kit
wf_Agency_Invoice_Outbound_Starter_Kit

Please keep this ticket open until test is complete.

Thanks.


----------
APT BAM database location:

The Connection information for APT BAM Database is DoITT_CPR_ODS


---------


  
SELECT CONTRACT_ID FROM CONTRACT
WHERE EXT_CT_NUMBER = 'CT1071RMCNTAMDTR001'
  



/* Check if EPIN(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_AWARD_EPIN in('BAINTTABSR001','BAINTTABSR002','BAINTTABSR003','BAINTTABSR004','BAINTTABSR005','BAINTTABSR006','BAINTTABSR007','BAINTTABSR008','BAINTTABSR009','BAINTTABSR010','BAINTTABSR011','BAINTTABSR012','BAINTTABSR013','BAINTTABSR014','BAINTTABSR015','BAINTTABSR016','BAINTTABSR017','BAINTTABSR018','BAINTTABSR019','BAINTTABSR020','BAINTTABSR021','BAINTTABSR022','BAINTTABSR023','BAINTTABSR024','BAINTTABSR025','BAINTTABSR026');

select * from HHSA_APP.REF_APT_EPIN_MASTER
WHERE AGENCY_DIVISION = 'DHS'


/* AWARDED_VENDOR_NAME / VENDOR_FMS_ID: */
select distinct '1 - ROW: 4) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '2 - ROW: 5) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '3 - ROW: 6) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '4 - ROW: 7) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '5 - ROW: 8) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '6 - ROW: 9) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '7 - ROW: 10) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '8 - ROW: 11) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '9 - ROW: 12) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '10 - ROW: 13) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '11 - ROW: 14) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '12 - ROW: 15) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '13 - ROW: 16) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '14 - ROW: 17) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '15 - ROW: 18) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '16 - ROW: 19) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '17 - ROW: 20) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '18 - ROW: 21) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '19 - ROW: 22) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '20 - ROW: 23) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '21 - ROW: 24) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '22 - ROW: 25) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '23 - ROW: 26) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '24 - ROW: 27) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '25 - ROW: 28) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023' union all 
select distinct '26 - ROW: 29) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = 'VD001302023' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('YMCA of Greater New York')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> 'VD001302023' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'YMCA of Greater New York' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = 'VD001302023';


/* Check if EPIN(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_AWARD_EPIN in('BAQTST001','BAQTST002','BAQTST003','BAQTST004','BAQTST005','BAQTST006','BAQTST007','BAQTST008','BAQTST009','BAQTST010','BAQTST011','BAQTST012','BAQTST013','BAQTST014','BAQTST015','BAQTST016','BAQTST017','BAQTST018','BAQTST019','BAQTST020','BAQTST021','BAQTST022','BAQTST023','BAQTST024','BAQTST025','BAQTST026');

/* Check for latest INTEGRATION_ID, REF_APT_EPIN_ID and PROCUREMENT_EPIN_ID in REF_APT_EPIN_MASTER in the TST database. */
select 'INTEGRATION_ID' as Col, max(INTEGRATION_ID) as MAX_VAL, cast (substr(max(INTEGRATION_ID),-10) as NUMBER) + 1 as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID like('MANUAL000%') union all
select 'REF_APT_EPIN_ID' as Col, cast( max(REF_APT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(REF_APT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER union all
select 'PROCUREMENT_EPIN_ID' as Col, cast( max(PROCUREMENT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(PROCUREMENT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER;



/* Check if INTEGRATION_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID in('MANUAL0000000004893','MANUAL0000000004894','MANUAL0000000004895','MANUAL0000000004896','MANUAL0000000004897','MANUAL0000000004898','MANUAL0000000004899','MANUAL0000000004900','MANUAL0000000004901','MANUAL0000000004902','MANUAL0000000004903','MANUAL0000000004904','MANUAL0000000004905','MANUAL0000000004906','MANUAL0000000004907','MANUAL0000000004908','MANUAL0000000004909','MANUAL0000000004910','MANUAL0000000004911','MANUAL0000000004912','MANUAL0000000004913','MANUAL0000000004914','MANUAL0000000004915','MANUAL0000000004916','MANUAL0000000004917','MANUAL0000000004918') union all

/* Check if REF_APT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where REF_APT_EPIN_ID in('990002483','990002484','990002485','990002486','990002487','990002488','990002489','990002490','990002491','990002492','990002493','990002494','990002495','990002496','990002497','990002498','990002499','990002500','990002501','990002502','990002503','990002504','990002505','990002506','990002507','990002508') union all

/* Check if PROCUREMENT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_EPIN_ID in('990002483','990002484','990002485','990002486','990002487','990002488','990002489','990002490','990002491','990002492','990002493','990002494','990002495','990002496','990002497','990002498','990002499','990002500','990002501','990002502','990002503','990002504','990002505','990002506','990002507','990002508');



/* Create EPINs - Insert Statement */
SET autocommit off
SET define off
whenever SQLERROR exit rollback

insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 1','BAQTST001','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST001',null,null,null,null,null,null,'RQS','MANUAL0000000004893','990002483','990002483',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 2','BAQTST002','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST002',null,null,null,null,null,null,'RQS','MANUAL0000000004894','990002484','990002484',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 3','BAQTST003','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST003',null,null,null,null,null,null,'RQS','MANUAL0000000004895','990002485','990002485',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 4','BAQTST004','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST004',null,null,null,null,null,null,'RQS','MANUAL0000000004896','990002486','990002486',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 5','BAQTST005','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST005',null,null,null,null,null,null,'RQS','MANUAL0000000004897','990002487','990002487',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 6','BAQTST006','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST006',null,null,null,null,null,null,'RQS','MANUAL0000000004898','990002488','990002488',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 7','BAQTST007','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST007',null,null,null,null,null,null,'RQS','MANUAL0000000004899','990002489','990002489',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 8','BAQTST008','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST008',null,null,null,null,null,null,'RQS','MANUAL0000000004900','990002490','990002490',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 9','BAQTST009','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST009',null,null,null,null,null,null,'RQS','MANUAL0000000004901','990002491','990002491',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 10','BAQTST010','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST010',null,null,null,null,null,null,'RQS','MANUAL0000000004902','990002492','990002492',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 11','BAQTST011','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST011',null,null,null,null,null,null,'RQS','MANUAL0000000004903','990002493','990002493',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 12','BAQTST012','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST012',null,null,null,null,null,null,'RQS','MANUAL0000000004904','990002494','990002494',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 13','BAQTST013','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST013',null,null,null,null,null,null,'RQS','MANUAL0000000004905','990002495','990002495',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 14','BAQTST014','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST014',null,null,null,null,null,null,'RQS','MANUAL0000000004906','990002496','990002496',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 15','BAQTST015','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST015',null,null,null,null,null,null,'RQS','MANUAL0000000004907','990002497','990002497',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 16','BAQTST016','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST016',null,null,null,null,null,null,'RQS','MANUAL0000000004908','990002498','990002498',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 17','BAQTST017','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST017',null,null,null,null,null,null,'RQS','MANUAL0000000004909','990002499','990002499',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 18','BAQTST018','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST018',null,null,null,null,null,null,'RQS','MANUAL0000000004910','990002500','990002500',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 19','BAQTST019','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST019',null,null,null,null,null,null,'RQS','MANUAL0000000004911','990002501','990002501',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 20','BAQTST020','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST020',null,null,null,null,null,null,'RQS','MANUAL0000000004912','990002502','990002502',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 21','BAQTST021','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST021',null,null,null,null,null,null,'RQS','MANUAL0000000004913','990002503','990002503',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 22','BAQTST022','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST022',null,null,null,null,null,null,'RQS','MANUAL0000000004914','990002504','990002504',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 23','BAQTST023','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST023',null,null,null,null,null,null,'RQS','MANUAL0000000004915','990002505','990002505',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 24','BAQTST024','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST024',null,null,null,null,null,null,'RQS','MANUAL0000000004916','990002506','990002506',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 25','BAQTST025','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST025',null,null,null,null,null,null,'RQS','MANUAL0000000004917','990002507','990002507',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST 26','BAQTST026','C','30000','YMCA of Greater New York','VD001302023',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'Justice Community Program','DHS','071','071','CT1071BAQTST026',null,null,null,null,null,null,'RQS','MANUAL0000000004918','990002508','990002508',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');

commit;

UPDATE  REF_APT_EPIN_MASTER
SET PROJECT_PROGRAM = 'Drop-In Centers'
WHERE PROCUREMENT_AWARD_EPIN LIKE 'BAQTST%';
Commit;

SELECT PROJECT_PROGRAM FROM REF_APT_EPIN_MASTER
--SET PROJECT_PROGRAM = 'Drop-In Centers'
WHERE PROCUREMENT_AWARD_EPIN LIKE 'BAQTST%';

UPDATE  REF_APT_EPIN_MASTER
SET AGENCY_ID =781, AWARD_AGENCY_ID = 781
WHERE PROCUREMENT_AWARD_EPIN LIKE 'BAQTST%';
Commit;

SELECT SUB_BUDGET_ID, BUDGET_ID FROM SUB_BUDGET 
WHERE BUDGET_ID IN (SELECT BUDGET_ID FROM BUDGET WHERE  CONTRACT_ID IN (SELECT CONTRACT_ID  FROM CONTRACT 
WHERE EXT_CT_NUMBER = 'CT1781BAINTTABSR024'))

SELECT * FROM PERSONNEL_SERVICE
SELECT * FROM RENT WHERE SUB_BUDGET_ID = 4830 AND BUDGET_ID = 2622
SELECT * FROM REF_CONTRACTS_A

UPDATE  REF_APT_EPIN_MASTER
SET AGENCY_ID =718, AWARD_AGENCY_ID = 718
WHERE PROCUREMENT_AWARD_EPIN LIKE 'BAQTST%';
Commit;

SELECT DISTINCT PROCUREMENT_AWARD_EPIN, AGENCY_ID, PROJECT_PROGRAM FROM  HHSA_APP.REF_APT_EPIN_MASTER WHERE AGENCY_ID ='DHS'
AND PROJECT_PROGRAM IS NOT NULL 

UPDATE  REF_APT_EPIN_MASTER
SET PROJECT_PROGRAM = 'Family Shelter-Tier II'
WHERE PROCUREMENT_AWARD_EPIN LIKE 'BAQTST%';
Commit;

SELECT * FROM CONTRACT 
WHERE AGENCY_ID = 'DHS'
AND CONTRACT_TITLE IN ('BAQTST 1', 'BAQTST 2' , 'BAQTST 3', 'BAQTST 4', 'BAQTST 5')

UPDATE CONTRACT 
SET STATUS_ID  = 118
WHERE AGENCY_ID = 'DHS'
AND CONTRACT_TITLE IN ('BAQTST 1', 'BAQTST 2' , 'BAQTST 3', 'BAQTST 4', 'BAQTST 5');

commit;

--SELECT INVOICE_ID, SUB_BUDGET_ID, ENTRY_TYPE_ID, LINE_ITEM_ID, INVOICE_AMOUNT, CREATED_DATE  FROM INVOICE_DETAILS
SELECT * FROM INVOICE_DETAILS
WHERE INVOICE_ID = 1324
ORDER BY CREATED_DATE DESC , INVOICE_AMOUNT ASC 

SELECT * FROM SUB_BUDGET
WHERE SUB_BUDGET_ID = 5461   BUDGET_ID = 3093

inv sub budget id entry tpe id line item id inv amount 
1324	5461	10	3967	9
1324	5461	8	1473	8
1324	5461	7	1186	7
1324	5461	6	5140	6
1324	5461	5	1586	5
1324	5461	4	15910	4
1324	5461	3	35653	3
1324	5461	2	83132	2
1324	5461	1	3290	1

ORDER BY CREATED_DATE DESC
AND PROCUREMENT_TITLE IN 'BAQTST 1'


SELECT * FROM BUDGET
ORDER BY CREATED_DATE

SELECT * FROM CONTRACT
WHERE AGENCY_ID = 'DHS'
AND CONTRACT_TITLE IN ('BAQTST 1', 'BAQTST 2' , 'BAQTST 3', 'BAQTST 4', 'BAQTST 5');
------
-------
Register cont
R3 
---
UPDATE CONTRACT 
SET STATUS_ID = 118
WHERE AGENCY_ID = 'DHS'
AND CONTRACT_TITLE IN ('BAQTST1', 'BAQTST2' , 'BAQTST3', 'BAQTST4', 'BAQTST5', 'BAQTST6');
commit;
-----



-----------
---QC 8947
-----------
pay
------ by budget_fiscal_year
------
SELECT C.EXT_CT_NUMBER, B.STATUS_ID, B.STATUS, A.*
FROM HHSA_APP.PAYMENT A , HHSA_APP.STATUS_MASTER_R2_R3 B, HHSA_APP.CONTRACT C
WHERE A.STATUS_ID = B.STATUS_ID
AND A.CONTRACT_ID =C.CONTRACT_ID
--AND C.EXT_CT_NUMBER = 'CT1071RMCNTAMDTR001'
AND B.STATUS_ID = 65
ORDER BY A.CREATED_DATE DESC

---Match the UI---
SELECT SUM(A.PAYMENT_AMOUNT), C.EXT_CT_NUMBER
FROM HHSA_APP.PAYMENT A , HHSA_APP.STATUS_MASTER_R2_R3 B, HHSA_APP.CONTRACT C
WHERE A.STATUS_ID = B.STATUS_ID
AND A.CONTRACT_ID =C.CONTRACT_ID
--AND A.CONTRACT_ID = 2027
--AND A.BUDGET_ID = 552
AND A.STATUS_ID = 65
GROUP BY C.EXT_CT_NUMBER


-------
QC8947
-------
New field

SELECT 
A.AGENCY_ID, 
C.EXT_CT_NUMBER, 
A.CONTRACT_ID, 
B.YTD_ATCUAL_PAID_AMOUNT, 
B.BUDGET_ID, 
B.ORGANIZATION_NAME, 
B.EIN, 
B.FMS_VEND_CUST_CD, 
B.FISCAL_YEAR_AMOUNT 
FROM BUDGET A, REF_BUDGET_INFORMATION B, CONTRACT C
WHERE A.BUDGET_ID = B.BUDGET_ID 
AND A.CONTRACT_ID = C.CONTRACT_ID
AND A.CONTRACT_ID = 25272

-------
QC8947
------------------------
--Prod:
/* Check if EPIN(s) exist in the  database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_AWARD_EPIN in('80118L0008001','80118L0027001','80118L0036001','80118L0037001','80118L0038001','80118L0046001','80118L0055001','80118L0056001   ','80118L0057001','80118L0058001','80118L0059001','80118L006001','80118L0064001','80118L0065001','80118L0067001','80118L0069001','80118L0071001','80118L0075001','80118L00770001','80118L0078001','80118L0079001','80118L0080001','80118L008001','80118L0081001','80118L0084001','80118L0085001','80118L0086001','80118L0087001','80118L0088001','80118L009001','80118L0092001','80118L0101001','80118L0102001','80118L0553001','801SBS180050','801SBS180051','801SBS180052','801SBS180053','801SBS180056','801SBS180060','801SBS180061','801SBS180062','801SBS180063','801SBS180067','801SBS180078','801SBS180084','801SBS180087','801SBS180088','801SBS180092','801SBS180127','801SBS180131','801SBS180139','801SBS180176');

---
	
/* Check for latest INTEGRATION_ID, REF_APT_EPIN_ID and PROCUREMENT_EPIN_ID in REF_APT_EPIN_MASTER in the  database. */	
select 'INTEGRATION_ID' as Col, max(INTEGRATION_ID) as MAX_VAL, cast (substr(max(INTEGRATION_ID),-10) as NUMBER) + 1 as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID like('MANUAL000%') union all	
select 'REF_APT_EPIN_ID' as Col, cast( max(REF_APT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(REF_APT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER union all	
select 'PROCUREMENT_EPIN_ID' as Col, cast( max(PROCUREMENT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(PROCUREMENT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER;	
	
---2
/* Check for latest INTEGRATION_ID, REF_APT_EPIN_ID and PROCUREMENT_EPIN_ID in REF_APT_EPIN_MASTER in the  database. */	
select 'INTEGRATION_ID' as Col, max(INTEGRATION_ID) as MAX_VAL, cast (substr(max(INTEGRATION_ID),-10) as NUMBER) + 1 as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID > ''  union all	
select 'REF_APT_EPIN_ID' as Col, cast( max(REF_APT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(REF_APT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER union all	
select 'PROCUREMENT_EPIN_ID' as Col, cast( max(PROCUREMENT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(PROCUREMENT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER;	
	
---------------



----------------
-------QC6665
----------------
SELECT A.STATUS_ID, D.STATUS, A.REPORTING_MODIFIED_DATE, C.SUB_BUDGET_NAME, C.SUB_BUDGET_AMOUNT, A.BUDGET_TYPE_ID,B.AGENCY_ID,B.CONTRACT_TITLE, B.ORGANIZATION_ID
FROM HHSA_APP.BUDGET A, HHSA_APP.CONTRACT B, HHSA_APP.SUB_BUDGET C , HHSA_APP.STATUS_MASTER_R2_R3 D
WHERE A.CONTRACT_ID = B.CONTRACT_ID 
AND A.BUDGET_ID = C.BUDGET_ID
AND B.EXT_CT_NUMBER = 'CT106820160002026'
--AND B.CONTRACT_TYPE_ID IN (1,2)
--AND A.BUDGET_TYPE_ID = 2
AND C.SUB_BUDGET_AMOUNT <> 0
AND D.STATUS_ID = A.STATUS_ID
AND A.STATUS_ID NOT IN (106)
AND D.PROCESS_TYPE IN ('Budget')
AND D.ACTIVE_FLAG = 1
ORDER BY A.REPORTING_MODIFIED_DATE







-----------------

---budgets with status
SELECT DISTINCT B.STATUS_ID, B.STATUS FROM HHSA_APP.BUDGET A, HHSA_APP.STATUS_MASTER_R2_R3 B
WHERE A.STATUS_ID = B.STATUS_ID
AND A.BUDGET_ID= 3905

STATUS_ID  STATUS
84	Pending Submission
87	Suspended
106	Pending Configuration
83	Returned for Revision
82	Pending Approval
86	Approved
89	Cancelled
85	Active

-----
-----QC8696
Steps:
A contract must be in Pending Configuration status (CONTRACT: CONTRACT_TYPE_ID = 1 and STATUS_ID = 59). The agency will return the contracts for revision in the Certification of Funds task. 
 
1) Note down the CONTRACT_ID of the impacted task. Say it is <CONTRACT_ID>
2) Execute the below script:
 
update BUDGET_CUSTOMIZATION set ISPUBLISHED = 0 where CONTRACT_ID = <CONTRACT_ID>;
commit;
 
The budget template should become editable at this point.
  
SELECT * FROM CONTRACT
WHERE CONTRACT_TYPE_ID = 1 AND STATUS_ID = 59   ---Pending configuration status

SELECT ISPUBLISHED, A.* FROM BUDGET_CUSTOMIZATION A
WHERE A.CONTRACT_ID = 25823
SELECT * FROM CONTRACT
WHERE CONTRACT_ID = 25823
---------


---
FOR 9011 & 8901 Combined --->
---
SELECT D1.STATUS,
B.AGENCY_ID, 
O.ORGANIZATION_LEGAL_NAME AS ProviderName, 
PM.PROGRAM_NAME AS ProgramName, 
B.CT_NUMBER As ExternalContractNumber, 
SB.SUB_BUDGET_NAME As SubBudgetName, 
PSM.PERSONNEL_SERVICE_TYPE AS Level4Name, 
P.POSITION, 
P.POSITION_ID, 
PSD.INTERNAL_TITLE As InternalID, 
PSD.ANNUAL_SALARY, 
PSD.HOUR_PER_YEAR AS AnnualHours, 
PSD.CITY_SALARY, 
PSD.RATE 
FROM HHSA_APP.BUDGET B  
INNER JOIN HHSA_APP.SUB_BUDGET SB 
ON B.BUDGET_ID=SB.BUDGET_ID 
INNER JOIN HHSA_APP.CONTRACT B1
ON B.CONTRACT_ID = B1.CONTRACT_ID 
INNER JOIN HHSA_APP.STATUS_MASTER_R2_R3 D1
ON D1.STATUS_ID = B.STATUS_ID
AND D1.PROCESS_TYPE IN ('Budget')
AND D1.ACTIVE_FLAG = 1
INNER JOIN HHSA_APP.ORGANIZATION O 
ON B.ORGANIZATION_ID=O.ORGANIZATION_ID 
INNER JOIN HHSA_APP.PROGRAM_MASTER PM 
ON B.PROGRAM_ID= PM.PROGRAM_ID 
--AND PM.PROGRAM_ID=82 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE PS 
ON PS.BUDGET_ID=B.BUDGET_ID 
AND PS.SUB_BUDGET_ID=SB.SUB_BUDGET_ID 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE_DETAIL PSD  
ON PS.PERSONNEL_SERVICE_ID=PSD.PERSONNEL_SERVICE_ID 
AND PSD.SUB_BUDGET_ID=SB.SUB_BUDGET_ID 
AND PSD.BUDGET_ID=B.BUDGET_ID 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE_TYPE_MASTER PSM 
ON PS.PERSONNEL_SERVICE_TYPE_ID=PSM.PERSONNEL_SERVICE_TYPE_ID 
INNER JOIN HHSA_APP.POSITION P 
ON PS.POSITION_ID=P.POSITION_ID 
WHERE 
--B.AGENCY_ID='DHS' 
--AND PSM.PERSONNEL_SERVICE_TYPE IN ('Hourly Employees','Salaried Employees') 
---AND PM.PROGRAM_ID=82 AND B.FISCAL_YEAR_ID='2018'
--AND 
B.CONTRACT_ID IN (SELECT B.CONTRACT_ID FROM HHSA_APP.CONTRACT B
--WHERE B.EXT_CT_NUMBER = 'BAQTST001')
--WHERE B.EXT_CT_NUMBER = 'CTRSTG2152018'
)
---AND SB.SUB_BUDGET_NAME = 'CTRSTG2152018_FY19'


-----
-----
-----
----
for 
contract-budget-type-sub budget 
only
----

SELECT A1.STATUS_ID, D1.STATUS, A1.REPORTING_MODIFIED_DATE, C1.SUB_BUDGET_NAME, C1.SUB_BUDGET_AMOUNT, A1.BUDGET_TYPE_ID,B1.AGENCY_ID,B1.CONTRACT_TITLE, B1.ORGANIZATION_ID
FROM HHSA_APP.BUDGET A1, HHSA_APP.CONTRACT B1, HHSA_APP.SUB_BUDGET C1 , HHSA_APP.STATUS_MASTER_R2_R3 D1
WHERE A1.CONTRACT_ID = B1.CONTRACT_ID 
AND A1.BUDGET_ID = C1.BUDGET_ID
---AND B.EXT_CT_NUMBER = 'CT106820171402627'
--AND B.CONTRACT_TYPE_ID IN (1,2)
--AND A.BUDGET_TYPE_ID = 2
AND C1.SUB_BUDGET_AMOUNT <> 0
AND D1.STATUS_ID = A1.STATUS_ID
--AND A.STATUS_ID NOT IN (106)
AND D1.PROCESS_TYPE IN ('Budget')
AND D1.ACTIVE_FLAG = 1
----AND A.BUDGET_ID = 16303
ORDER BY A1.REPORTING_MODIFIED_DATE

----
----

-----
QC QC 9011 is created for this issue. New
-------
USe this good TST2
--------
SELECT B.AGENCY_ID, 
O.ORGANIZATION_LEGAL_NAME AS ProviderName, 
PM.PROGRAM_NAME AS ProgramName, 
B.CT_NUMBER As ExternalContractNumber, 
SB.SUB_BUDGET_NAME As SubBudgetName, 
PSM.PERSONNEL_SERVICE_TYPE AS Level4Name, 
P.POSITION, 
P.POSITION_ID, 
PSD.INTERNAL_TITLE As InternalID, 
PSD.ANNUAL_SALARY, 
PSD.HOUR_PER_YEAR AS AnnualHours, 
PSD.CITY_SALARY, 
PSD.RATE 
FROM HHSA_APP.BUDGET B  
INNER JOIN HHSA_APP.SUB_BUDGET SB 
ON B.BUDGET_ID=SB.BUDGET_ID 
INNER JOIN HHSA_APP.ORGANIZATION O 
ON B.ORGANIZATION_ID=O.ORGANIZATION_ID 
INNER JOIN HHSA_APP.PROGRAM_MASTER PM 
ON B.PROGRAM_ID= PM.PROGRAM_ID 
--AND PM.PROGRAM_ID=82 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE PS 
ON PS.BUDGET_ID=B.BUDGET_ID 
AND PS.SUB_BUDGET_ID=SB.SUB_BUDGET_ID 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE_DETAIL PSD  
ON PS.PERSONNEL_SERVICE_ID=PSD.PERSONNEL_SERVICE_ID 
AND PSD.SUB_BUDGET_ID=SB.SUB_BUDGET_ID 
AND PSD.BUDGET_ID=B.BUDGET_ID 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE_TYPE_MASTER PSM 
ON PS.PERSONNEL_SERVICE_TYPE_ID=PSM.PERSONNEL_SERVICE_TYPE_ID 
INNER JOIN HHSA_APP.POSITION P 
ON PS.POSITION_ID=P.POSITION_ID 
WHERE B.AGENCY_ID='DHS' 
--AND PSM.PERSONNEL_SERVICE_TYPE IN ('Hourly Employees','Salaried Employees') 
---AND PM.PROGRAM_ID=82 AND B.FISCAL_YEAR_ID='2018'
AND B.CONTRACT_ID IN (SELECT B.CONTRACT_ID FROM HHSA_APP.CONTRACT B
--WHERE B.EXT_CT_NUMBER = 'BAQTST001')
WHERE B.EXT_CT_NUMBER = 'CTRSTG2152018')
AND SB.SUB_BUDGET_NAME = 'CTRSTG2152018_FY19'



-----
---------------
PS DEtail MG-CC  
---------QC8901
---------------USe
SELECT B.AGENCY_ID, 
O.ORGANIZATION_LEGAL_NAME AS ProviderName, 
PM.PROGRAM_NAME AS ProgramName, 
B.CT_NUMBER As ExternalContractNumber, 
SB.SUB_BUDGET_NAME As SubBudgetName, 
PSM.PERSONNEL_SERVICE_TYPE AS Level4Name, 
P.POSITION, 
P.POSITION_ID, 
PSD.INTERNAL_TITLE As InternalID, 
PSD.ANNUAL_SALARY, 
PSD.HOUR_PER_YEAR AS AnnualHours, 
PSD.CITY_SALARY, 
PSD.RATE 
FROM HHSA_APP.BUDGET B  
INNER JOIN HHSA_APP.SUB_BUDGET SB 
ON B.BUDGET_ID=SB.BUDGET_ID 
INNER JOIN HHSA_APP.ORGANIZATION O 
ON B.ORGANIZATION_ID=O.ORGANIZATION_ID 
INNER JOIN HHSA_APP.PROGRAM_MASTER PM 
ON B.PROGRAM_ID= PM.PROGRAM_ID 
AND PM.PROGRAM_ID=82 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE PS 
ON PS.BUDGET_ID=B.BUDGET_ID 
AND PS.SUB_BUDGET_ID=SB.SUB_BUDGET_ID 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE_DETAIL PSD  
ON PS.PERSONNEL_SERVICE_ID=PSD.PERSONNEL_SERVICE_ID 
AND PSD.SUB_BUDGET_ID=SB.SUB_BUDGET_ID 
AND PSD.BUDGET_ID=B.BUDGET_ID 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE_TYPE_MASTER PSM 
ON PS.PERSONNEL_SERVICE_TYPE_ID=PSM.PERSONNEL_SERVICE_TYPE_ID 
INNER JOIN HHSA_APP.POSITION P 
ON PS.POSITION_ID=P.POSITION_ID 
WHERE B.AGENCY_ID='ACS' AND PSM.PERSONNEL_SERVICE_TYPE IN ('Hourly Employees','Salaried Employees') 
AND PM.PROGRAM_ID=82 AND B.FISCAL_YEAR_ID='2018'
AND B.CONTRACT_ID IN (SELECT B.CONTRACT_ID FROM HHSA_APP.CONTRACT B
WHERE B.EXT_CT_NUMBER = 'CT106820171402627')

-----
SELECT  P.POSITION, 
SUM(PSD.ANNUAL_SALARY)  
FROM HHSA_APP.BUDGET B  
INNER JOIN HHSA_APP.SUB_BUDGET SB 
ON B.BUDGET_ID=SB.BUDGET_ID 
INNER JOIN HHSA_APP.ORGANIZATION O 
ON B.ORGANIZATION_ID=O.ORGANIZATION_ID 
INNER JOIN HHSA_APP.PROGRAM_MASTER PM 
ON B.PROGRAM_ID= PM.PROGRAM_ID 
AND PM.PROGRAM_ID=82 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE PS 
ON PS.BUDGET_ID=B.BUDGET_ID 
AND PS.SUB_BUDGET_ID=SB.SUB_BUDGET_ID 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE_DETAIL PSD  
ON PS.PERSONNEL_SERVICE_ID=PSD.PERSONNEL_SERVICE_ID 
AND PSD.SUB_BUDGET_ID=SB.SUB_BUDGET_ID 
AND PSD.BUDGET_ID=B.BUDGET_ID 
INNER JOIN HHSA_APP.PERSONNEL_SERVICE_TYPE_MASTER PSM 
ON PS.PERSONNEL_SERVICE_TYPE_ID=PSM.PERSONNEL_SERVICE_TYPE_ID 
INNER JOIN HHSA_APP.POSITION P 
ON PS.POSITION_ID=P.POSITION_ID  
WHERE B.AGENCY_ID='ACS' AND PSM.PERSONNEL_SERVICE_TYPE IN ('Hourly Employees','Salaried Employees') 
AND PM.PROGRAM_ID=82 AND B.FISCAL_YEAR_ID='2018'
AND B.CONTRACT_ID IN (SELECT B.CONTRACT_ID FROM HHSA_APP.CONTRACT B
WHERE B.EXT_CT_NUMBER = 'CT106820171402627')
AND PS.POSITION_ID = 258
GROUP BY P.POSITION
-----
-------
-------
4/3/2018
---------


SELECT LENGTH(PAYMENT_VOUCHER_NUM) FROM PAYMENT
WHERE LENGTH(PAYMENT_VOUCHER_NUM) > 11

DESC PAYMENT
------------------
---PRC2 - TST2
SELECT DISTINCT P.AGENCY_ID,
  P.VENDOR_ADDRESS_ID,
  P.BUDGET_FISCAL_YEAR_ID,
  P.PAYMENT_VOUCHER_NUM,
  0 AS DOC_UNIT_CD,
  P.FISCAL_YEAR_ID,
  P.PAYMENT_APPROVED_DATE,
  P.PERIOD,
  P.PAYEE_VENDOR_ADDRESS_ID,
  P.PAYEE_VENDOR_ID,
  PA.PAYMENT_AMOUNT,
  P.PAYMENT_SUBMITTED_DATE,
  P.ORGANIZATION_ID,
  I.INVOICE_START_DATE,
  I.INVOICE_END_DATE,
  nvl(I.INVOICE_SUBMITTED_DATE,I.CREATED_DATE) AS INVOICE_SUBMITTED_DATE,
  I.PROVIDER_INVOICE_NUMBER,
  I.INVOICE_NUMBER,
  PA.ACCOUNTING_LINE,
  NVL(PA.REPORTING_CATEGORY,'null') AS REPORTING_CATEGORY,
  PA.UNIT_OF_APPROPRIATION,
  PA.COMMODITY_LINE,
  '--' AS DOC_VEND_LN_NO,
  PA.BUDGET_CODE,
  PA.FUND_CD AS FUND,
  PA.OBJECT_CODE,
  NVL(PA.RFED_DOC_CD, 'null')     AS REF_DOC_CODE,
  PA.RFED_COMM_LN_NO              AS REF_COMMODITY_LINE,
  PA.RFED_DOC_DEPT_CD             AS REF_DOC_DEPT,
  PA.RFED_DOC_ID                  AS REF_DOC_ID,
  PA.RFED_VEND_LN_NO              AS REF_VENDOR_LINE,
  PA.RFED_ACTG_LN_NO              AS REF_ACCOUNTING_LINE,
  NVL(PA.SUB_OBJECT_CODE, 'null') AS SUB_OBJECT_CODE,
  C.CONTRACT_AMOUNT,
  C.AGENCY_ID AS CONTRACT_AGENCY_ID,
  C.EXT_DOC_VERSION,
  NVL(PA.RFED_DOC_DEPT_CD,'null') AS AGENCY_CODE,
  NVL(RV.VEND_CUST_CD, 'null') VEND_CUST_CD,
  C.EXT_COMMODITY_CODE,
  PA.PAYMENT_ALLOCATION_ID,
  P.PAYMENT_ID,
  P.BUDGET_ADVANCE_ID,
  B.BUDGET_START_DATE,
  P.PAYMENT_VOUCHER_NUM
  || TO_CHAR(TO_NUMBER(PA.COMMODITY_LINE)) AS XPK_PR_DOC_COMM,
  --ROW_NUMBER() OVER (PARTITION BY P.PAYMENT_VOUCHER_NUM ORDER BY 1) AS VEND_INV_LN_NO
  DENSE_RANK() OVER (PARTITION BY P.PAYMENT_VOUCHER_NUM ORDER BY TO_CHAR(TO_NUMBER(PA.COMMODITY_LINE))) AS VEND_INV_LN_NO,
  PA.CL_CODE,
  NVL(IV.DEPT_CD,'null') AS DEPT_CD,
  BA.BUDGET_ADVANCE_NUMBER,
  IV.LN_TYP,
  PA.PAYMENT_AMOUNT AS QTY,
  IV.UNIT_MEAS_CD,
  IV.UNIT_PRICE
FROM HHSA_APP.CONTRACT C,
  HHSA_APP.BUDGET B,
  HHSA_APP.INVOICE I,
  HHSA_APP.PAYMENT P,
  HHSA_APP.ORGANIZATION O,
  HHSA_APP.REF_VENDOR_V R,
  HHSA_APP.PAYMENT_ALLOCATION PA,
  HHSA_APP.BUDGET_ADVANCE BA,
  (SELECT TRIM(DOC_CD
    || DOC_DEPT_CD
    || DOC_ID) AS EXT_CT_NUMBER,
    DEPT_CD,
    DOC_ACTG_LN_NO,
    DOC_COMM_LN_NO,
    QTY,
    UNIT_MEAS_CD,
    UNIT_PRICE,
    LN_TYP
  FROM
    (SELECT A.DOC_CD,
      A.DOC_DEPT_CD,
      A.DOC_ID,
      A.DOC_VERS_NO,
      A.DEPT_CD,
      A.DOC_ACTG_LN_NO,
      A.DOC_COMM_LN_NO,
      RANK() OVER (PARTITION BY A.DOC_CD, A.DOC_DEPT_CD, A.DOC_ID ORDER BY A.DOC_VERS_NO DESC) AS My_Rank,
      C.QTY,
      C.UNIT_MEAS_CD,
      C.UNIT_PRICE,
      C.LN_TYP
    FROM REF_CONTRACTS_A A
    JOIN REF_CONTRACTS_C C
    ON TRIM(A.DOC_CD)          = TRIM(c.DOC_CD)
    AND TRIM(A.DOC_DEPT_CD)    =TRIM(C.DOC_DEPT_CD)
    AND TRIM(A.DOC_ID)         =TRIM(C.DOC_ID)
    AND TRIM(A.DOC_COMM_LN_NO) = TRIM(C.DOC_COMM_LN_NO)
    AND TRIM(A.DOC_VERS_NO)    =TRIM(C.DOC_VERS_NO)
    )
  WHERE My_Rank = 1
  ) IV,
 HHSA_APP.REF_CONTRACTS_V RV
WHERE C.CONTRACT_ID     = B.CONTRACT_ID
AND C.CONTRACT_ID       = P.CONTRACT_ID
AND P.CONTRACT_ID       = I.CONTRACT_ID (+)
AND P.BUDGET_ID         = B.BUDGET_ID
AND P.INVOICE_ID        = I.INVOICE_ID(+)
AND P.ORGANIZATION_ID   = O.ORGANIZATION_ID(+)
AND P.PAYMENT_ID        = PA.PAYMENT_ID
AND O.EIN_ID_NN         = R.TIN(+)
AND P.BUDGET_ADVANCE_ID = BA.BUDGET_ADVANCE_ID(+)
AND PA.RFED_DOC_CD
  || PA.RFED_DOC_DEPT_CD
  || PA. RFED_DOC_ID      = IV.EXT_CT_NUMBER(+)
AND PA.ACCOUNTING_LINE    = IV.DOC_ACTG_LN_NO(+)
AND PA.COMMODITY_LINE     = IV.DOC_COMM_LN_NO(+)
--AND R.VEND_CUST_CD        = RT.VEND_CUST_CD
--AND RT.PRVNT_NEW_SPND_IND = 0
AND P.PROCESS_FLAG        = '1'
AND SYSTIMESTAMP         >= B.BUDGET_START_DATE
AND PA.PAYMENT_AMOUNT     > 0
AND P.DELETE_FLAG         = '0'
AND P.STATUS_ID          IN
  (SELECT STATUS_ID
  FROM HHSA_APP.STATUS_MASTER_R2_R3
  WHERE PROCESS_TYPE = 'Payment'
  AND STATUS         = 'Approved'
  )
AND RV.DOC_CD=PA.RFED_DOC_CD
AND RV.DOC_DEPT_CD=PA.RFED_DOC_DEPT_CD
AND RV.DOC_ID=PA.RFED_DOC_ID--


---PPRC2 ---TST2

SELECT DISTINCT 
  P.AGENCY_ID,
  P.VENDOR_ADDRESS_ID,
  P.BUDGET_FISCAL_YEAR_ID,
  P.PAYMENT_VOUCHER_NUM,
  0 AS DOC_UNIT_CD,
  P.FISCAL_YEAR_ID,
  P.PAYMENT_APPROVED_DATE,
  P.PERIOD,
  P.PAYEE_VENDOR_ADDRESS_ID,
  P.PAYEE_VENDOR_ID,
  PA.PAYMENT_AMOUNT,
  P.PAYMENT_SUBMITTED_DATE,
  P.ORGANIZATION_ID,
  I.INVOICE_START_DATE,
  I.INVOICE_END_DATE,
  I.INVOICE_SUBMITTED_DATE,
  I.PROVIDER_INVOICE_NUMBER,
  I.INVOICE_NUMBER,
  PA.ACCOUNTING_LINE,
  NVL(PA.REPORTING_CATEGORY,'null') AS REPORTING_CATEGORY,
  PA.UNIT_OF_APPROPRIATION,
  PA.COMMODITY_LINE,
  '--' AS DOC_VEND_LN_NO,
  PA.BUDGET_CODE,
  PA.FUND_CD AS FUND,
  PA.OBJECT_CODE,
  NVL(PA.RFED_DOC_CD, 'null')     AS REF_DOC_CODE,
  PA.RFED_COMM_LN_NO              AS REF_COMMODITY_LINE,
  PA.RFED_DOC_DEPT_CD             AS REF_DOC_DEPT,
  PA.RFED_DOC_ID                  AS REF_DOC_ID,
  PA.RFED_VEND_LN_NO              AS REF_VENDOR_LINE,
  PA.RFED_ACTG_LN_NO              AS REF_ACCOUNTING_LINE,
  NVL(PA.SUB_OBJECT_CODE, 'null') AS SUB_OBJECT_CODE,
  C.CONTRACT_AMOUNT,
  C.AGENCY_ID AS CONTRACT_AGENCY_ID,
  C.EXT_DOC_VERSION,
  NVL(PA.RFED_DOC_DEPT_CD,'null') AS AGENCY_CODE,
  NVL(RV.VEND_CUST_CD, 'null') VEND_CUST_CD,
  C.EXT_COMMODITY_CODE,
  PA.PAYMENT_ALLOCATION_ID,
  P.PAYMENT_ID,
  P.BUDGET_ADVANCE_ID,
  B.BUDGET_START_DATE,
  P.PAYMENT_VOUCHER_NUM
  || TO_CHAR(TO_NUMBER(PA.COMMODITY_LINE)) AS XPK_PR_DOC_COMM,
  --ROW_NUMBER() OVER (PARTITION BY P.PAYMENT_VOUCHER_NUM ORDER BY 1) AS VEND_INV_LN_NO
  DENSE_RANK() OVER (PARTITION BY P.PAYMENT_VOUCHER_NUM ORDER BY TO_CHAR(TO_NUMBER(PA.COMMODITY_LINE))) AS VEND_INV_LN_NO,
  PA.CL_CODE,
  NVL(IV.DEPT_CD,'null') AS DEPT_CD,
  BA.BUDGET_ADVANCE_NUMBER,
  IV.LN_TYP,
  PA.PAYMENT_AMOUNT AS QTY,
  IV.UNIT_MEAS_CD,
  IV.UNIT_PRICE
FROM HHSA_APP.CONTRACT C,
  HHSA_APP.BUDGET B,
  HHSA_APP.INVOICE I,
  HHSA_APP.PAYMENT P,
  HHSA_APP.ORGANIZATION O,
  HHSA_APP.REF_VENDOR_V R,
 HHSA_APP.PAYMENT_ALLOCATION PA,
  HHSA_APP.BUDGET_ADVANCE BA,
  (SELECT TRIM(DOC_CD
    || DOC_DEPT_CD
    || DOC_ID) AS EXT_CT_NUMBER,
    DEPT_CD,
    DOC_ACTG_LN_NO,
    DOC_COMM_LN_NO,
    QTY,
    UNIT_MEAS_CD,
    UNIT_PRICE,
    LN_TYP
  FROM
    (SELECT A.DOC_CD,
      A.DOC_DEPT_CD,
      A.DOC_ID,
      A.DOC_VERS_NO,
      A.DEPT_CD,
      A.DOC_ACTG_LN_NO,
      A.DOC_COMM_LN_NO,
      RANK() OVER (PARTITION BY A.DOC_CD, A.DOC_DEPT_CD, A.DOC_ID ORDER BY A.DOC_VERS_NO DESC) AS My_Rank,
      C.QTY,
      C.UNIT_MEAS_CD,
      C.UNIT_PRICE,
      C.LN_TYP
    FROM HHSA_APP.REF_CONTRACTS_A A
    JOIN HHSA_APP.REF_CONTRACTS_C C
    ON TRIM(A.DOC_CD)          = TRIM(c.DOC_CD)
    AND TRIM(A.DOC_DEPT_CD)    =TRIM(C.DOC_DEPT_CD)
    AND TRIM(A.DOC_ID)         =TRIM(C.DOC_ID)
    AND TRIM(A.DOC_COMM_LN_NO) = TRIM(C.DOC_COMM_LN_NO)
    AND TRIM(A.DOC_VERS_NO)    =TRIM(C.DOC_VERS_NO)
    )
  WHERE My_Rank = 1
  ) IV,
HHSA_APP.REF_CONTRACTS_V RV
WHERE C.CONTRACT_ID     = B.CONTRACT_ID
AND C.CONTRACT_ID       = P.CONTRACT_ID
AND P.CONTRACT_ID       = I.CONTRACT_ID (+)
AND P.BUDGET_ID         = B.BUDGET_ID
AND P.INVOICE_ID        = I.INVOICE_ID(+)
AND P.ORGANIZATION_ID   = O.ORGANIZATION_ID(+)
AND P.PAYMENT_ID        = PA.PAYMENT_ID
AND O.EIN_ID_NN         = R.TIN(+)
AND P.BUDGET_ADVANCE_ID = BA.BUDGET_ADVANCE_ID(+)
AND PA.RFED_DOC_CD
  || PA.RFED_DOC_DEPT_CD
  || PA. RFED_DOC_ID      = IV.EXT_CT_NUMBER(+)
AND PA.ACCOUNTING_LINE    = IV.DOC_ACTG_LN_NO(+)
AND PA.COMMODITY_LINE     = IV.DOC_COMM_LN_NO(+)
--AND R.VEND_CUST_CD        = RT.VEND_CUST_CD
--AND RT.PRVNT_NEW_SPND_IND = 0
AND P.PROCESS_FLAG        = '1'
AND PA.PAYMENT_AMOUNT     > 0
AND P.DELETE_FLAG         = '0'
AND P.STATUS_ID          IN
  (SELECT STATUS_ID
  FROM HHSA_APP.STATUS_MASTER_R2_R3
  WHERE PROCESS_TYPE = 'Payment'
  AND STATUS         = 'Approved'
  )
AND RV.DOC_CD=PA.RFED_DOC_CD
AND RV.DOC_DEPT_CD=PA.RFED_DOC_DEPT_CD
AND RV.DOC_ID=PA.RFED_DOC_ID
--and  BUDGET_FISCAL_YEAR_ID = to_char(sysdate, 'YYYY')+1  -- filter on next FY payments  --or
-------and trunc(sysdate) >= to_date('05/01/'||to_char(sysdate, 'YYYY'), 'MM/DD/YYYY') 
--------and trunc(sysdate) <= to_date('06/30/'||to_char(sysdate, 'YYYY'), 'MM/DD/YYYY')
order by P.PAYMENT_VOUCHER_NUM desc

SELECT to_char(sysdate, 'YYYY')+1 FROM DUAL

SELECT * FROM PAYMENT  ORDER BY CREATED_DATE DESC
WHERE PAYMENT_VOUCHER_NUM = '151200488P1'

SELECT * FROM CONTRACT 
WHERE CONTRACT_ID = 5351    CT106820111412776    EXP_EPIN = '07116I0005003'

SELECT * FROM REF_APT_EPIN_MASTER ORDER BY CREATED_DATE DESC        BAQTSTC43  4/3/2018 
WHERE PROCUREMENT_AWARD_EPIN IN ('07116I0005003', 'BAQTSTC43')


SELECT * FROM CONTRACT ORDER BY CREATED_DATE DESC  
WHERE 

UPDATE CONTRACT
SET CONTRACT_TITLE ='BAQTSTC43'
WHERE CONTRACT_ID = 44243;
COMMIT;

/* AWARDED_VENDOR_NAME / VENDOR_FMS_ID: */
select distinct '1 - ROW: 4) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = '0001671513' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('CHILD CARE DISCRETIONARY AWARDS')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> '0001671513' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'CHILD CARE DISCRETIONARY AWARDS' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = '0001671513';

/* Check if EPIN(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_AWARD_EPIN in('BAQTSTC43');

/* Check for latest INTEGRATION_ID, REF_APT_EPIN_ID and PROCUREMENT_EPIN_ID in REF_APT_EPIN_MASTER in the TST database. */
select 'INTEGRATION_ID' as Col, max(INTEGRATION_ID) as MAX_VAL, cast (substr(max(INTEGRATION_ID),-10) as NUMBER) + 1 as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID like('MANUAL000%') union all
select 'REF_APT_EPIN_ID' as Col, cast( max(REF_APT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(REF_APT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER union all
select 'PROCUREMENT_EPIN_ID' as Col, cast( max(PROCUREMENT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(PROCUREMENT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER;

1999994827

/* Check if INTEGRATION_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID in('MANUAL00000BAQTST43') union all

/* Check if REF_APT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where REF_APT_EPIN_ID in('1999994827') union all

/* Check if PROCUREMENT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_EPIN_ID in('1999994827');


/* Create EPINs - Insert Statement */	
SET autocommit off	
SET define off	
whenever SQLERROR exit rollback	
	
insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('BAQTST2','BAQTSTC43','C','30000','CHILD CARE DISCRETIONARY AWARDS','0001671513',to_timestamp('01-JUL-17','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-20','DD-MON-RR HH.MI.SS.FF AM'),'CHILD CARE DISCRETIONARY AWARDS','DHS','071','DHSI0005003','CT1071432018',null,null,null,null,null,null,'RQS','MANUAL00000BAQTST43','1999994827','1999994827',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');	
	
commit;	
	
	
/* Create EPINs - Rollback Statement */	
SET autocommit off	
SET define off	
whenever SQLERROR exit rollback	
	
delete from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID = 'MANUAL00000BAQTST43';	
	
commit;	

-------------
QC9019 ---
----------
For a number of Payment Tasks (either through an Invoice or an Advance), Commodity Lines are missing. This is due to record(s) not being inserted into the PAYMENT_ALLOCATION table by the batch job.
 
The sql statement from the Batch job that updates PAYMENT_ALLOCATION (which appears as the Commodity Lines in the Payment Task) is only considering the DOC_ID from the Ref tables (REF_CONTRACTS_A and REF_CONTRACTS_C) to identify a Contract Number. 
There are 3 fields that make up the Contract Number in these Ref tables: DOC_CD, DOC_DEPT_CD and DOC_ID (e.g. DOC_CD || DOC_DEPT_CD || DOC_ID ).
 
This sql needs to be updated where applicable to consider:  DOC_CD || DOC_DEPT_CD || DOC_ID as the Contract Number.

QC9026 ---
----------
Steps to recreate:
 
Pre req:
Get the Amendments Eping for Renwal (type 3) contracts, by using following query. 
 
select  CONTRACT_ID, parent_contract_id, contract_type_id, EXT_EPIN , status_id  from HHSA_APP.contract
where parent_contract_id in ( 
select contract_id
from HHSA_APP.contract
where contract_type_id = 3
and contract_id <> parent_contract_id
)
and contract_type_id = 2
and status_id = 62
; 
 
Steps
Login as Accelerator
Navigate to Financials > Amendment List
Filter the Amendment using the Epin (Result from above query)
Click on Action Drop down and Select "View Contract"
In the Contract Page, Click on Action dropdown and select "View Amendments"
 
Expected Result:
System should display the same amendment you navigated or list of amendments if there are any other
 
Actual 
System does not display the amendment in the amendment list. 
----------
----------------
4/6/2019

*Production migration verification for QC6726  
New Field added
SELECT A.CITY_USER_NAME, A.* FROM ANAHHS.WC_BUS_APPLICATION_D A
In CPR production
QC6726

*Production migration verification for QC8997
In CPR Production
qc8997_production_mig_verification

*WinSCP setup in desktop
 -Worked with TechOps to test the connections to FTP file server.

*Completed lessons learned for 1.16

* Worked on QC
  - Updated QC6543 with information pertaining to the issue.



TST
mstlva-ctwcpr-infor1.csc.nycnet
22
mike.bostanci

STG
msslva-ctwcpr-infor1.csc.nycnet
22
mike.bostanci


QC6543 Analysis

SELECT A.COMMODITY_LINE,
A.CL_CODE,
A.LN_TYPE,
A.LN_DESCRIPTION,
A.ACCOUNTING_LINE,
A.UNIT_OF_APPROPRIATION,
A.BUDGET_CODE,
A.OBJECT_CODE,
A.SUB_OBJECT_CODE,
A.REPORTING_CATEGORY,
A.LINE_AMOUNT,
A.ACTUALS,
A.REMAINING_AMOUNT,
A.PAYMENT_AMOUNT,
(SELECT SUM(C.PAYMENT_AMOUNT) FROM HHSA_APP.PAYMENT_ALLOCATION C,HHSA_APP.PAYMENT D
WHERE C.PAYMENT_ID =D.PAYMENT_ID
AND D.PAYMENT_VOUCHER_NUM = '150200382P1'
---AND D.DELETE_FLAG <> '1'
---AND D.DELETE_FLAG <> '1'
) AS TOTP

FROM HHSA_APP.PAYMENT_ALLOCATION A, HHSA_APP.PAYMENT B

WHERE A.PAYMENT_ID =B.PAYMENT_ID
AND B.PAYMENT_VOUCHER_NUM = '150200382P1'

DESC HHSA_APP.PAYMENT_ALLOCATION
DESC HHSA_APP.PAYMENT
-------------------------------

Time Tracker:
\\csc.nycnet\mocs\mocs_hhs_accel\Application_Support\Project Management\Bostanci, Mike


QC5665:
"SELECT
A.ORGANIZATION_ID,
A.USER_ID,
A.BUSINESS_APPLICATION_ID,
A.STATUS_ID, 
A.BC_EXECUTIVE, 
A.BC_FINANCE, 
A.BC_AUDIT, 
A.MIN_BOARD_MEETINGS, 
A.CON_BOARD_MEETINGS, 
A.ANNUAL_BUDGET, 
A.POLICIES_PROCEDURE, 
A.EXEC_PERFORMANCE,
A.FUND_RAISING,
A.INTERNAL_CONTROLS, 
A.ANN_IND_AUDIT, 
A.FORM_IRS_990, 
A.PROG_OPP_OUTCOMES,
A.BANK_ACC,
A.BUY_SELL,
A.DUTIES_NONE,
A.REVIEW_FINANCIALS,
A.OTHER_REVIEW_FINANCIALS,
A.BUDGET_CASH_PROJECTIONS,
A.OTHER_CASH_BUDGET_PROJ,
A.MIN_TRAININGS,
A.BC_NA,
B.ORG_EXEMPT,
B.RELIGIOUS_ORGANIZATION,
B.EDUCATION_INSTITUTE,
B.PATRIOTIC,
B.HISTORICAL_SOCIETIES,
B.RELIEF,
B.OTHER_EXEMPTIONS,
B.OTHER_EXEMP_EXPLAIN,
B.ORG_REG_ID,
B.REGISTRATION_TYPE,
B.ORG_REG_WITH_CHARI,
B.NO_SEC_CHAR_EXT,
B.IRS,
B.REVOKED,
B.CURR_TAX_EXPLAIN,
B.IRS_FORM_990EXT,
B.SELECT_COMPLETED_AUDIT,
B.INDEPENDENT_AUDIT,
B.WERE_MATERIAL_FINDINGS,
B.MATERIAL_FINDINGS,
B.NO_MATERIAL_FINDINGS,
B.OTHER_MATERIAL_FINDINGS,
B.A133_SINGLE_AUDIT,
B.A133_WERE_MATERIAL_FINDINGS,
B.A133_NO_MATERIAL_FINDINGS,
B.CURR_TAX_FILINGS,
B.ANNUAL_OPERATING_BUDGET, 
C.SIGN_CHECK,
C.INDICATE_SIGN_CHECK,
C.ENTER_AMOUNT,
C.PLEASE_EXPLAIN_AMOUNT,
C.RECORD_FINANCIALS,
C.FIN_TRANSACTION_EXPLAIN,
C.ACC_RECONCILED,
C.ELEC_ACC,
C.PAYROLL_SYSTEM,
C.CEO_POLICY,
C.EMP_POLICY,
C.ANTI_NEPO,
C.STAFF_CODE_CONDUCT,
C.DOC_RETEMP_POLICY,
C.DIRECTOR_CONFLICT,
C.CONFLICT_INTEREST,
C.CONTI_OPP,
C.DIVERSITY,
C.EMERGENCY_POL,
C.WHISTLE_BLOWER,
C.RECORD_RETTEN,
C.SECURITY_POL,
C.TRANSITION,
C.POLICY_NONE,
C.EEO_POLICY,
C.PROFESSIONAL_DEV,
C.EXPLAIN_OTHER_DEVELOPMENT_PLAN,
C.MIN_TRAINING_ANNUAL,
C.PERFORM_EVAL,
C.OTHER_PERFORM_EVAL,
C.OVERALL_PERFORMANCE,
C.OTHER_OVERALL_PERFORMANCE
FROM  BOARD_FORM A, FILING_FORM B, POLICIES_FORM C   
WHERE A.ORGANIZATION_ID = B.ORGANIZATION_ID
AND A.USER_ID = B.USER_ID
AND A.BUSINESS_APPLICATION_ID = B.BUSINESS_APPLICATION_ID
AND B.ORGANIZATION_ID = C.ORGANIZATION_ID
AND B.USER_ID = C.USER_ID
AND B.BUSINESS_APPLICATION_ID = C.BUSINESS_APPLICATION_ID
ORDER BY A.ORGANIZATION_ID"


----
----
4-9-2018

QC9032 Analysis
--------------------
SELECT * FROM HHSA_APP.PAYMENT P1
WHERE p1.PAYMENT_ID   IN
    (SELECT P2.PAYMENT_ID  FROM HHSA_APP.payment P2
   WHERE (P2.STATUS_ID          = 63 OR (P2.STATUS_ID             = 64 AND P2.PROCESS_FLAG          = 1)
    OR (P2.STATUS_ID             = 64 AND P2.PROCESS_FLAG          = 0 AND P2.PAYMENT_APPROVED_DATE > TO_DATE(TO_CHAR(SYSDATE-1, 'yyyy-MM-dd') || '16:00:00','yyyy-MM-dd HH24:MI:SS')))
    AND P1.DELETE_FLAG           != 1
   --- AND CONTRACT_ID            = ?
    AND P1.BUDGET_FISCAL_YEAR_ID IN
      ( SELECT P3.BUDGET_FISCAL_YEAR_ID FROM HHSA_APP.payment P3
      ---WHERE PAYMENT_ID = ?
      )
    )
    

---
---63 pending approval
---64 approved
---65 disbursed
---
SELECT * FROM HHSA_APP.STATUS_MASTER_R2_R3
WHERE PROCESS_TYPE LIKE  'Payment%'


---
 
SELECT PP.PROCESS_FLAG, PP.PAYMENT_ID, PP.STATUS_ID, PP.PAYMENT_APPROVED_DATE, PP.BUDGET_FISCAL_YEAR_ID FROM HHSA_APP.PAYMENT PP
WHERE PP.PAYMENT_ID IN ('58066','59845','62553','63038','63364','63767','65131')


H4S4CC3L3R4T0R 5U990RT2A 

hhsaccelerator_support@hhsaccelerator.nyc.gov
Help@2014



---DFTA 
Register amendment

------
SELECT * FROM CONTRACT 
WHERE PROCUREMENT_TITLE = '13G BRONXWORKS INNOVATIVE SENIOR CENTER'

UPDATE CONTRACT
SET STATUS_ID = 118
WHERE CONTRACT_ID = 44723;
commit;
------


CT1071BAQAENCTST1		


----
Disbursement
----
DISBURSE INVOICE
AND ADVANCE
----------------

---1st set of queries
SELECT * FROM PAYMENT
ORDER BY CREATED_DATE DESC    ---165009

update  PAYMENT set STATUS_ID =65,DISBURSEMENT_DATE = '31-JAN-2018',CHECK_EFT_NUM = 'MANUAL000000030',PROCESS_FLAG=0,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where PAYMENT_ID = 165008;   ---- 8128;
commit;
update  PAYMENT set STATUS_ID =65,DISBURSEMENT_DATE = '31-JAN-2018',CHECK_EFT_NUM = 'MANUAL000000030',PROCESS_FLAG=0,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where PAYMENT_ID = 8129;
commit;
update  PAYMENT set STATUS_ID =65,DISBURSEMENT_DATE = '31-JAN-2018',CHECK_EFT_NUM = 'MANUAL000000030',PROCESS_FLAG=0,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where PAYMENT_ID = 8127;
commit;
--2nd set of queries to disburse the budget advance so that invoice can be recoup against
SELECT * FROM BUDGET_ADVANCE ORDER BY CREATED_DATE DESC 

update BUDGET_ADVANCE set PREV_STATUS_ID= 93,STATUS_ID = 125,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where BUDGET_ADVANCE_ID IN (12578);
----(4361,4362,4363);
commit;
-----2nd query



----
----







Leave calendar---
leaveCalendar@mocs.nyc.gov









----
----
6/14/2018

Select * From Stg_Invoice_Details


Select *  From Contract
---WHERE STATUS_ID = 118
Order By Created_Date Desc



Select * From Stg_Contracts_A  ---
Select * From Stg_Contracts_B
Select * From Stg_Contracts_C   ---
Select * From Stg_Contracts_H   ---
Select * From Stg_Contracts_I
Select * From Stg_Contracts_M
Select * From Stg_Contracts_R
Select * From Stg_Contracts_S
Select * From Stg_Contracts_T
Select * From Stg_Contracts_U 
Select * From Stg_Contracts_V    ---
Select * From Stg_Contracts_W 


Select A.Ext_Epin, A.*  
From Contract A 
Where A.Ext_Epin = 'BAQTSTC90' And A.Contract_Type_Id  In (1,3)
Order By Created_Date Desc

A.Ext_Epin = 'BAQTSTC90' From Above

Select A.Vendor_Fms_Id, A.Ref_Apt_Epin_Id , A.Procurement_Epin_Id, A.Procurement_Award_Epin  
From Ref_Apt_Epin_Master A
Where  A.Procurement_Award_Epin = 'BAQTSTC90'     -- 2nd mismatch for vend_cust_cd on  ref_vendor_v does not match  apt_epin_master vendor_fms_id 

A.Vendor_Fms_Id  From Above

Select B.Tin, B.Vend_Cust_Cd, B.* From Ref_Vendor_V  B
Where Vend_Cust_Cd = 'VD001302023'

B.Tin = '04-0000004'   --- made it  '04-0000005' mismatch

Update Ref_Vendor_V
Set Tin = '04-0000005'   ---mis
Where Tin = '04-0000004' --- orig
Commit;

Put Back

Update Ref_Vendor_V
Set Tin = '04-0000004'   ---mis
Where Tin = '04-0000005' --- orig
Commit;


---2  FMS vendor ID mismatch
Update Ref_Vendor_V
Set Vend_Cust_Cd = 'VD001302023'     ---orig
---
--- B.TIN, B.VEND_CUST_CD, B.* FROM REF_VENDOR_V  B
Where Vend_Cust_Cd = 'VD001302024';  ---mis
Commit;

Select B.Tin, B.Vend_Cust_Cd, B.* From Ref_Vendor_V  B
Where Vend_Cust_Cd = 'VD001302024'    -- orig is  'VD001302023';

Select B.Tin, B.Vend_Cust_Cd, B.* From Ref_Vendor_V  B
Where Vend_Cust_Cd = 'VD001302023'


B.Tin From Above

Select  C.Organization_Id , C.* From Contract C
Where Contract_Title = 'BAQTSTC90'
Order By Created_Date Desc 

'Org_4981' From Above

Select D.Ein_Id_Nn, D.*  From Organization D
Where  D.Organization_Id = 'Org_4981'
And D.Ein_Id_Nn = '04-0000004'


From File
17SGEOL00701
20181411701



/Fms3/Fms32ahhs/Istfms02/Aido_Dly_Pco_Po_20180320202402.Asc


Select C.Status_Id,  C.Organization_Id , C.* From Contract C
Where C.Contract_Title = 'BAQTSTC90'
And C.Contract_Type_Id In (1,3)
Order By C.Created_Date Desc 

Select * From 
Before
61	Org_4981	45203	1		2		Baqtstc90	Dop	Org_4981
60	Org_4981	45204	6		2		Baqtstc90	Dop	Org_4981

After
61	Org_4981	45203	1		2		Baqtstc90	Dop	Org_4981
60	Org_4981	45204	6		2		Baqtstc90	Dop	Org_4981

After 
---
Successful
All Match
59	Org_4981	45223	4		2		Baqtstc90	Dop	Org_4981	Ct1781baqtstc90
60	Org_4981	45204	6		2		Baqtstc90	Dop	Org_4981	
62	Org_4981	45203	1		2		Baqtstc90	Dop	Org_4981	Ct1781baqtstc90


Select * From Organization

Jhtest0001


Select A.Vendor_Fms_Id, A.*  From Ref_Apt_Epin_Master A
Where Ref_Apt_Epin_Id In (Select Vend_Cust_Cd From Stg_Contracts_V)
--WHERE AWARD_EPIN_ID IN (SELECT VEND_CUST_CD FROM STG_CONTRACTS_V)





Load_Date 5/24/2018



Select Trkg_No From Stg_Contracts_H 

Select Ext_Epin From Contract
Where Ext_Epin In (Select Trkg_No From Stg_Contracts_H)


Select A.Ext_Epin,A.Contract_Type_Id,  A.* From Contract A 
Where 
---A.CONTRACT_TYPE_ID IN (1,3)
---AND
Ext_Epin = 'BAQTSTC90'
Order By Last_Update_Date Desc 



-----
------
Contract_Type = 1  Base 
Contract_Type = 3 Renewal Contract



Rfed_Doc_Ids
20180001772
20182014521
20182014521


Select * From Payment
Order By Created_Date Desc 

Select * From Contract
Where Ext_Ct_Number = 'BAQTSTC82'

Select * From Ref_Apt_Epin_Master



Update Contract
Set Status_Id = 118
Where Ext_Epin = 'BAQTSTC91';
Commit;


Select * From Payment
Order By Created_Date Desc 


Update  Payment Set Status_Id =65,Disbursement_Date = '31-MAR-2018',Check_Eft_Num = 'MANUAL000000032',Process_Flag=0,Modified_Date = Systimestamp,Modified_By_Userid  = 'system' 
Where Payment_Id =  9548; 
9527; 
---9547  9548;   ---- 8128;
Commit;


Update Contract
Set Status_Id = 118
Where Ext_Ct_Number = 'BAQTSTC71';
Commit;

Select * From Contract
Where Ext_Ct_Number = 'BAQTSTC71'



Select * From Contract
Where Contract_Id = 45243
45284

Select * From User_Level_Audit
----WHERE 
---CONTRACT_ID = 45243
---AND 
---ENTITY_NAME = 'Budget'
Order By Modified_Date Desc, Reporting_Modified_Date Desc, Event_Type Desc


Select * From Ref_Apt_Epin_Master
Order By Created_Date Desc 


---1.-------
Select * From Agency_Audit
Order By Audit_Date Desc, Modified_Date Desc
----106146	Task Creation	Task Creation	05-JUN-18 10.44.33.058677000 AM	Task Assigned to: Unassigned Level 1	Contract Configuration	45303	05-JUN-18 10.44.33.000000000 AM	city_1	05-JUN-18 10.44.33.000000000 AM	city_1


Desc User_Level_Audit


---
2.
Select * From User_Level_Audit
----WHERE 
---CONTRACT_ID = 45243
---AND 
---ENTITY_NAME = 'Budget'
Order By Modified_Date Desc, Reporting_Modified_Date Desc, Event_Type Desc

41732	639C9795D6772241A7F02307371B276C	1	Workflow Launch	Contract Configuration	45303	Contract	Level 1	City	45303	City_1	05-Jun-18 10.44.33.216465000 Am	City_1	05-Jun-18 10.44.33.216465000 Am			Unassigned				05-Jun-18 10.44.33.216965000 Am


--preovider submited the budget
Select * From Provider_Audit
Order By Audit_Date Desc 



Select * From Application_Audit
Order By Audit_Date Desc 


Select * From Contract
Order By Created_Date Desc 


Update Contract
Set Status_Id = 118
Where Ext_Ct_Number In ('BAQTSTC99','BAQTSTC98','BAQTSTC97');
Commit;


Select * 
From 
Contract 
Order By Created_Date Desc


Select * From Budget
Where Budget_Id = 9562


Select * From Invoice
Where Invoice_Number = 180501065


----
----6/4/2018 
Select A.Reporting_Modified_Date, A.Organization_Legal_Name, A.Organization_Id, A.Organization_Type, A.Organization_Status, A.Organization_Active_Flag 
From 
Organization A
Where A.Organization_Status = 'Approved'

-----
-----


Qc7435
User Level Audit Data. Example: 
On 5/25/2017- Provider Changed Status Of Budget From 'pending submission' To 'pending approval'
On 6/3/2017- Agency Changed Status Of Budget From 'in review' To 'returned for revision'
Currently Etl Calculates The Days Between 5/25 And 6/3 As With Provider Whereas, It Should Have Been With Agency Instead. Dev Team Has Found A Design That Will Resolve This Discrepancy And We Will Implement The Resolution To Budgets As Of Now.

Select B.* From Contract B
Where B.Contract_Id In (
Select A.Contract_Id From Budget A
Where A.Budget_Id In ( 9706,9703,9701, 9698))


Select A.* , B.* From Contract B, Budget A
Where B.Contract_Id =  A.Contract_Id 
And B.Contract_Type_Id = 6





Select A.Assigned_To,
  A.Workflow_Id || '|' || A.Task_Sequence As Integration_Id, 
  A.Task_Sequence,
  A.Event_Type,
  A.Task_Type,
  A.Entity_Id, 
  A.Entity_Name,
  A.Task_Level,
  A.User_Type, 
  A.Created_By_User_Id, 
  A.Created_Date,
  A.Modified_By_User_Id,
  A.Modified_Date,
  A.Next_Level,
  Cud.First_Name || ' ' || Cud.Last_Name As Assign_To_Name,
  A.Created_By_Staff_Id,
  A.Modified_By_Staff_Id, 
  A.Finish_Event
From
  Hhsa_App.User_Level_Audit A
  Left Join Hhsa_App.City_User_Details Cud On A.Assigned_To = Cud.User_Id
Where
  A.End_Date Is Not Null
---    and a.entity_id IN (675)
---   and a.workflow_id  in ('CC389ABABDFA154DA146E4332B7EF0D4','DC4EAC405670AD41B05EF89EB6341209')
---   and a.entity_id = 9701
   Order By A.Created_Date Desc


Select A.* , B.* From Contract B, Budget A
Where B.Contract_Id =  A.Contract_Id 
And A.Budget_Id = 9701


Select * From Invoice_Details
Order By Created_Date Desc 
---Invoice_id = 22517  22516  519 600

Select * From Invoice
Order By Created_Date Desc  
---invoice_id = 22517

Select * From Sub_Budget
Where Sub_Budget_Id = 125613

Select * From Payment
Order By Created_Date Desc

19418	180600003P1	519
19417	180600002P1	600

19415
19416

Disburse
Update  Payment Set Status_Id =65,Disbursement_Date = '13-JUN-2018',Check_Eft_Num = 'MANUAL000000068',Process_Flag=0,Modified_Date = Systimestamp,Modified_By_Userid  = 'system' 
Where Payment_Id = 9627; 
Commit;


1	1	85813	1	122593	0	1	True	06/08/2018 14:27:41

Select * From Stg_Invoice_Details

Select * From Invoice_Details
Order By Created_Date Desc 

Select * From Invoice
Where Invoice_Id = 1227


Select * From Hhsa_App.Interface_Error_Master
Order By Error_Id  Desc 

Where Error_Code = 'ERR013'


Where Error_Desc Like '%Invoice%'


Select * From Agency_Audit

Select * From Application_Audit
Order By Audit_Date Desc 


Select * From Organization
Order By Reporting_Modified_Date Desc



Select A.Modified_Date, A.Reporting_Modified_Date, A.* 
From Organization A
--WHERE ORGANIZATION_ID = 'Org_3503'
Order By A.Reporting_Modified_Date Desc, A.Modified_Date Desc


Select * From Payment 
Order By Created_Date Desc 

Baqtst027

9607
9587

Update  Payment Set Status_Id =65,Disbursement_Date = '08-JUN-2018',Check_Eft_Num = 'MANUAL000000069',Process_Flag=0,Modified_Date = Systimestamp,Modified_By_Userid  = 'system' 
Where Payment_Id = 9587; 
Commit;








With Audit_Status As (   
  Select 'Accelerator' As Type, Accelerator_Audit_Id As Audit_Id, Event_Name, Event_Type, Audit_Date, Data, Entity_Type, Entity_Id From Accelerator_Audit
  Union All
  Select 'Agency' As Type, Agency_Audit_Id As Audit_Id, Event_Name, Event_Type, Audit_Date, Data, Entity_Type, Entity_Id From Agency_Audit
  Union All
  Select 'Provider' As Type, Provider_Audit_Id As Audit_Id, Event_Name, Event_Type, Audit_Date, Data, Entity_Type, Entity_Id From Provider_Audit
), Audit_Timing As(
  Select 
    Lead(Type, 1) Over (Partition By Entity_Id Order By Audit_Date) As Type2 , Upper(Type)||'-'||Audit_Id As Integration_Id, Entity_Id, Data, Audit_Date,
    Min(Audit_Date) Over (Partition By Entity_Id) D, Count(1) Over (Partition By Entity_Id) C, 
    Lead(Audit_Date, 1) Over (Partition By Entity_Id Order By Audit_Date) As Audit_Date_To 
  From Audit_Status
  Where Upper(Data) Like '%STATUS%' And Upper(Entity_Type) Like '%BUDGET%'
)
Select
  Entity_Id As Budget_Id, Cast(Audit_Date As Date) As Audit_Date, Cast(Audit_Date_To As Date) As Audit_Date_To, 
  Round((Cast(Audit_Date_To As Date)-Cast(Audit_Date As Date))*24*60*60,2) As Secs_Elapsed,
  Initcap(Trim(Both '''' From Substr(Data,Instr(Upper(Data),'TO',-1)+3))) As Status, Type2, Integration_Id 
From Audit_Timing
Where Audit_Date > Sysdate - 2000
Order By D Desc, Entity_Id, Audit_Date




---
---
Select 
Current_Date-To_Date(To_Char(Org.Reporting_Modified_Date, 'YYYY-MON-DD HH24:MI:SS'), 'YYYY-MON-DD HH24:MI:SS'),
Org.Reporting_Modified_Date,
  Org.Organization_Id, 
  Org.Organization_Type, 
  Org.Organization_Status, 
  Org.Mission_Statement, 
  Org.Organization_Legal_Name, 
  Org.Organization_Active_Flag, 
  Org.Duns_Id, 
  Org.Organization_Creation_Date, 
  Org.Organization_Expiration_Date, 
  Org.Accounting_Period_Start_Month, 
  Org.Accounting_Period_End_Month, 
  Org.Ein_Id_Nn, 
  Org.Overriding_Flag, 
  Org.Overriding_Reason, 
  Org.Entity_Type_Id, 
  Org.Alternate_Name, 
  Org.Corporate_Structure_Id, 
  Org.Email_Address, 
  Org.Phone_Number, 
  Org.Proc_Status, 
  Org.Submission_Date, 
  Org.Organization_Start_Date, 
  Org.Address_1, 
  Org.Address_2, 
  Org.City, 
  Org.Borough, 
  Org.State, 
  Org.Zip_Code, 
  Org.Website, 
  Org.Fax_Number, 
  Org.Other_Please_Specify, 
  Org.Twitter_Sm, 
  Org.Facebook_Sm, 
  Org.Other_Sm, 
  Org.None_Sm, 
  Org.Twitter, 
  Org.Facebook_Page, 
  Org.If_Other_Social, 
  Org.User_Id, 
  Staff.First_Name, 
  Staff.Middle_Initial, 
  Staff.Last_Name, 
  Mem.Member_Name As Title,
  Staff.Phone, 
  Staff.Email, 
  Org.Org_Status_Change_Date, 
  Org.Val_Status_Decscription, 
  Org.Val_Status_Reason_Text, 
  Org.Val_Norm_House_Number, 
  Org.Val_Norm_Street_Name, 
  Org.Val_City, 
  Org.Val_State, 
  Org.Val_Zip_Code, 
  Org.Val_X_Coordinate, 
  Org.Val_Y_Coordinate, 
  Org.Val_Community_District, 
  Org.Val_Civial_Court_District, 
  Org.Val_School_Distr_Name, 
  Org.Val_Health_Area, 
  Org.Val_Building_Id_Number, 
  Org.Val_Borough, 
  Org.Val_Tax_Block, 
  Org.Val_Tax_Lot, 
  Org.Val_Congress_District, 
  Org.Val_Senator_District, 
  Org.Val_Assembly_District, 
  Org.Val_Council_District, 
  Org.Val_Low_End_Cross_Street_No, 
  Org.Val_High_End_Cross_Street_No, 
  Org.Val_Low_End_Cross_Street_Name, 
  Org.Val_High_End_Cross_Street_Name, 
  Org.Val_Latitude, 
  Org.Val_Longitude 
From
 Organization Org
 Left Join Staff_Details Staff On Org.User_Id = Staff.Staff_Id
 Left Join Staff_Organization Staff_Org On Staff.Staff_Id = Staff_Org.Staff_Id 
	And Staff_Org.Organization_Id = Org.Organization_Id
 Left Join Member_Title Mem On Member_Id = Staff_Org.Title
Where Current_Date-To_Date(To_Char(Current_Date-To_Date(To_Char(Org.Reporting_Modified_Date, 'YYYY-MON-DD HH24:MI:SS'), 'YYYY-MON-DD HH24:MI:SS'), 'YYYY-MON-DD HH24:MI:SS'), 'YYYY-MON-DD HH24:MI:SS') <= 2000


Update Organization
Set Reporting_Modified_Date = '12-JUN-18 10.28.09.473000000 AM'
Where Organization_Id = 'Org_441';
Commit;


Select Contract_Id, Contract_Title, Agency_Id 
From Contract
Where  
Contract_Title Like 'BAQTSTC__7';


Select * From 
Contract  
Where Ext_Ct_Number = 'BAQTSTC89'
Order By Created_Date Desc 

Select * From Ref_Apt_Epin_Master


Select A.Assigned_To,
  A.Workflow_Id || '|' || A.Task_Sequence As Integration_Id, 
  A.Task_Sequence,
  A.Event_Type,
  A.Task_Type,
  A.Entity_Id, 
  A.Entity_Name,
  A.Task_Level,
  A.User_Type, 
  A.Created_By_User_Id, 
  A.Created_Date,
  A.Modified_By_User_Id,
  A.Modified_Date,
  A.Next_Level,
  Cud.First_Name || ' ' || Cud.Last_Name As Assign_To_Name,
  Cud2.First_Name || ' ' || Cud2.Last_Name,
  A.Created_By_Staff_Id,
  A.Modified_By_Staff_Id, 
  A.Finish_Event
From
  Hhsa_App.User_Level_Audit A
  Left Join Hhsa_App.City_User_Details Cud On A.Assigned_To = Cud.User_Id
  Left  Join Hhsa_App.City_User_Details Cud2 On A.Created_By_User_Id = Cud2.User_Id   ---mb  check
Where
  A.End_Date Is Not Null
    And A.Entity_Id In (675)
   And A.Workflow_Id  In ('CC389ABABDFA154DA146E4332B7EF0D4','DC4EAC405670AD41B05EF89EB6341209')
   Order By A.Created_Date 




-----
------

SQLPLUS HHSA_APP/l0qa205orr8_q18@HACWTS2



====

Original(
IFNULL(FILTER("Fact - Invoice Line"."Invoice Line Amount" USING (Invoice.Status IN ('Approved', 'Pending Approval'))), 0)
Original(

IFNULL(FILTER("Fact - Invoice Line"."Invoice Line Amount" USING (Invoice.Status IN ('Approved', 'Pending Approval'))), 0)


"Fact - Budget Line"."Budget Line Amount"-IFNULL((FILTER("Fact - Invoice Line"."Invoice Line Amount" USING (Invoice.Status IN ('Approved', 'Pending Approval')))), 0)


(("Fact - Budget Line"."Budget Line Amount"-IFNULL((FILTER("Fact - Invoice Line"."Invoice Line Amount" USING (Invoice.Status IN ('Approved', 'Pending Approval')))),0))/"Fact - Budget Line"."Budget Line Amount")*100






------------------------------
wf_Agency_budget_outbound
----
Source:
-----

SELECT
IV.BUDGET_ID,
IV.CONTRACT_ID,
IV.CT_NUMBER,
IV.BUDGET_FISCAL_YEAR,
IV.AGENCY_CODE,
IV.STATUS,
IV.SRC_INTEGRATION_ID,
IV.CREATED_DATE,
IV.MODIFIED_DATE,
IV.TGT_INTEGRATION_ID,
IV.ROW_WID
FROM (
 SELECT
    B.BUDGET_ID,
    B.CONTRACT_ID,
    -- B.CT_NUMBER,
   (SELECT C.EXT_CT_NUMBER FROM HHSA_APP.CONTRACT C WHERE C.CONTRACT_ID = B.CONTRACT_ID ) as CT_NUMBER,
    (SELECT FY.FISCAL_YEAR FROM FISCAL_YEAR FY WHERE B.FISCAL_YEAR_ID = FY.FISCAL_YEAR_ID) as BUDGET_FISCAL_YEAR,
    R23.STATUS,
    (SELECT AGENCY_CODE FROM HHSA_APP.NYC_AGENCY_DETAILS N WHERE B.AGENCY_ID = N.AGENCY_ID ) as AGENCY_CODE,
    DBMS_CRYPTO.HASH(UTL_RAW.CAST_TO_RAW(UPPER(TRIM(B.BUDGET_ID)) || UPPER(TRIM(B.CONTRACT_ID)) || UPPER(TRIM(B.CT_NUMBER)) || UPPER(TRIM(B.FISCAL_YEAR_ID)) || UPPER(TRIM(B.STATUS_ID)) || UPPER(TRIM(B.AGENCY_ID))),2) AS SRC_INTEGRATION_ID, 
    B.CREATED_DATE,
    B.MODIFIED_DATE,
    R.INTEGRATION_ID AS TGT_INTEGRATION_ID,
    R.ROW_WID,
    (SELECT STATUS FROM HHSA_APP.STATUS_MASTER_R2_R3 R23I WHERE R23I.PROCESS_TYPE = 'Budget' AND B.PREV_STATUS_ID = R23I.STATUS_ID  ) as PREV_STATUS     
FROM 
    HHSA_APP.BUDGET B,
    HHSA_APP.REF_BUDGET_MAIN R,
    HHSA_APP.STATUS_MASTER_R2_R3 R23 
WHERE 
    B.BUDGET_ID = R.BUDGET_ID(+)
AND B.BUDGET_TYPE_ID  = 2  
AND B.STATUS_ID = R23.STATUS_ID 
AND B.DELETE_FLAG = '0'
AND R23.PROCESS_TYPE = 'Budget' AND R23.STATUS IN ('Approved','Active','Suspended','Closed')
AND TRUNC(B.MODIFIED_DATE) >= TO_DATE('$$START_DT','MM-DD-YYYY' ) 
) IV
WHERE  (IV.STATUS <> 'Suspended' OR (IV.STATUS = 'Suspended' AND IV.PREV_STATUS IN ('Approved','Active'))) --

Target for the budget outbound that goes to cpr
SELECT * FROM REF_BUDGET_MAIN
ORDER BY ETL_PROCESSED_DATE DESC    

----
----
Payment_disburse
----
update  PAYMENT set STATUS_ID =65,DISBURSEMENT_DATE = '25-JUN-2018',CHECK_EFT_NUM = 'MANUAL000000083',PROCESS_FLAG=0,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where PAYMENT_ID = 9807;   ---- 8128;
commit;

----
----

Issue:
QC6806: follow up:
When Reporting Modified date is null the data is not sent to CPR.
Enhance the process to use Modified_date  or (last_update_date) on Budget table
if the Reporting modified date is null.

----
----

SELECT A.BUDGET_ID, A.CONTRACT_ID , A.FISCAL_YEAR_ID , A.REPORTING_MODIFIED_DATE, A.MODIFIED_DATE, A.LAST_UPDATE_DATE, A.CREATED_DATE, B.* FROM BUDGET  A, CONTRACT B
WHERE 
---REPORTING_MODIFIED_DATE IS NOT NULL
---AND 
A.CONTRACT_ID = B.CONTRACT_ID
AND
A.BUDGET_TYPE_ID = 1
AND A.AGENCY_ID = 'ACS'
AND A.FISCAL_YEAR_ID = 2017
AND A.STATUS_ID = 89
ORDER BY A.FISCAL_YEAR_ID DESC, A.BUDGET_ID 
---
---




----
----

SELECT a.table_name,
  c.column_name,
  b.table_name AS CHILD_TABLE,
  d.column_name,
  b.R_CONSTRAINT_NAME
FROM user_constraints a,
  user_constraints b,
  user_ind_columns c,
  user_cons_columns d
WHERE a.constraint_type = 'P'
AND a.CONSTRAINT_NAME   = b.R_CONSTRAINT_NAME
AND b.CONSTRAINT_TYPE   = 'R'
AND a.table_name        = c.table_name
AND a.constraint_name   = c.index_name
AND b.CONSTRAINT_NAME   = d.constraint_name
AND a.table_name        = 'SUB_BUDGET'
;
---
---



-----PRC2
------
7/3/2018



----
----


SELECT PAYMENT_AMOUNT, PAYMENT_ID, PAYMENT_VOUCHER_NUM, BUDGET_FISCAL_YEAR_ID, FISCAL_YEAR_ID , STATUS_ID, PROCESS_FLAG
FROM PAYMENT
WHERE PAYMENT_VOUCHER_NUM IN ( '151100437A1',
'160900029P2',
'181100605P1',
'181100607P1',
'181100614P1',
'181100615P1')
ORDER BY CREATED_DATE DESC


UPDATE PAYMENT
SET PROCESS_FLAG = 1
WHERE PAYMENT_VOUCHER_NUM IN ( '151100437A1',
'160900029P2',
'181100605P1',
'181100607P1',
'181100614P1',
'181100615P1');
commit;



----
----
Source:
-----
SELECT DISTINCT P.AGENCY_ID,
  P.VENDOR_ADDRESS_ID,
  P.BUDGET_FISCAL_YEAR_ID,
  P.PAYMENT_VOUCHER_NUM,
  0 AS DOC_UNIT_CD,
  P.FISCAL_YEAR_ID,
  P.PAYMENT_APPROVED_DATE,
  P.PERIOD,
  P.PAYEE_VENDOR_ADDRESS_ID,
  P.PAYEE_VENDOR_ID,
  PA.PAYMENT_AMOUNT,
  P.PAYMENT_SUBMITTED_DATE,
  P.ORGANIZATION_ID,
  I.INVOICE_START_DATE,
  I.INVOICE_END_DATE,
  nvl(I.INVOICE_SUBMITTED_DATE,I.CREATED_DATE) AS INVOICE_SUBMITTED_DATE,
  I.PROVIDER_INVOICE_NUMBER,
  I.INVOICE_NUMBER,
  PA.ACCOUNTING_LINE,
  NVL(PA.REPORTING_CATEGORY,'null') AS REPORTING_CATEGORY,
  PA.UNIT_OF_APPROPRIATION,
  PA.COMMODITY_LINE,
  '--' AS DOC_VEND_LN_NO,
  PA.BUDGET_CODE,
  PA.FUND_CD AS FUND,
  PA.OBJECT_CODE,
  NVL(PA.RFED_DOC_CD, 'null')     AS REF_DOC_CODE,
  PA.RFED_COMM_LN_NO              AS REF_COMMODITY_LINE,
  PA.RFED_DOC_DEPT_CD             AS REF_DOC_DEPT,
  PA.RFED_DOC_ID                  AS REF_DOC_ID,
  PA.RFED_VEND_LN_NO              AS REF_VENDOR_LINE,
  PA.RFED_ACTG_LN_NO              AS REF_ACCOUNTING_LINE,
  NVL(PA.SUB_OBJECT_CODE, 'null') AS SUB_OBJECT_CODE,
  C.CONTRACT_AMOUNT,
  C.AGENCY_ID AS CONTRACT_AGENCY_ID,
  C.EXT_DOC_VERSION,
  NVL(PA.RFED_DOC_DEPT_CD,'null') AS AGENCY_CODE,
  NVL(RV.VEND_CUST_CD, 'null') VEND_CUST_CD,
  C.EXT_COMMODITY_CODE,
  PA.PAYMENT_ALLOCATION_ID,
  P.PAYMENT_ID,
  P.BUDGET_ADVANCE_ID,
  B.BUDGET_START_DATE,
  P.PAYMENT_VOUCHER_NUM
  || TO_CHAR(TO_NUMBER(PA.COMMODITY_LINE)) AS XPK_PR_DOC_COMM,
  --ROW_NUMBER() OVER (PARTITION BY P.PAYMENT_VOUCHER_NUM ORDER BY 1) AS VEND_INV_LN_NO
  DENSE_RANK() OVER (PARTITION BY P.PAYMENT_VOUCHER_NUM ORDER BY TO_CHAR(TO_NUMBER(PA.COMMODITY_LINE))) AS VEND_INV_LN_NO,
  PA.CL_CODE,
  NVL(IV.DEPT_CD,'null') AS DEPT_CD,
  BA.BUDGET_ADVANCE_NUMBER,
  IV.LN_TYP,
  PA.PAYMENT_AMOUNT AS QTY,
  IV.UNIT_MEAS_CD,
  IV.UNIT_PRICE
FROM HHSA_APP.CONTRACT C,
  HHSA_APP.BUDGET B,
  HHSA_APP.INVOICE I,
  HHSA_APP.PAYMENT P,
  HHSA_APP.ORGANIZATION O,
  HHSA_APP.REF_VENDOR_V R,
  HHSA_APP.PAYMENT_ALLOCATION PA,
  HHSA_APP.BUDGET_ADVANCE BA,
  (SELECT TRIM(DOC_CD
    || DOC_DEPT_CD
    || DOC_ID) AS EXT_CT_NUMBER,
    DEPT_CD,
    DOC_ACTG_LN_NO,
    DOC_COMM_LN_NO,
    QTY,
    UNIT_MEAS_CD,
    UNIT_PRICE,
    LN_TYP
  FROM
    (SELECT A.DOC_CD,
      A.DOC_DEPT_CD,
      A.DOC_ID,
      A.DOC_VERS_NO,
      A.DEPT_CD,
      A.DOC_ACTG_LN_NO,
      A.DOC_COMM_LN_NO,
      RANK() OVER (PARTITION BY A.DOC_CD, A.DOC_DEPT_CD, A.DOC_ID ORDER BY A.DOC_VERS_NO DESC) AS My_Rank,
      C.QTY,
      C.UNIT_MEAS_CD,
      C.UNIT_PRICE,
      C.LN_TYP
    FROM REF_CONTRACTS_A A
    JOIN REF_CONTRACTS_C C
    ON TRIM(A.DOC_CD)          = TRIM(c.DOC_CD)
    AND TRIM(A.DOC_DEPT_CD)    =TRIM(C.DOC_DEPT_CD)
    AND TRIM(A.DOC_ID)         =TRIM(C.DOC_ID)
    AND TRIM(A.DOC_COMM_LN_NO) = TRIM(C.DOC_COMM_LN_NO)
    AND TRIM(A.DOC_VERS_NO)    =TRIM(C.DOC_VERS_NO)
    )
  WHERE My_Rank = 1
  ) IV,
 HHSA_APP.REF_CONTRACTS_V RV
WHERE C.CONTRACT_ID     = B.CONTRACT_ID
AND C.CONTRACT_ID       = P.CONTRACT_ID
AND P.CONTRACT_ID       = I.CONTRACT_ID (+)
AND P.BUDGET_ID         = B.BUDGET_ID
AND P.INVOICE_ID        = I.INVOICE_ID(+)
AND P.ORGANIZATION_ID   = O.ORGANIZATION_ID(+)
AND P.PAYMENT_ID        = PA.PAYMENT_ID
AND O.EIN_ID_NN         = R.TIN(+)
AND P.BUDGET_ADVANCE_ID = BA.BUDGET_ADVANCE_ID(+)
AND PA.RFED_DOC_CD
  || PA.RFED_DOC_DEPT_CD
  || PA. RFED_DOC_ID      = IV.EXT_CT_NUMBER(+)
AND PA.ACCOUNTING_LINE    = IV.DOC_ACTG_LN_NO(+)
AND PA.COMMODITY_LINE     = IV.DOC_COMM_LN_NO(+)
--AND R.VEND_CUST_CD        = RT.VEND_CUST_CD
--AND RT.PRVNT_NEW_SPND_IND = 0
AND P.PROCESS_FLAG        = '1'
AND SYSTIMESTAMP         >= B.BUDGET_START_DATE
AND PA.PAYMENT_AMOUNT     > 0
AND P.DELETE_FLAG         = '0'
AND P.STATUS_ID          IN
  (SELECT STATUS_ID
  FROM HHSA_APP.STATUS_MASTER_R2_R3
  WHERE PROCESS_TYPE = 'Payment'
  AND STATUS         = 'Approved'
  )
AND RV.DOC_CD=PA.RFED_DOC_CD
AND RV.DOC_DEPT_CD=PA.RFED_DOC_DEPT_CD
AND RV.DOC_ID=PA.RFED_DOC_ID--





----
----

7/6/2018
-----
hra inv 


SELECT * FROM HHSA_APP.STG_INVOICE_DETAILS;

SELECT * FROM  HHSA_APP.INVOICE_DETAILS A
WHERE A.SUB_BUDGET_ID IN ('41177', '41172', '41203', '84241');

SELECT * FROM HHSA_APP.PAYMENT_ALLOCATION
ORDER BY CREATED_DATE DESC;

SELECT * FROM HHSA_APP.PAYMENT
WHERE INVOICE_ID in (102906, 102905,102907)
ORDER BY CREATED_DATE DESC;

SELECT * FROM  HHSA_APP.INVOICE
where AGENCY_ID='HRA' and MODIFIED_BY_USERID like '%ETL%'
order by AGENCY_ID desc;

SELECT * FROM HHSA_APP.REF_CONTRACTS_H
where DOC_ID in ('20171420930',
'20181414748',
'20171421092')
order by DOC_ID, DOC_VERS_NO desc
;




---
---


----
----
Users & members:
----


SELECT * FROM STAFF_DETAILS 
WHERE EMAIL = 'jhhhstesttstb@mailinator.com';

SELECT A.USER_STATUS, A.ACTIVE_FLAG, A.ADMIN_PERMISSION, A.IS_BASE_ORGANIZATION, A.MEMBER_STATUS FROM STAFF_ORGANIZATION A
WHERE A.STAFF_ID = '4421';

---
---

Subject: RE: Payment Issue

Hi Priyanka,

Thank you on the analysis for the rejected payments.  To help with future analysis of similar issues, the list of payments is available in the Payment screen of Accelerator; filter for Payments with status of Pending FMS Action.  You can also use this query to pull back the list of Payments rejected by FMS directly from the database.
select * from payment p
where p.STATUS_ID in (
  select sm.STATUS_ID from STATUS_MASTER_R2_R3 sm
  where sm.status ='Pending FMS Action'
  )
;


---
---
INVOICE INBOUND

CHECK daily HRA inter




SELECT INVOICE_NUMBER,INVOICE_AMOUNT_TOTAL , CREATED_DATE FROM HHSA_APP.INVOICE
WHERE AGENCY_ID = 'HRA'
AND MODIFIED_BY_USERID = 'Interface_ETL'
ORDER BY CREATED_DATE DESC;

SELECT PAYMENT_ID, PAYMENT_AMOUNT, PAYMENT_VOUCHER_NUM, PAYMENT_SUBMITTED_DATE, STATUS_ID FROM HHSA_APP.PAYMENT
WHERE AGENCY_ID = 'HRA'
AND INVOICE_ID IN  ( SELECT INVOICE_ID FROM HHSA_APP.INVOICE
WHERE AGENCY_ID = 'HRA'
AND MODIFIED_BY_USERID = 'Interface_ETL' ) 
ORDER BY CREATED_DATE DESC;


SELECT * FROM HHSA_APP.STATUS_MASTER_R2_R3;

109	Payment	1	Pending FMS Action
63	Payment	2	Pending Approval
64	Payment	3	Approved
65	Payment	4	Disbursed
66	Payment	7	Suspended
159	Payment	8	Rejected



---2nd version
---
SELECT A.DISBURSEMENT_DATE, A.CHECK_EFT_NUM, A.PAYMENT_ID, A.PAYMENT_AMOUNT, A.PAYMENT_VOUCHER_NUM, A.PAYMENT_SUBMITTED_DATE, A.STATUS_ID, A.REPORTING_MODIFIED_DATE, A.* FROM HHSA_APP.PAYMENT A
WHERE A.AGENCY_ID = 'HRA'
AND A.INVOICE_ID IN  ( SELECT INVOICE_ID FROM HHSA_APP.INVOICE
WHERE AGENCY_ID = 'HRA'
AND MODIFIED_BY_USERID = 'Interface_ETL' ) 
ORDER BY CREATED_DATE DESC;

---
--- HRA invoice & payment check 3 payment_amount zero issue

SELECT A.INVOICE_NUMBER, A.INVOICE_AMOUNT_TOTAL , B.PAYMENT_VOUCHER_NUM, B.PAYMENT_AMOUNT, A.IS_ETL_RECORD, A.CREATED_DATE  FROM HHSA_APP.INVOICE A, HHSA_APP.PAYMENT  B
WHERE A.INVOICE_ID = B.INVOICE_ID
AND A.AGENCY_ID = 'HRA'
AND B.AGENCY_ID = 'HRA'
AND A.MODIFIED_BY_USERID = 'Interface_ETL'
AND (A.CREATED_DATE BETWEEN '17-JUL-18 08.40.28.000000000 AM'  AND '17-JUL-18 08.40.28.000000000 AM');


----
---

---
CONTRACT -> BUDGET 


SELECT * FROM HHSA_APP.CONTRACT
WHERE EXT_CT_NUMBER ='CT126020190002206';    CONTRACT_AMOUNT   --- contract;

SELECT FISCAL_YEAR_ID, FISCAL_YEAR_AMOUNT, BUDGET_ID, BUDGET_START_DATE, BUDGET_END_DATE  FROM HHSA_APP.BUDGET
WHERE CT_NUMBER = 'CT126020190002206';  --FISCAL_YEAR_AMOUNT;

SELECT SUB_BUDGET_ID, SUB_BUDGET_NAME, SUB_BUDGET_AMOUNT  FROM HHSA_APP.SUB_BUDGET
WHERE BUDGET_ID IN (SELECT BUDGET_ID FROM HHSA_APP.BUDGET WHERE CT_NUMBER = 'CT126020190002206');  ---sub_BUDGET_NAME SUB_BUDGET_AMOUNT ;

SELECT PERSONNEL_SERVICE_ID, PERSONNEL_SERVICE_TYPE_ID, POSITION_ID, SUB_BUDGET_ID, TOTAL_SALARY FROM HHSA_APP.PERSONNEL_SERVICE
WHERE SUB_BUDGET_ID IN (   SELECT SUB_BUDGET_ID FROM HHSA_APP.SUB_BUDGET
WHERE BUDGET_ID IN (SELECT BUDGET_ID FROM HHSA_APP.BUDGET WHERE CT_NUMBER = 'CT126020190002206') );  

SELECT * FROM HHSA_APP.INDIRECT_RATE
WHERE SUB_BUDGET_ID IN (   SELECT SUB_BUDGET_ID FROM HHSA_APP.SUB_BUDGET
WHERE BUDGET_ID IN (SELECT BUDGET_ID FROM HHSA_APP.BUDGET WHERE CT_NUMBER = 'CT126020190002206') );



----

----
QC6459:

SELECT A.STAFF_ID,A.MEMBER_STATUS, A.USER_STATUS, B.* FROM STAFF_ORGANIZATION A, STAFF_DETAILS  B
WHERE A.ORGANIZATION_ID = 'Org_303'
AND A.STAFF_ID = B.STAFF_ID 
AND A.STAFF_ID IN (SELECT A.CREATED_BY FROM ORGANIZATION A 
WHERE A.ORGANIZATION_LEGAL_NAME LIKE 'R4 Test Five Provider%')   -----  STAFF_ID = 329 is not a primary user of the organization;
ORDER BY B.REPORTING_MODIFIED_DATE DESC;

---
---
HRA 7_19_2018
-issue with the invoice thru the etl
-remaining amount in application
-milestone table.

SELECT YTD_INVOICED_AMOUNT, REMAINING_AMOUNT FROM MILESTONE        -- draft: does not change the remaining amount  --Pending approval: reduced the remaining amount--- returned for revision: puts back the remaining amount
WHERE SUB_BUDGET_ID = 125613;   

----
----
----
DFTA COst center budget update:

UPDATE BUDGET
SET REPORTING_MODIFIED_DATE = sysdate
WHERE BUDGET_ID = 9564;
commit;

----
UPDATE COST_CENTER_DETAILS
SET REPORTING_MODIFIED_DATE = sysdate
WHERE BUDGET_ID = 9564;
COMMIT;

-----

SELECT * FROM HHSA_APP.COST_CENTER_DETAILS
WHERE BUDGET_ID = 9564;
----
----



bad 
---
two differne org id  has the same ein in the organization table.

select o.ORGANIZATION_ID , o.EIN_ID_NN, v.TIN, v.VEND_CUST_CD, apt.AWARDED_VENDOR_NAME, apt.PROCUREMENT_AWARD_EPIN
from hhsa_app.ORGANIZATION o , hhsa_app.REF_VENDOR_V v, REF_APT_EPIN_MASTER apt
where o.EIN_ID_NN=v.TIN and v.VEND_CUST_CD='VD001302023'
and apt.VENDOR_FMS_ID = v.VEND_CUST_CD;  --- try this to figure out

---
issue:9137 & 9138:
---select o.ORGANIZATION_ID from hhsa_app.ORGANIZATION o , hhsa_app.REF_VENDOR_V v where o.EIN_ID_NN=v.TIN and v.VEND_CUST_CD='VD001302023'

---Org_4981  is good.
--Org_501 is bad -- change
-----


Issue:
-----
SELECT o2.ORGANIZATION_ID, o2.EIN_ID_NN, v2.VEND_CUST_CD
from hhsa_app.ORGANIZATION o2, hhsa_app.REF_VENDOR_V v2 where o2.EIN_ID_NN=v2.TIN
AND o2.EIN_ID_NN IN
(select o.EIN_ID_NN
from hhsa_app.ORGANIZATION o 
GROUP BY o.EIN_ID_NN
HAVING COUNT(o.EIN_ID_NN) > 1)
order by o2.EIN_ID_NN;
---and v.VEND_CUST_CD='VD001302023';

---QC9015: wf_Agency_contract_inbound interface errors out when the VEND_CUST_CD and EIN_ID_NN is assigned to two different organization_ids in 
---the application.
---
--- 	Summary	 	Multiple EIN in Organization Stopping Inflight Contracts - One EIN is Active and Other is Not Active
 --- 
 ---	Description	 
 --- When we have one organization whose organization request was rejected earlier and later in the stage 
  ---2nd request got approved. It results multiple entries in HHSA_APP.ORGANIZATION table with Ative flag 
 --- False for Reject and True for Approved with the same EIN. If there is a need to inflight the contract 
 --- the Epin uses the vendor cust code which is in the REF_VENDFOR_V table and REF_VENDOR_V table would 
 ---- have the TIN number which is the EIN number in ORGANIZATION table. When you try to inflight the contract, 
 --- after entering the EPIN, system displays the error read "This request could not be completed please try again 
 ---- or later". Temp: resolutionIf we update the EIN number in the Organization Table with xxEIN#xxx then it will 
 ---- let the Accelerator user to inflight the contract. Permanent solution:we think that system is not considering 
 --- the Active flag in organization table that's why it is getting the multiple records in return and not letting
 --- Accelerator user to inflight the contract. Please see the Attachment 





----for DFTA
SELECT A.SUB_BUDGET_ID, A.SUB_BUDGET_NAME, A.SUB_BUDGET_AMOUNT, D.BUDGET_TYPE,  C.STATUS, B.CONTRACT_ID , E.CONTRACT_TITLE, E.EXT_CT_NUMBER, E.CONTRACT_TYPE_ID, F.CONTRACT_TYPE,  B.* 
FROM SUB_BUDGET A, BUDGET B, STATUS_MASTER_R2_R3 C, BUDGET_TYPE D, CONTRACT E, CONTRACT_TYPE F
WHERE 
A.BUDGET_ID = B.BUDGET_ID
AND A.PARENT_ID = 125121
AND B.STATUS_ID = C.STATUS_ID 
AND B.BUDGET_TYPE_ID = D.BUDGET_TYPE_ID
AND B.CONTRACT_ID = E.CONTRACT_ID
AND E.CONTRACT_TYPE_ID = F.CONTRACT_TYPE_ID
;


SELECT * FROM STATUS_MASTER_R2_R3 C;
SELECT * FROM BUDGET_TYPE D;
SELECT * FROM CONTRACT_TYPE F;
SELECT * FROM CONTRACT E;
----

____
QC6437:
----

  SELECT A.ORGANIZATION_ID, 
 A.ORGANIZATION_STATUS, 
 A.ORGANIZATION_LEGAL_NAME,
 A.EIN_ID_NN,
 A.CORPORATE_STRUCTURE_ID,
 A.SUBMISSION_DATE,
 A.ORGANIZATION_START_DATE,
 A.ORGANIZATION_ACTIVE_FLAG, 
 A.PROC_STATUS , 
 B.BUSINESS_APPLICATION_ID, 
 B.APPLICATION_ID, 
 B.APPLICATION_STATUS,
 B.EXPIRATION_DATE,
 B.CITY_STATUS_SET_DATE,
 B.ORGANIZATION_ID,
 B.STATUS_ID,
 B.SUBMISSION_DATE,
 A.*,
 B.*
 FROM ORGANIZATION A, BUSINESS_APPLICATION B
 WHERE A.ORGANIZATION_ID = B.ORGANIZATION_ID(+)
 AND  A.ORGANIZATION_LEGAL_NAME = 'YMCA of Greater New York'
 ;
 
 -----;
 
SELECT 
 A.ORGANIZATION_ID, 
 A.ORGANIZATION_STATUS, 
 A.ORGANIZATION_LEGAL_NAME,
 A.EIN_ID_NN,
 A.CORPORATE_STRUCTURE_ID,
 A.SUBMISSION_DATE,
 A.ORGANIZATION_START_DATE,
 A.ORGANIZATION_ACTIVE_FLAG, 
 A.PROC_STATUS , A.*
 FROM ORGANIZATION A 
 WHERE A.ORGANIZATION_ID NOT IN (SELECT B.ORGANIZATION_ID FROM HHSA_APP.BUSINESS_APPLICATION B);
 
 ----;
 
 SELECT 
 A.ORGANIZATION_ID, 
 A.ORGANIZATION_STATUS, 
 A.ORGANIZATION_LEGAL_NAME,
 A.EIN_ID_NN,
 A.CORPORATE_STRUCTURE_ID,
 A.SUBMISSION_DATE,
 A.ORGANIZATION_START_DATE,
 A.ORGANIZATION_ACTIVE_FLAG, 
 A.PROC_STATUS , A.*
 FROM ORGANIZATION A 
 WHERE A.ORGANIZATION_ID IN (SELECT B.ORGANIZATION_ID FROM HHSA_APP.BUSINESS_APPLICATION B);
 
 ----;

------
QC  this will give the XML_DOC_ID for the Contracts_amended
6476
---
SELECT DISTINCT C.EXT_CT_NUMBER, A.XML_DOC_ID
FROM HHSA_APP.BUDGET A, HHSA_APP.BUDGET_TYPE B, HHSA_APP.CONTRACT C, HHSA_APP.BUDGET_ADVANCE BA
WHERE 
A.BUDGET_TYPE_ID = B.BUDGET_TYPE_ID
AND A.BUDGET_ID= BA.BUDGET_ID(+)
AND A.CT_NUMBER = C.EXT_CT_NUMBER
AND C.CONTRACT_TYPE_ID NOT IN (1,6)
AND XML_DOC_ID IS NOT NULL
ORDER BY C.EXT_CT_NUMBER ASC;


SELECT DISTINCT C.AGENCY_ID, C.EXT_CT_NUMBER , A.XML_DOC_ID
FROM HHSA_APP.BUDGET A, HHSA_APP.BUDGET_TYPE B, HHSA_APP.CONTRACT C, HHSA_APP.BUDGET_ADVANCE BA
WHERE 
A.BUDGET_TYPE_ID = B.BUDGET_TYPE_ID
AND A.BUDGET_ID= BA.BUDGET_ID(+)
AND A.CT_NUMBER = C.EXT_CT_NUMBER
AND C.CONTRACT_TYPE_ID NOT IN (1,6)
AND XML_DOC_ID IS NOT NULL
ORDER BY C.EXT_CT_NUMBER ASC;

-----

-----
6491
-----
select distinct a.AGENCY_ID, c.REVIEW_PROCESS, d.FIRST_NAME || ' ' || d.LAST_NAME as User_Name, d.USER_ROLE, d.EMAIL_ID, b.LEVEL_ID, d.ACTIVE_FLAG
from HHSA_APP.AGENCY_SETTING a
inner join HHSA_APP.AGENCY_SETTING_LEVEL_USERS b on a.AGENCY_SETTING_ID = b.AGENCY_SETTING_ID
inner join  HHSA_APP.REVIEW_PROCESS c on a.REVIEW_PROCESS_ID = c.REVIEW_PROCESS_ID
inner join  HHSA_APP.CITY_USER_DETAILS d on d.USER_ID = b.level_reviewer_id
where agency_id = 'ACS'
--and c.REVIEW_PROCESS in ('Contract Budget Review', 'Contract Budget Modification Review', 'Contract Budget Amendment Review', 'Invoice Review' )
and d.ACTIVE_FLAG = 1
order by c.REVIEW_PROCESS, b.LEVEL_ID, user_role;

---
6437
---
Welcome:Provider Test;
Provider enhancement;
providertestenh@mailinator.com  Help@123;

-----
-----















---fms contract inbound process
INSERT INTO STG_CONTRACTS_H(LINE_REC,DOC_CD,DOC_DEPT_CD,DOC_ID,DOC_VERS_NO,DOC_NM,DOC_REC_DT_DC,DOC_BFY,DOC_FY_DC,DOC_PER_DC,DOC_DSCR,DOC_ACTU_AM,DOC_CLSD_AM,DOC_CLSD_DT,OPEN_AM,MAX_CNTRC_AM,OPEN_ACRL_AM,AMEND_NO,CNTRC_STA,PCARD_REC_ID,PCARD_EXPR_DT,PRCU_ID,PRCU_TYP_NM,PRCU_TYP_ID,CNTRCT_STRT_DT,CNTRCT_END_DT,HEAR_DT,PSR_REQ_DT,PROC_INI_DT,CITED_AUTH,ACTG_PRFL_ID,TC_TMPL,CNFRM_ORD,PRNT_JOB_CD,CLSD_AM,LAST_PRN_DT,OBJ_ATT_SG_TOT,OBJ_ATT_PG_TOT,PC_CHNG_MAX_AM,WF_PC_CHNG_MAX_AM,WF_TOT_MAX_AM,ORIG_MAX_AM,ENC_AM,OUT_AM,RFED_AM,RFED_LQD_AM,OCA_NO,ORIG_CNTRC_STRT_DT,ORIG_CNTRC_END_DT,REG_DT,OBLG_ADJ_OUTYR_AM,AVAIL_OBLG_AM,OUTYR_ADJ_AM,PART_RECT_ALW_FL,AGREE_DOC_CD,AGREE_DOC_DEPT_CD,AGREE_DOC_ID,AGREE_VEND_LN_NO,BRD_AWD_NO,BRD_AWD_DT,TRKG_NO,PO_REPL_DOC_CD,PO_REPL_DEPT_CD,PO_REPL_ID,PO_REPL_BY_DOC_CD,PO_REPL_BY_DEPT_CD,PO_REPL_BY_ID,ISSR_ID,ISSR_NM,ISSR_PH_NO,ISSR_EMAIL_AD,RQSTR_ID,RQSTR_NM,RQSTR_PH_NO,RQSTR_PH_EXT,RQSTR_EMAIL_AD,RQSTR_DEPT_CD,TEAM_ID,BUYR_ID,BUYR_NM,BUYR_PH_NO,BUYR_PH_EXT,BUYR_EMAIL_AD,CNTRCT_OFCR,CNTRCT_OFCR_PH,OFCR_PH_EXT,CNTRCT_OFCR_EML,TRACK_CHGS,CHG_ORD_NO,MOD_FL,REAS_MOD_DC,CMR_DOC_CD,CMR_DOC_DEPT_CD,CMR_DOC_ID,DSCR_EXT,SHIP_LOC_CD,SHIP_METH_CD,FREE_BRD_CD,DLVR_DT,DLVR_TYP,SHIP_INFO,BILL_LOC_CD,BILL_INFO,GNRC_PO_RPT_1,GNRC_PO_RPT_2,GNRC_PO_RPT_3,DOC_CREA_USID,DOC_APPL_CREA_DT,DOC_APPL_LAST_USID,DOC_APPL_LAST_DT,RL_FL_1,DOC_FUNC_CD,CREATED,CREATED_BY,LOAD_DATE)  VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) 
INSERT INTO STG_CONTRACTS_W(LINE_REC,DOC_CD,DOC_DEPT_CD,DOC_ID,DOC_VERS_NO,AWD_METH_CD,AWD_LVL_CD,CTTYP_CD,CTCLS_CD,CLSD_TYP_CD,CTCAT_CD_1,MULTI_CAT_FL,CTCAT_CD_2,CTCAT_CD_3,CTCAT_CD_4,CTCAT_CD_5,RESP_CT,OUT_OF_NO_SO,LOC_SERV,LOC_ZIP,BRGH_CD,BLCK_CD,LOT_CD,COUN_DIST_CD,RNEW_CD,CNTRC_MWBE_FL,TAR_UTL_PC,TAR_UTL_AM,COMP_CRT_CD_1,COMP_CRI_RESP_1,COMP_CRT_CD_2,COMP_CRI_RESP_2,COMP_CRT_CD_3,COMP_CRI_RESP_3,COMP_CRT_CD_4,COMP_CRI_RESP_4,COMP_CRT_CD_5,COMP_CRI_RESP_5,NON_COMP_REAS,CONS_REAS_CD_1,CONS_REAS_CD_2,RED_ADV,CONSTR_REL_FL,EXTRN_SO_NO,LIQ_DMG_CHRG,REQ_PRF_PAY_BND_FL,RES_NO_PER_BND,CNT_REQ_INS_POL_FL,WK_SITE_CD_01,WK_SITE_CD_02,WK_SITE_CD_03,WK_SITE_CD_04,WK_SITE_CD_05,WK_SITE_CD_06,WK_SITE_CD_07,WK_SITE_CD_08,WK_SITE_CD_09,WK_SITE_CD_10,PERCENT_01,PERCENT_02,PERCENT_03,PERCENT_04,PERCENT_05,PERCENT_06,PERCENT_07,PERCENT_08,PERCENT_09,PERCENT_10,CREATED,CREATED_BY,LOAD_DATE)  VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) 
INSERT INTO STG_CONTRACTS_V(LINE_REC,DOC_CD,DOC_DEPT_CD,DOC_ID,DOC_VERS_NO,DOC_VEND_LN_NO,VEND_CUST_CD,AD_ID,AD_LN_1,AD_LN_2,CITY,ST,ZIP,CTRY,WEB_AD,CNTAC_ID,VEND_PREF_LVL,VEND_CUST_ALIAS_NM,LGL_NM,PRIN_CNTAC,VOICE_PH_NO,VOICE_PH_EXT,EMAIL_AD,VEND_REAS,TIN_EIN,TIN_SSN,MOD_FL,DISC_1_DY,DISC_2_DY,DISC_3_DY,DISC_4_DY,DISC_1_PC,DISC_2_PC,DISC_3_PC,DISC_4_PC,DISC_ALW_1_FL,DISC_ALW_2_FL,DISC_ALW_3_FL,DISC_ALW_4_FL,CREATED,CREATED_BY,LOAD_DATE)  VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) 
INSERT INTO STG_CONTRACTS_R(LINE_REC,DOC_CD,DOC_DEPT_CD,DOC_ID,DOC_VERS_NO,DOC_RNEWPER_LN_NO,RNEW_PER_LEN,RNEW_PER_UNIT,RNEW_NOTIF_DY,CNTRCT_STRT_DT,CNTRCT_END_DT,CREATED,CREATED_BY,LOAD_DATE)  VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) 

Message: Lookup Transformation [LKP_CONTRACT]: Lookup override sql to create cache: 
SELECT HHSA_APP.CONTRACT.CONTRACT_TITLE AS TITLE,
HHSA_APP.CONTRACT.CREATED_DATE AS CREATED,
HHSA_APP.CONTRACT.CONTRACT_AMOUNT AS CONTRACT_AMOUNT,  
TRUNC(HHSA_APP.CONTRACT.CONTRACT_START_DATE) AS CONTRACT_START_DATE,  
TRUNC(HHSA_APP.CONTRACT.CONTRACT_END_DATE) AS CONTRACT_END_DATE,  
HHSA_APP.CONTRACT.CONTRACT_ID AS CONTRACT_ID,  HHSA_APP.CONTRACT.ORGANIZATION_ID AS ORGANIZATION_ID,  
HHSA_APP.CONTRACT.EXT_EPIN AS EXT_EPIN,  HHSA_APP.CONTRACT.AGENCY_ID AS AGENCY_ID 
FROM HHSA_APP.CONTRACT
WHERE HHSA_APP.CONTRACT.CONTRACT_TYPE_ID IN (1,3) 
AND HHSA_APP.CONTRACT.STATUS_ID  IN (SELECT STATUS_ID FROM HHSA_APP.STATUS_MASTER_R2_R3 WHERE PROCESS_TYPE = 'Contract' 
AND STATUS = 'Pending Registration');-- ORDER BY EXT_EPIN,AGENCY_ID,CONTRACT_AMOUNT,CONTRACT_START_DATE,CONTRACT_END_DATE,CONTRACT_ID,ORGANIZATION_ID;

Message: Lookup Transformation [LKP_AGENCY]: Lookup override sql to create cache: 
SELECT  
HHSA_APP.NYC_AGENCY_DETAILS.AGENCY_ID AS AGENCY_ID,  
HHSA_APP.NYC_AGENCY_DETAILS.AGENCY_CODE AS AGENCY_CODE 
FROM HHSA_APP.NYC_AGENCY_DETAILS WHERE ACTIVE_FLAG=1-- ORDER BY AGENCY_CODE,AGENCY_ID


Message: Lookup Transformation [lkp_ref_apt_epin_master]: Lookup override sql to create cache: 
SELECT  distinct  REF_APT_EPIN_MASTER.VENDOR_FMS_ID AS VENDOR_FMS_ID,  
REF_APT_EPIN_MASTER.PROCUREMENT_AWARD_EPIN AS PROCUREMENT_AWARD_EPIN 
FROM HHSA_APP.REF_APT_EPIN_MASTER REF_APT_EPIN_MASTER 
ORDER BY PROCUREMENT_AWARD_EPIN,VENDOR_FMS_ID

Message: Lookup Transformation [lkp_ref_vendor_v]: Lookup override sql to create cache: 
SELECT  distinct  REF_VENDOR_V.TIN AS TIN,  REF_VENDOR_V.VEND_CUST_CD AS VEND_CUST_CD 
FROM HHSA_APP.REF_VENDOR_V REF_VENDOR_V ORDER BY VEND_CUST_CD,TIN

Message: Lookup Transformation [lkp_organization]: Lookup override sql to create cache: 
SELECT  distinct  ORGANIZATION.EIN_ID_NN AS EIN_ID_NN,  ORGANIZATION.ORGANIZATION_ID AS ORGANIZATION_ID 
FROM HHSA_APP.ORGANIZATION ORGANIZATION ORDER BY ORGANIZATION_ID,EIN_ID_NN

Message: Target Table CONTRACT :SQL UPDATE override statement:
UPDATE CONTRACT SET EXT_CT_NUMBER = ?, EXT_EPIN = ?, STATUS_ID = ?, UPDATE_FLAG = ?, MODIFIED_DATE = ? WHERE CONTRACT_ID = ?

Message: Target Table CONTRACT :SQL UPDATE override statement:
UPDATE CONTRACT SET EXT_CT_NUMBER = ?, EXT_EPIN = ?, STATUS_ID = ?, UPDATE_FLAG = ?, DISCREPANCY_FLAG = ?, MODIFIED_DATE = ?, FMS_CONTRACT_AMOUNT = ?, FMS_CONTRACT_START_DATE = ?, FMS_CONTRACT_END_DATE = ? WHERE CONTRACT_ID = ?


Message: SQ Instance [SQ_STG_CONTRACTS_H] User specified SQL Query [

WITH UNIQ AS (SELECT 
     S.DOC_CD || S.DOC_DEPT_CD || S.DOC_ID AS EXT_CT_NUMBER,
     S.DOC_ID, 
     S.DOC_VERS_NO,
     ROW_NUMBER() OVER (PARTITION BY S.DOC_CD || S.DOC_DEPT_CD || S.DOC_ID ORDER BY S.DOC_VERS_NO DESC) AS MAX
     FROM HHSA_APP.STG_CONTRACTS_H S)
SELECT
STG_CONTRACTS_H.DOC_DEPT_CD,
 STG_CONTRACTS_H.DOC_CD || STG_CONTRACTS_H.DOC_DEPT_CD || STG_CONTRACTS_H.DOC_ID,
 STG_CONTRACTS_H.MAX_CNTRC_AM,
 TRUNC(STG_CONTRACTS_H.CNTRCT_STRT_DT) AS CNTRCT_STRT_DT,
 TRUNC(STG_CONTRACTS_H.CNTRCT_END_DT) AS CNTRCT_END_DT,
 STG_CONTRACTS_H.TRKG_NO
FROM
 HHSA_APP.STG_CONTRACTS_H,
 UNIQ U
WHERE 
     --(LENGTH(TRKG_NO) = 13 or LENGTH(TRKG_NO) = 17) AND 
 STG_CONTRACTS_H.DOC_CD || STG_CONTRACTS_H.DOC_DEPT_CD || STG_CONTRACTS_H.DOC_ID = U.EXT_CT_NUMBER
 AND STG_CONTRACTS_H.DOC_VERS_NO = U.DOC_VERS_NO
 AND U.MAX = 1
 ---]
 
 
 
 Message: SQ Instance [SQ_STG_CONTRACTS_A] User specified SQL Query [
 
 WITH UNIQ AS (SELECT 
     S.DOC_CD || S.DOC_DEPT_CD || S.DOC_ID AS EXT_CT_NUMBER,
     DOC_VERS_NO,
     ROW_NUMBER() OVER (PARTITION BY S.DOC_CD || S.DOC_DEPT_CD || S.DOC_ID ORDER BY DOC_VERS_NO DESC) AS MAX
     FROM HHSA_APP.STG_CONTRACTS_A S)  
SELECT 
 STG_CONTRACTS_A.LN_OPEN_AM,
 PAYMENT_ALLOCATION.PAYMENT_ID,
 PAYMENT_ALLOCATION.PAYMENT_ALLOCATION_ID
FROM 
 STG_CONTRACTS_A,
 CONTRACT, 
 PAYMENT,
 PAYMENT_ALLOCATION,
 STATUS_MASTER_R2_R3,
 UNIQ U
WHERE  
    STG_CONTRACTS_A.DOC_CD || STG_CONTRACTS_A.DOC_DEPT_CD || STG_CONTRACTS_A.DOC_ID = CONTRACT.EXT_CT_NUMBER 
AND STG_CONTRACTS_A.DOC_CD || STG_CONTRACTS_A.DOC_DEPT_CD || STG_CONTRACTS_A.DOC_ID = U.EXT_CT_NUMBER
AND STG_CONTRACTS_A.DOC_VERS_NO = U.DOC_VERS_NO
AND U.MAX = 1    
AND CONTRACT.CONTRACT_ID = PAYMENT.CONTRACT_ID
AND PAYMENT.PAYMENT_ID = PAYMENT_ALLOCATION.PAYMENT_ID
AND PAYMENT.STATUS_ID = STATUS_MASTER_R2_R3.STATUS_ID AND STATUS_MASTER_R2_R3.PROCESS_TYPE = 'Payment' 
AND ( STATUS_MASTER_R2_R3.STATUS = 'Pending Approval' OR (STATUS_MASTER_R2_R3.STATUS = 'Approved' AND  PAYMENT.PROCESS_FLAG = '1'))
AND PAYMENT_ALLOCATION.COMMODITY_LINE = STG_CONTRACTS_A.DOC_COMM_LN_NO
AND PAYMENT_ALLOCATION.ACCOUNTING_LINE = STG_CONTRACTS_A.DOC_ACTG_LN_NO
AND PAYMENT_ALLOCATION.UNIT_OF_APPROPRIATION = STG_CONTRACTS_A.APPR_CD 
AND PAYMENT_ALLOCATION.BUDGET_CODE = STG_CONTRACTS_A.FUNC_CD
AND PAYMENT_ALLOCATION.OBJECT_CODE  =  STG_CONTRACTS_A.OBJ_CD
AND PAYMENT_ALLOCATION.SUB_OBJECT_CODE	= STG_CONTRACTS_A.SOBJ_CD
-- AND PAYMENT_ALLOCATION.REPORTING_CATEGORY = STG_CONTRACTS_A.ACTV_CD]


Message: Lookup Transformation [LKP_CONTRACT_AMND]: Lookup override sql to create cache: 
SELECT  HHSA_APP.CONTRACT.PARENT_CONTRACT_ID AS PARENT_CONTRACT_ID,  HHSA_APP.CONTRACT.CONTRACT_AMOUNT AS CONTRACT_AMOUNT,  TRUNC(HHSA_APP.CONTRACT.PROPOSED_CONTRACT_END_DATE)  AS AMENDED_CONTRACT_END_DATE,  HHSA_APP.CONTRACT_TYPE.CONTRACT_TYPE AS CONTRACT_TYPE,  HHSA_APP.CONTRACT.CONTRACT_ID AS CONTRACT_ID,  HHSA_APP.CONTRACT.ORGANIZATION_ID AS ORGANIZATION_ID,  HHSA_APP.CONTRACT.EXT_EPIN AS EXT_EPIN,  HHSA_APP.CONTRACT.AGENCY_ID AS AGENCY_ID FROM HHSA_APP.CONTRACT, 
 HHSA_APP.CONTRACT_TYPE  
WHERE HHSA_APP.CONTRACT.CONTRACT_TYPE_ID = HHSA_APP.CONTRACT_TYPE.CONTRACT_TYPE_ID
AND HHSA_APP.CONTRACT.STATUS_ID  IN (SELECT STATUS_ID FROM HHSA_APP.STATUS_MASTER_R2_R3 WHERE PROCESS_TYPE = 'Contract' AND STATUS in ('Pending Registration','Sent for Registration')) 
AND HHSA_APP.CONTRACT_TYPE.CONTRACT_TYPE IN ('Amendment') ORDER BY EXT_EPIN,AGENCY_ID,PARENT_CONTRACT_ID,CONTRACT_AMOUNT,AMENDED_CONTRACT_END_DATE,CONTRACT_TYPE,CONTRACT_ID,ORGANIZATION_ID

Message: Lookup Transformation [LKP_AGENCY]: Lookup override sql to create cache: 
SELECT  HHSA_APP.NYC_AGENCY_DETAILS.AGENCY_ID AS AGENCY_ID,  HHSA_APP.NYC_AGENCY_DETAILS.AGENCY_CODE AS AGENCY_CODE FROM HHSA_APP.NYC_AGENCY_DETAILS WHERE ACTIVE_FLAG=1-- ORDER BY AGENCY_CODE,AGENCY_ID

Message: Lookup Transformation [lkp_ref_apt_epin_master]: Lookup override sql to create cache: 
SELECT  distinct  REF_APT_EPIN_MASTER.VENDOR_FMS_ID AS VENDOR_FMS_ID,  REF_APT_EPIN_MASTER.PROCUREMENT_AWARD_EPIN AS PROCUREMENT_AWARD_EPIN FROM HHSA_APP.REF_APT_EPIN_MASTER REF_APT_EPIN_MASTER ORDER BY PROCUREMENT_AWARD_EPIN,VENDOR_FMS_ID

Message: Lookup Transformation [lkp_organization]: Lookup override sql to create cache: 
SELECT  distinct  ORGANIZATION.EIN_ID_NN AS EIN_ID_NN,  ORGANIZATION.ORGANIZATION_ID AS ORGANIZATION_ID 
FROM HHSA_APP.ORGANIZATION ORGANIZATION ORDER BY ORGANIZATION_ID,EIN_ID_NN

Message: Lookup Transformation [LKP_CONTRACT_BASE]: Lookup override sql to create cache: 
SELECT  HHSA_APP.CONTRACT.EXT_EPIN AS EXT_EPIN,  HHSA_APP.CONTRACT.CONTRACT_AMOUNT AS CONTRACT_AMOUNT,  HHSA_APP.CONTRACT.CONTRACT_ID AS CONTRACT_ID FROM HHSA_APP.CONTRACT, 
 HHSA_APP.CONTRACT_TYPE  
WHERE HHSA_APP.CONTRACT.CONTRACT_TYPE_ID = HHSA_APP.CONTRACT_TYPE.CONTRACT_TYPE_ID
AND HHSA_APP.CONTRACT.STATUS_ID  IN (SELECT STATUS_ID FROM HHSA_APP.STATUS_MASTER_R2_R3 WHERE PROCESS_TYPE = 'Contract' AND STATUS = 'Registered') 
AND HHSA_APP.CONTRACT_TYPE.CONTRACT_TYPE = 'Base' -- ORDER BY CONTRACT_ID,EXT_EPIN,CONTRACT_AMOUNT

Message: Target Table CONTRACT :SQL UPDATE override statement:
SELECT STATUS_ID , UPDATE_FLAG , MODIFIED_DATE , MODIFIED_BY_USERID , DISCREPANCY_FLAG , FMS_CONTRACT_AMOUNT , FMS_CONTRACT_END_DATE ,EXT_EPIN 
from CONTRACT;
UPDATE CONTRACT SET STATUS_ID = ?, UPDATE_FLAG = ?, MODIFIED_DATE = ?, MODIFIED_BY_USERID = ?, DISCREPANCY_FLAG = ?, FMS_CONTRACT_AMOUNT = ?, FMS_CONTRACT_END_DATE = ?  WHERE EXT_EPIN = ? AND CONTRACT_TYPE_ID = 2 AND CONTRACT_ID = ?

----
-------

Extra:10_23_2018
----

select * from contract
where CONTRACT_TITLE = 'BAQTSTC166';  
---pending registration status id  1 61 and 6 60;---registration flag =0; 01-JUL-18 12.00.00.000000000 AM	30-JUN-21 12.00.00.000000000 AM

select * from BUDGET_CUSTOMIZATION where CONTRACT_ID in (select CONTRACT_ID from contract 
where ext_ct_number IN ('CT1781BAQTSTC166') );

select * from STG_CONTRACTS_H;
select * from REF_CONTRACTS_H order by created_date desc;

select CT_NUMBER,  PAYMENT_VOUCHER_NUM,   PAYMENT_APPROVED_DATE-PAYMENT_SUBMITTED_DATE, FISCAL_YEAR_ID  from PAYMENT
where CT_NUMBER IN ( 'BAQTSTC108', 'BAQTSTC112', 'BAQTSTC53')
order by created_date desc;

select CONTRACT_ID from contract 
where ext_ct_number IN ('CT1781BAQTSTC166');  

select A.EXT_CT_NUMBER , A.*from CONTRACT A
where EXT_CT_NUMBER IS NOT NULL 
and EXT_CT_NUMBER in ( select EXT_CT_NUMBER from contract
where CONTRACT_TYPE_ID =4)
order by A.EXT_CT_NUMBER, A.CREATED_DATE DESC;

update contract 
set EXT_CT_NUMBER = 'BAQTSTC160', STATUS_ID = 61
where EXT_CT_NUMBER = 'CT1781BAQTSTC160';

COMMIT;

select * from contract
WHERE EXT_CT_NUMBER = 'BAQTSTC160' and STATUS_ID = 61;

select * from contract
WHERE CONTRACT_TITLE = 'BAQTSTC160';

delete from CONTRACT
where contract_id = 47943 and contract_type_id = 5 ;

commit;

select * from CONTRACT_FINANCIALS 
---where contract_id = 47943 and CONTRACT_FINANCIALS_ID = 271340
order by created_date desc;



select * from CONTRACT
where EXT_CT_NUMBER = 'BAQTSTC166';

update contract 
set  STATUS_ID = 59
where CONTRACT_ID = '47883';
COMMIT;


Select * from HHSA_APP.PROPOSAL_QUESTION_RESPONSE
SET CUSTOM_ANSWER = 6, MODIFIED_DATE = SYSTIMESTAMP, MODIFIED_BY_USERID = 'system'
where PROPOSAL_ID = 12797
and PROCUREMENT_QN_ID IN(2320)
and PROPOSAL_QN_RESPONSE_ID IN (51531);



select * from contract 
order by created_date desc;
select * from budget 
order by created_date desc;
select * from sub_budget
order by created_date desc;  ;- on scren;

select * from CONTRACT_FINANCIALS order by created_date desc;
select * from CONTRACT_CERT_OF_FUNDS
order by created_date desc;

select * from INVOICE
where created_by_userid =  'Interface_ETL'
order by created_date desc;

select * from INVOICE_DETAILS
where created_by_userid =  'Interface_ETL'
order by created_date desc;

select * from tab
order by TNAME asc;


update contract
set status_id = 118
where EXT_CT_NUMBER ='BAQTSTC157';
commit;


select contract_id , STATUS_ID from contract
where EXT_CT_NUMBER ='BAQTSTC157';


select * from contract
order by created_date desc;

---BAQTSTC157|BAQTSTA169|BAQTSTC157_6000_DOP10172018|ERR102|BT_FISCAL_YEAR must be populated if CATEGORY_NAME exists|10/17/2018 13:34:07;


--DFTATST2  inv test;
--payment ;
--budget;

select PAYMENT_ID, PAYMENT_VOUCHER_NUM, STATUS_ID AGENCY_ID from payment order by created_date desc;
select * from PAYMENT_ALLOCATION order by created_date desc;
desc PAYMENT_ALLOCATION;
--;
---10827;
---10828;
--;
---CT1781BAQTSTC166;
191001199P1  aproved payment 

update  PAYMENT set STATUS_ID =65,DISBURSEMENT_DATE = '17-OCT-2018',CHECK_EFT_NUM = 'MANUAL00001017',PROCESS_FLAG=0,MODIFIED_DATE = systimestamp,MODIFIED_BY_USERID  = 'system' 
where PAYMENT_ID = 10807;
commit;

select 50000-(10.18+10.19) from dual;

select * from ref_budget_main order by SRC_MODIFIED_DATE desc;


select * from REF_BUDGET_MAIN order by SRC_MODIFIED_DATE desc, ETL_PROCESSED_DATE desc;
select * from budget order by MODIFIED_DATE desc;

desc REF_BUDGET_MAIN;


update  contract
set status_id = 118
where EXT_CT_NUMBER = 'CT1781BAQTSTC166';
commit;


--select contract_id from contract 
select * from contract
where EXT_CT_NUMBER = 'CT1781BAQTSTC166'
and contract_type_id = 1;   contract_id 47694;

select * from SUB_BUDGET
where  budget_id in ( select budget_id from budget where contract_id  In ( select contract_id from contract
where EXT_CT_NUMBER = 'CT1781BAQTSTC166'
and contract_type_id = 1 ));

select * from budget where contract_id  In ( select contract_id from contract
where EXT_CT_NUMBER = 'CT1781BAQTSTC166'    ----mod 20000 10/192018;
and contract_type_id = 1 );

select * from MILESTONE 
where budget_id in ( select budget_id from budget where contract_id  In ( select contract_id from contract
where EXT_CT_NUMBER = 'CT1781BAQTSTC166'
and contract_type_id = 1 ));

select * from REF_BUDGET_MAIN
where CT_NUMBER = 'CT1781BAQTSTC166';

SELECT * FROM HHSA_APP.REF_MILESTONE WHERE BUDGET_ID=10069;

SELECT * FROM HHSA_APP.REF_PERSONNEL_SERVICES_DETAIL WHERE BUDGET_ID=10069;

SELECT * FROM HHSA_APP.REF_PERSONNEL_SERVICES WHERE BUDGET_ID=10069;

select * from HHSA_APP.REF_SUB_BUDGET
where BUDGET_ID = 10069;

SELECT * FROM REF
select * from ref_budget_information
where budget_id in ( select budget_id from budget where contract_id  In ( select contract_id from contract
where EXT_CT_NUMBER = 'CT1781BAQTSTC166'
and contract_type_id = 1 ));


select * from contract  order by created_date desc;
select * from budget order by created_date desc;
select * from sub_budget order by created_date desc;
select * from milestone 
where budget_id = 10069
and sub_budget_id =  322524
order by created_date desc;


select * from  PERSONNEL_SERVICE
where budget_id = 10069
and sub_budget_id =  322524
order by created_date desc;

SELECT * FROM BUDGET WHERE CT_NUMBER='BAQTSTC113';

SELECT * FROM SUB_BUDGET;

10867


select * from payment order by created_date desc;

select * from ORGANIZATION 
where ORGANIZATION_ID = 'Org_5081'
order by created_date desc;

select * from STAFF_ORGANIZATION 
where ORGANIZATION_ID = 'Org_5081' 
---and staff_id = 6964
;  


select * from hhsa_app.MEMBER_TITLE;

select * from BUDGET_CUSTOMIZATION order by created_date desc;

select * from invoice 
where status_id = 158 
and CREATED_BY_USERID = 'Interface_ETL'
order by created_date desc;

--------





New QC:should be created for the budget advance & negative amendment issue...
------for the HHS Accelerator issue
QC9135: for HHS Accelerator.
Priority: 3 -High
Detected in release 7.2.2
Reproducible :Y
Module: Amendment

for ETL create a new one:


Enhance Agency Advance Inbound interface to generate ERR114 error code  while Negative Amendment is in Progress.

Please enhance the Agency Advance Inbound interface to generate the ERR114 error code ("Cannot initiate advances while a negative amendment is in progress and the amendment budget has not been approved.")
 


Steps:
Kickoff a Negative Amendment for an Registered contract.
Execute the Agency Advance Inbound interface.

 
Expected:
Agency Advance Inbound interface should not create an advance while a negative amendment is in progress.
 
Actual:
Agency Advance Inbound interface creates an advance while a negative amendment is in progress.




-------8/20/2018
PRC2 outbound...
In STG environment
use the following for 
update HHSA_APP.PAYMENT set Process_flag='1' where payment_id=164733;
commit;
select * from HHSA_APP.PAYMENT where Process_flag='1' and  payment_id=164733;
STG for PRC2 outbound
-------

QC9122:Allow Agency to amend pending registration contracts

Updating the logic to allow agency to amend pending registration contracts. This will allow Agency to send out amendemnt budgets and not have to wait for contract registration.



Muhammad Ali <muhali>, 7/26/2018: BAQA to analyze and discuss with business for the full requirement. Please discuss all the possible scenarios and stages of contract and amendment. 

________________________________________
Muhammad Ali <muhali>, 9/4/2018: send a follow up email to BAQA Team. (Richard/Jacke)

________________________________________
Jacqueline Chew <jachew>, 9/12/2018: Had a conversation with financial team regarding the requirements for this QC.  DYCD would like to have ability to queue up amendments while the contracts are in pending registration status and the base budgets are approved.  The approved base budget would have no updates, invoice, and payments pending.  Need to check if budget mod is okay (sent email to finance team).  Contracts and amendments do not register at the same time.   
________________________________________
Jacqueline Chew <jachew>, 9/13/2018: Additional clarification from Tali is in attached email.  Discussed in BAQA meeting about testing scenarios, make sure to test the timing of contract/amendment registration, ex: register contract first then amendment and vice versa.  Need to check with finance team if provider should be able to submit the amendement budget, if the budget merges, etc. 

________________________________________
Muhammad Ali <muhali>, 9/13/2018: WE will have the requirements to be captured for estimate calculation. 
  
________________________________________
Jacqueline Chew <jachew>, 9/17/2018: Additional clarification from Tali:
the provider should be able to submit their amendment budget and the agency should be able to approve it.  It should sit Approved as it does now and wait for registration. 
The amendment would merge once it is registered.  Workflow should remain as it is now with amendments






HRA----12/7/2018


select * from INVOICE
where INVOICE_NUMBER = 191101209;

select * from CONTRACT 
where CONTRACT_TITLE in ('HRA1','HRA2','HRA3')
order by created_date desc;

select * from  INVOICE order by created_date desc;

select * from INVOICE_DETAILS 
where invoice_id in (1379,1378,1377)
order by created_date desc;

select * from sub_budget where SUB_BUDGET_ID = 377655;   -budget_id = 10178;
select * from budget where budget_id = 10178;
select * from STG_INVOICE_DETAILS;

select * from contract order by created_date desc;

---CT106920161420014   hra1
---CT106920171423946   hra2
---CT106920161419884   hra3


select * from STG_ADVANCE_INFORMATION;




select * from BUDGET_ADVANCE order by created_date desc;

Contract id: 48126;
budget id :10123;

where Budget_id is null and CONTRACT_ID is not null;

select * from INTERFACE_ERROR_MASTER_181205;

where contract_id = 44743
;


select * from BUDGET_ADVANCE
order by CREATED_DATE desc;
where ADVANCE_DESCRIPTION = 'Test_8_17_2018';

select * from CONTRACT 
where COntract_id = 44743;
select * from budget where contract_id in (44743);  --- budget_id = 9628 BAQTSTC71;

select * from budget where contract_id in (48603);   ---dhs--budget_id = 10186;
select * from contract;

select * from budget_advance order by CREATED_DATE desc;
---goes to advance payment review thru etl;  --- already approved; no advance request review thru etl;
----
---when the advance payment review returned for revision ;;---


select * from CONTRACT order by created_date desc;

-----48223 ct    -neg amend; budget 10133;

select * from budget order by created_date desc;



select * from contract where contract_id = 48223;

update contract 
set status_id = 118
where contract_id = 48424;               48223;
commit;


update contract 
set status_id = 118
where EXT_CT-NUMBER = 'BAQTSTC183';
commit;





select contract_id from contract where ext_EPIN = 'BAQTSAA151' or contract_id = 48223;

select * from contract_type;
select * from budget_type;

select * from budget where contract_id in ( select contract_id from contract where ext_EPIN = 'BAQTSAA151' or contract_id = 48223 );

budget_type_id;
1	Budget Amendment;
2	Contract Budget;
3	Budget Modification;
4	Budget Update;
5	Original;


select budget_type_id, count(budget_type_id) from budget where budget_id in (select budget_id from BUDGET_ADVANCE)
group by budget_type_id;


select * from budget where budget_id in (select budget_id from BUDGET_ADVANCE) and budget_type_id =1;




select * from STG_INVOICE_DETAILS;
select * from MILESTONE order by created_date desc;



SELECT * FROM HHSA_APP.AGENCY_AUDIT
WHERE DATA LIKE '%Pending Submission%'  or DATA LIKE '%Pending Configuration%'
order by AUDIT_DATE desc
;
 
SELECT * FROM HHSA_APP.BUDGET
WHERE STATUS_ID = 86 AND ACTIVE_FLAG = 1
ORDER BY LAST_UPDATE_DATE DESC
;
WITH AUDIT_STATUS AS (
SELECT * FROM HHSA_APP.AGENCY_AUDIT
UNION ALL 
SELECT * FROM HHSA_APP.ACCELERATOR_AUDIT
UNION ALL 
SELECT * FROM HHSA_APP.PROVIDER_AUDIT
) 
SELECT S.* , B.CT_NUMBER, C.CONTRACT_TITLE FROM AUDIT_STATUS S, BUDGET B, CONTRACT C
WHERE 
S.ENTITY_ID = B.BUDGET_ID
AND B.CONTRACT_ID = C.CONTRACT_ID
--S.ENTITY_ID = '28258'
AND
S.ENTITY_TYPE LIKE '%Budget%' 
and S.DATA = 'Status Changed from ''Approved'' To ''Active'''
ORDER BY S.MODIFIED_DATE desc
;





desc ref_apt_epin_master;

select * from ref_apt_epin_master order by created_date desc;
where PROCUREMENT_AWARD_EPIN in
('BAQTSTC193',
'BAQTSTC192',
'BAQTSTC191',
'BAQTSTC190',
'BAQTSTC189',
'BAQTSTC187',
'BAQTSTC186',
'BAQTSTC188',
'BAQTSTC185',
'BAQTSTC184')
order by created_date desc;

REM INSERTING into EXPORT_TABLE
SET DEFINE OFF;
Insert into  ref_apt_epin_master (INTEGRATION_ID,REF_APT_EPIN_ID,PROCUREMENT_EPIN_ID,AWARD_EPIN_ID,DESCRIPTION,PROCUREMENT_AWARD_EPIN,PROCUREMENT_METHOD,AWARD_AMOUNT,DATE_SENT_TO_COMPTROLLER,PROCUREMENT_START_DATE,AWARDED_VENDOR_NAME,VENDOR_FMS_ID,CONTRACT_START_DATE,REGISTRATION_DATE,PROJECT_PROGRAM,MOCS_APPROVAL_DATE,APT_MILESTONE,CONTRACT_END_DATE,AGENCY_DIVISION,AGENCY_ID,AWARD_AGENCY_ID,EPIN_TYPE,CREATED_DATE,CREATED_BY_USERID,MODIFIED_DATE,MODIFIED_BY_USERID,CONTRACT_ID) values ('MANUAL0000000010238',1999995143,1999995143,'1999995143','BAQTSTC198','BAQTSTC198',null,30000,null,null,'YMCA of Greater New York','VD001302023',to_date('07/01/2018 00:00:00','MM/DD/YYYY HH24:MI:SS'),null,'Justice Community Program',null,null,to_date('06/30/2021 00:00:00','MM/DD/YYYY HH24:MI:SS'),'DOP','DOP',null,'C',to_timestamp('03-DEC-18 03.48.55.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL',to_timestamp('04-DEC-18 03.48.55.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL','BAQTSTC198');
Insert into  ref_apt_epin_master (INTEGRATION_ID,REF_APT_EPIN_ID,PROCUREMENT_EPIN_ID,AWARD_EPIN_ID,DESCRIPTION,PROCUREMENT_AWARD_EPIN,PROCUREMENT_METHOD,AWARD_AMOUNT,DATE_SENT_TO_COMPTROLLER,PROCUREMENT_START_DATE,AWARDED_VENDOR_NAME,VENDOR_FMS_ID,CONTRACT_START_DATE,REGISTRATION_DATE,PROJECT_PROGRAM,MOCS_APPROVAL_DATE,APT_MILESTONE,CONTRACT_END_DATE,AGENCY_DIVISION,AGENCY_ID,AWARD_AGENCY_ID,EPIN_TYPE,CREATED_DATE,CREATED_BY_USERID,MODIFIED_DATE,MODIFIED_BY_USERID,CONTRACT_ID) values ('MANUAL0000000010237',1999995142,1999995142,'1999995142','BAQTSTC197','BAQTSTC197',null,30000,null,null,'YMCA of Greater New York','VD001302023',to_date('07/01/2018 00:00:00','MM/DD/YYYY HH24:MI:SS'),null,'Justice Community Program',null,null,to_date('06/30/2021 00:00:00','MM/DD/YYYY HH24:MI:SS'),'DOP','DOP',null,'C',to_timestamp('03-DEC-18 03.47.50.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL',to_timestamp('04-DEC-18 03.47.50.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL','BAQTSTC197');
Insert into  ref_apt_epin_master (INTEGRATION_ID,REF_APT_EPIN_ID,PROCUREMENT_EPIN_ID,AWARD_EPIN_ID,DESCRIPTION,PROCUREMENT_AWARD_EPIN,PROCUREMENT_METHOD,AWARD_AMOUNT,DATE_SENT_TO_COMPTROLLER,PROCUREMENT_START_DATE,AWARDED_VENDOR_NAME,VENDOR_FMS_ID,CONTRACT_START_DATE,REGISTRATION_DATE,PROJECT_PROGRAM,MOCS_APPROVAL_DATE,APT_MILESTONE,CONTRACT_END_DATE,AGENCY_DIVISION,AGENCY_ID,AWARD_AGENCY_ID,EPIN_TYPE,CREATED_DATE,CREATED_BY_USERID,MODIFIED_DATE,MODIFIED_BY_USERID,CONTRACT_ID) values ('MANUAL0000000010236',1999995141,1999995141,'1999995141','BAQTSTC196','BAQTSTC196',null,30000,null,null,'YMCA of Greater New York','VD001302023',to_date('07/01/2018 00:00:00','MM/DD/YYYY HH24:MI:SS'),null,'Justice Community Program',null,null,to_date('06/30/2021 00:00:00','MM/DD/YYYY HH24:MI:SS'),'DOP','DOP',null,'C',to_timestamp('03-DEC-18 03.46.10.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL',to_timestamp('04-DEC-18 03.46.10.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL','BAQTSTC196');
Insert into  ref_apt_epin_master (INTEGRATION_ID,REF_APT_EPIN_ID,PROCUREMENT_EPIN_ID,AWARD_EPIN_ID,DESCRIPTION,PROCUREMENT_AWARD_EPIN,PROCUREMENT_METHOD,AWARD_AMOUNT,DATE_SENT_TO_COMPTROLLER,PROCUREMENT_START_DATE,AWARDED_VENDOR_NAME,VENDOR_FMS_ID,CONTRACT_START_DATE,REGISTRATION_DATE,PROJECT_PROGRAM,MOCS_APPROVAL_DATE,APT_MILESTONE,CONTRACT_END_DATE,AGENCY_DIVISION,AGENCY_ID,AWARD_AGENCY_ID,EPIN_TYPE,CREATED_DATE,CREATED_BY_USERID,MODIFIED_DATE,MODIFIED_BY_USERID,CONTRACT_ID) values ('MANUAL0000000010235',1999995140,1999995140,'1999995140','BAQTSTC195','BAQTSTC195',null,30000,null,null,'YMCA of Greater New York','VD001302023',to_date('07/01/2018 00:00:00','MM/DD/YYYY HH24:MI:SS'),null,'Justice Community Program',null,null,to_date('06/30/2021 00:00:00','MM/DD/YYYY HH24:MI:SS'),'DOP','DOP',null,'C',to_timestamp('03-DEC-18 03.44.59.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL',to_timestamp('04-DEC-18 03.44.59.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL','BAQTSTC195');
Insert into  ref_apt_epin_master (INTEGRATION_ID,REF_APT_EPIN_ID,PROCUREMENT_EPIN_ID,AWARD_EPIN_ID,DESCRIPTION,PROCUREMENT_AWARD_EPIN,PROCUREMENT_METHOD,AWARD_AMOUNT,DATE_SENT_TO_COMPTROLLER,PROCUREMENT_START_DATE,AWARDED_VENDOR_NAME,VENDOR_FMS_ID,CONTRACT_START_DATE,REGISTRATION_DATE,PROJECT_PROGRAM,MOCS_APPROVAL_DATE,APT_MILESTONE,CONTRACT_END_DATE,AGENCY_DIVISION,AGENCY_ID,AWARD_AGENCY_ID,EPIN_TYPE,CREATED_DATE,CREATED_BY_USERID,MODIFIED_DATE,MODIFIED_BY_USERID,CONTRACT_ID) values ('MANUAL0000000010234',1999995139,1999995139,'1999995139','BAQTSTC194','BAQTSTC194',null,30000,null,null,'YMCA of Greater New York','VD001302023',to_date('07/01/2018 00:00:00','MM/DD/YYYY HH24:MI:SS'),null,'Justice Community Program',null,null,to_date('06/30/2021 00:00:00','MM/DD/YYYY HH24:MI:SS'),'DOP','DOP',null,'C',to_timestamp('03-DEC-18 03.44.59.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL',to_timestamp('04-DEC-18 03.44.59.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL','BAQTSTC194');

commit;

select MILESTONE_ID,BUDGET_ID,SUB_BUDGET_ID, MILESTONE, REMAINING_AMOUNT, YTD_INVOICED_AMOUNT, AMOUNT  from MILESTONE where REMAINING_AMOUNT < 0;

select * from ref_apt_epin_master
where agency_division = 'HRA';


REM INSERTING into EXPORT_TABLE
SET DEFINE OFF;
Insert into  ref_apt_epin_master (INTEGRATION_ID,REF_APT_EPIN_ID,PROCUREMENT_EPIN_ID,AWARD_EPIN_ID,DESCRIPTION,PROCUREMENT_AWARD_EPIN,PROCUREMENT_METHOD,AWARD_AMOUNT,DATE_SENT_TO_COMPTROLLER,PROCUREMENT_START_DATE,AWARDED_VENDOR_NAME,VENDOR_FMS_ID,CONTRACT_START_DATE,REGISTRATION_DATE,PROJECT_PROGRAM,MOCS_APPROVAL_DATE,APT_MILESTONE,CONTRACT_END_DATE,AGENCY_DIVISION,AGENCY_ID,AWARD_AGENCY_ID,EPIN_TYPE,CREATED_DATE,CREATED_BY_USERID,MODIFIED_DATE,MODIFIED_BY_USERID,CONTRACT_ID) values ('MANUAL0000000010257',1999995162,1999995162,'1999995162','HRA1','HRA1',null,100000000,null,null,'YMCA of Greater New York','VD001302023',to_date('07/01/2018 00:00:00','MM/DD/YYYY HH24:MI:SS'),null,'Justice Community Program',null,null,to_date('06/30/2021 00:00:00','MM/DD/YYYY HH24:MI:SS'),'HRA','HRA',null,'C',to_timestamp('03-DEC-18 03.48.55.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL',to_timestamp('04-DEC-18 03.48.55.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL','HRA1');
----Insert into  ref_apt_epin_master (INTEGRATION_ID,REF_APT_EPIN_ID,PROCUREMENT_EPIN_ID,AWARD_EPIN_ID,DESCRIPTION,PROCUREMENT_AWARD_EPIN,PROCUREMENT_METHOD,AWARD_AMOUNT,DATE_SENT_TO_COMPTROLLER,PROCUREMENT_START_DATE,AWARDED_VENDOR_NAME,VENDOR_FMS_ID,CONTRACT_START_DATE,REGISTRATION_DATE,PROJECT_PROGRAM,MOCS_APPROVAL_DATE,APT_MILESTONE,CONTRACT_END_DATE,AGENCY_DIVISION,AGENCY_ID,AWARD_AGENCY_ID,EPIN_TYPE,CREATED_DATE,CREATED_BY_USERID,MODIFIED_DATE,MODIFIED_BY_USERID,CONTRACT_ID) values ('MANUAL0000000010237',1999995142,1999995142,'1999995142','BAQTSTC197','BAQTSTC197',null,30000,null,null,'YMCA of Greater New York','VD001302023',to_date('07/01/2018 00:00:00','MM/DD/YYYY HH24:MI:SS'),null,'Justice Community Program',null,null,to_date('06/30/2021 00:00:00','MM/DD/YYYY HH24:MI:SS'),'DOP','DOP',null,'C',to_timestamp('03-DEC-18 03.47.50.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL',to_timestamp('04-DEC-18 03.47.50.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL','BAQTSTC197');
----Insert into  ref_apt_epin_master (INTEGRATION_ID,REF_APT_EPIN_ID,PROCUREMENT_EPIN_ID,AWARD_EPIN_ID,DESCRIPTION,PROCUREMENT_AWARD_EPIN,PROCUREMENT_METHOD,AWARD_AMOUNT,DATE_SENT_TO_COMPTROLLER,PROCUREMENT_START_DATE,AWARDED_VENDOR_NAME,VENDOR_FMS_ID,CONTRACT_START_DATE,REGISTRATION_DATE,PROJECT_PROGRAM,MOCS_APPROVAL_DATE,APT_MILESTONE,CONTRACT_END_DATE,AGENCY_DIVISION,AGENCY_ID,AWARD_AGENCY_ID,EPIN_TYPE,CREATED_DATE,CREATED_BY_USERID,MODIFIED_DATE,MODIFIED_BY_USERID,CONTRACT_ID) values ('MANUAL0000000010236',1999995141,1999995141,'1999995141','BAQTSTC196','BAQTSTC196',null,30000,null,null,'YMCA of Greater New York','VD001302023',to_date('07/01/2018 00:00:00','MM/DD/YYYY HH24:MI:SS'),null,'Justice Community Program',null,null,to_date('06/30/2021 00:00:00','MM/DD/YYYY HH24:MI:SS'),'DOP','DOP',null,'C',to_timestamp('03-DEC-18 03.46.10.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL',to_timestamp('04-DEC-18 03.46.10.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL','BAQTSTC196');
----Insert into  ref_apt_epin_master (INTEGRATION_ID,REF_APT_EPIN_ID,PROCUREMENT_EPIN_ID,AWARD_EPIN_ID,DESCRIPTION,PROCUREMENT_AWARD_EPIN,PROCUREMENT_METHOD,AWARD_AMOUNT,DATE_SENT_TO_COMPTROLLER,PROCUREMENT_START_DATE,AWARDED_VENDOR_NAME,VENDOR_FMS_ID,CONTRACT_START_DATE,REGISTRATION_DATE,PROJECT_PROGRAM,MOCS_APPROVAL_DATE,APT_MILESTONE,CONTRACT_END_DATE,AGENCY_DIVISION,AGENCY_ID,AWARD_AGENCY_ID,EPIN_TYPE,CREATED_DATE,CREATED_BY_USERID,MODIFIED_DATE,MODIFIED_BY_USERID,CONTRACT_ID) values ('MANUAL0000000010235',1999995140,1999995140,'1999995140','BAQTSTC195','BAQTSTC195',null,30000,null,null,'YMCA of Greater New York','VD001302023',to_date('07/01/2018 00:00:00','MM/DD/YYYY HH24:MI:SS'),null,'Justice Community Program',null,null,to_date('06/30/2021 00:00:00','MM/DD/YYYY HH24:MI:SS'),'DOP','DOP',null,'C',to_timestamp('03-DEC-18 03.44.59.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL',to_timestamp('04-DEC-18 03.44.59.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL','BAQTSTC195');
----Insert into  ref_apt_epin_master (INTEGRATION_ID,REF_APT_EPIN_ID,PROCUREMENT_EPIN_ID,AWARD_EPIN_ID,DESCRIPTION,PROCUREMENT_AWARD_EPIN,PROCUREMENT_METHOD,AWARD_AMOUNT,DATE_SENT_TO_COMPTROLLER,PROCUREMENT_START_DATE,AWARDED_VENDOR_NAME,VENDOR_FMS_ID,CONTRACT_START_DATE,REGISTRATION_DATE,PROJECT_PROGRAM,MOCS_APPROVAL_DATE,APT_MILESTONE,CONTRACT_END_DATE,AGENCY_DIVISION,AGENCY_ID,AWARD_AGENCY_ID,EPIN_TYPE,CREATED_DATE,CREATED_BY_USERID,MODIFIED_DATE,MODIFIED_BY_USERID,CONTRACT_ID) values ('MANUAL0000000010234',1999995139,1999995139,'1999995139','BAQTSTC194','BAQTSTC194',null,30000,null,null,'YMCA of Greater New York','VD001302023',to_date('07/01/2018 00:00:00','MM/DD/YYYY HH24:MI:SS'),null,'Justice Community Program',null,null,to_date('06/30/2021 00:00:00','MM/DD/YYYY HH24:MI:SS'),'DOP','DOP',null,'C',to_timestamp('03-DEC-18 03.44.59.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL',to_timestamp('04-DEC-18 03.44.59.000000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'HHSA_APP_ETL','BAQTSTC194');

commit;

update CONTRACT
set status_id = 118
where EXT_CT_NUMBER in ('CT106920171423946','CT106920161420014','CT106920161419884');
COMMIT;


select * from ref_apt_epin_master order by created_date desc;

-----
-----


update contract 
set ext_ct_number = contract_title, status_id = 118
where CONTRACT_TITLE in ('BAQC12400','BAQC12401','BAQC12402','BAQC12403','BAQC12404','BAQC12405');
COMMIT;










-----
USER:
-----


select * from 
HHSA_APP.STAFF_DETAILS
where LAST_LOGIN_DATE is not null
and trim(UPPER(email)) <> trim(UPPER(NYC_USER_ID))
order by last_login_date desc;


-------
: SQ Instance [SQ_STAFF_DETAILS] User specified SQL Query [---;
SELECT
  staff.STAFF_ID||staff_org.organization_id as INTEGRATION_ID,
  staff.FIRST_NAME,
  staff.MIDDLE_INITIAL,
  staff.LAST_NAME,
  mem.MEMBER_NAME as TITLE,
  staff.PHONE,
  staff.EMAIL,
  staff.CREATED_DATE AS USER_ACCOUNT_CREATED_DATE,
  staff.LAST_LOGIN_DATE,
  staff_org.is_base_organization,
  staff_org.ACTIVE_FLAG,
  staff_org.MEMBER_STATUS,
  staff.NYC_USER_ID,
  staff_org.USER_STATUS,
  staff_org.MEMBER_INACTIVE_DATE,
  staff_org.ADMIN_PERMISSION,
  staff.TERMS_CONDITIONS_ACCEPTED,
  staff.USER_DN,
  staff_org.PERMISSION_LEVEL,
  staff_org.PERMISSION_TYPE
FROM
  HHSA_APP.STAFF_ORGANIZATION staff_org
  LEFT JOIN  HHSA_APP.STAFF_DETAILS staff ON staff.staff_id = staff_org.staff_id
  LEFT JOIN HHSA_APP.MEMBER_TITLE mem on MEMBER_ID = staff_org.TITLE
WHERE (CURRENT_DATE - TRUNC(staff_org.REPORTING_MODIFIED_DATE) <= 3)
OR
(CURRENT_DATE - TRUNC(staff.REPORTING_MODIFIED_DATE) <= 3);
]




-------
Lookup Transformation [LKP_staff_org_detail_P1]: Lookup override sql to create cache: ;
SELECT  staff_org.STAFF_ID AS STAFF_ID,  staff_org.ORGANIZATION_ID AS ORGANIZATION_ID 
FROM STAFF_ORGANIZATION staff_org, 
STAFF_DETAILS staff,
MEMBER_TITLE mem
WHERE 
staff_org.STAFF_ID = staff.staff_id
AND mem.MEMBER_ID = staff_org.TITLE
AND 
mem.MEMBER_NAME ='Executive Director / Chief Executive Officer (or equivalent)' 
AND 
UPPER(staff_org.MEMBER_STATUS)='ACTIVE' 
AND UPPER(staff_org.USER_STATUS)='YES' ORDER BY ORGANIZATION_ID,STAFF_ID;

-------
HHS 
-------
select * from payment
order by created_date desc;

select * from ref_apt_epin_master
order by created_date desc;

select * from contract
where contract_id = 7236 and contract_type_id = 1 or EXT_CT_NUMBER = 'BAQC020600'
order by created_date desc;

---Contract financails tab ---Chart of Accounts Allocation for contract value = sum of fy $ amounts  ---- Unit of appropriation budget code object code subobject code reporting code fy$amount;
---conmtract budgets tab ----enter budget title  and Amount (as many as necessary;  sub_budget_name and sub_budget_amount will be equal to the fiscal year (FY) . FY Planned Amount;
select * from CONTRACT_FINANCIALS
where contract_id = 7236
order by created_date desc;

---certification of funds;
select * from budget 
where contract_id = 7236 
order by created_date desc;   ----budget_id 5751;
select * from sub_budget
where BUDGET_ID = 5751;   ----sub_budget_id = 8237;

---budget categories  - selected from the front end
select * from BUDGET_CUSTOMIZATION
where contract_id = 7236 and BUDGET_ID = 5751
order by created_date desc;

---Personnel Services;
select * from PERSONNEL_SERVICE_DETAIL
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;
select * from PERSONNEL_SERVICE_TYPE_MASTER;
select * from PERSONNEL_SERVICE
order by created_date desc;
select * from POSITION
order by position_id asc;
select * from PROGRAM_INCOME
where budget_id = 5751 and sub_budget_id = 8237      ----entry_type_id  = 1,2,3,4,5,6,7,8,9, for each tab;
order by created_date desc;
select * from FRINGE_BENEFIT_DETAIL
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;

----Operations & Support
select * from 
OPERATIONS_AND_SUPPORT
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;
select * from OPERATIONS_SUPPORT_TYPE_MASTER;

select * from equipment
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;

-----utilites
select * from UTILITIES
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;

select * from UTILITIES_TYPE_MASTER;
----Professional Services
select * from PROFESSIONAL_SERVICE
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;
select * from PROFESSIONAL_SERVICE_TYPE_MSTR;

---rent;
select * from RENT
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;

----contracted_services
select * from CONTRACTED_SERVICE
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;
select * from CONTRACTED_SERVICE_TYPE_MASTER;

---RATE
select * from RATE
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;

--- MILESTONE
select * from MILESTONE
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;

---UNALLOCATED
select * from UNALLOCATED
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;

----INDIRECT RATE
select * from INDIRECT_RATE
where budget_id = 5751 and sub_budget_id = 8237
order by created_date desc;

select (1000.00/7919.00) * 100 from dual;  --- indirect Rate - city funded   = indirect costs total / total direct costs;
select (1200.00/7919.00) * 100 from dual;  --- indirect rate - Program  -= fy income budget / total direct costs;

-----Total City Funded Budget amount must match FY Budget.  


select * from STG_CONTRACT_INFORMATION;

----
update contract
set EXT_CT_NUMBER = CONTRACT_TITLE, STATUS_ID = 118
where CONTRACT_TITLE in ('BAQC020600',
'BAQC020601',
'BAQC020602',
'BAQC020603',
'BAQC020604',
'BAQC020605'
);
COMMIT;

----
--------------------;
select * from 
ref_vendor_v
where VEND_CUST_CD = '0000939109';  TIN = 41-3160025 same or different  duplicate in ref_VENDOR_V;   ---2;

select * from ref_apt_epin_master 
where VENDOR_FMS_ID = '0000939109';    ---1;

SELECT ORGANIZATION_LEGAL_NAME, VENDOR_FMS_ID, EIN_ID_NN
FROM ORGANIZATION
WHERE ORGANIZATION_LEGAL_NAME IN (SELECT lgl_nm FROM REF_VENDOR_V WHERE VEND_CUST_CD = '0000939109');   ---1;   --- ORGANIZATION. vendor_fms_ID WAS NULL ; updated here --- does not impact inflight (dups do);
-------------
----;kena issue;
select VENDOR_FMS_ID  from 
HHSA_APP.ref_apt_epin_master
where PROCUREMENT_AWARD_EPIN = '801SBS190044'
order by created_date desc;                     ----- VENDOR_FMS_ID = '0002588055;

INC000002508178
801SBS190044   ----;
The vendor code is listed with apostrophe and that needs to be removed in order to inflight-----;

-------------;
select * from 
HHSA_APP.ref_apt_epin_master
where vendor_fms_id like '''%';

-----;

select * from
REF_APT_EPIN_MASTER
where VENDOR_FMS_ID like '0%';

--------------

select * from STG_APT_EPIN
order by created desc;

SELECT * 
FROM 
STG_NON_APT_EPIN;

select * from INVOICE
order by created_date desc;

select * from INVOICE_DETAILS
order by created_date desc;

select * from STG_INVOICE_DETAILS;
select * from STG_INVOICE_INFORMATION;


select * from 
sub_budget
where sub_budget_id = 4903;

BAQC12403---;
1.Contract Amendment successfully Initiated.
2.Contract Configuration Amendment	BAQC12403	YMCA of Greater New York	02/04/2019	Unassigned Level 1	

select * from contract 
where contract_id in ( 6810, 5060)
order by created_date desc;

update contract 
set contract_end_date = '30-JUN-22 12.00.00.000000000 AM'
where contract_id = 6810 and contract_type_id = 2;
commit;

select * from CONTRACT_FINANCIALS
where contract_id in ( 6810, 5060)
order by created_date desc;

update CONTRACT_FINANCIALS
set fiscal_year_id = 2020
where fiscal_year_id = 2023
and contract_id = 5060;
commit;



update contract
set contract_end_date = '30-JUN-22 12.00.00.000000000 AM', proposed_contract_end_date = '30-JUN-22 12.00.00.000000000 AM', budget_start_year = 2019
where contract_id in ( 6810, 5060);
commit;


select * from budget
where CONTRACT_ID in ( 6810, 5060);

update budget 
set fiscal_year_id = fiscal_year_id + 1 
where CONTRACT_ID in ( 6810, 5060);
commit;

select * from sub_budget
where BUDGET_ID in (select budget_id from budget
where CONTRACT_ID in ( 6810, 5060) );

update sub_budget
set fiscal_year_id = fiscal_year_id + 1
where SUB_BUDGET_ID in (select sub_budget_id  from sub_budget
where BUDGET_ID in (select budget_id from budget
where CONTRACT_ID in ( 6810, 5060) ));
commit;


update contract_financials 
set fiscal_year_id = fiscal_year_id +1 
where contract_id = 6810;
commit;

update contract_financials 
set fiscal_year_id = fiscal_year_id +1 
where contract_id = 5060;
commit;


update contract_financials 
set fiscal_year_id = fiscal_year_id +1 
where contract_id = 6810;
commit;

--select
---SII.PK_ID,
---(case 
---WHEN((select COST_CENTER_OPTED FROM HHSA_APP.CONTRACT WHERE CONTRACT_ID=B.CONTRACT_ID )=2) THEN 'ERR108'
---else SII.XML_CHECK
---end) as XML_CHECK 
---from 
---HHSA_APP.STG_INVOICE_INFORMATION SII,
---HHSA_APP.BUDGET B
---WHERE SII.BUDGET_ID=B.BUDGET_ID(+)-- ;
---;


select * from organization
where organization_legal_name in ('CookieNLollie', 'YMCA of Greater New York');

Organization Account Already Created;
Your Organization already has an HHS Accelerator account. ;
Would you like to request an account for the system from your organization's HHS Accelerator Account Administrator?;

Account Request Submitted
An account request has been submitted to your organization's existing Account Administrator. 
You should receive an email notification at baqa2@mailinator.com when your request has been reviewed. ;



! There can only be one Executive Director/CEO. Please remove your existing ED to add a new one;  (rule) HHS Acceleratot ---;


: SQ Instance [SQ_STAFF_DETAILS] User specified SQL Query [---;
SELECT
  staff.STAFF_ID||staff_org.organization_id as INTEGRATION_ID,
  staff.FIRST_NAME,
  staff.MIDDLE_INITIAL,
  staff.LAST_NAME,
  mem.MEMBER_NAME as TITLE,
  staff.PHONE,
  staff.EMAIL,
  staff.CREATED_DATE AS USER_ACCOUNT_CREATED_DATE,
  staff.LAST_LOGIN_DATE,
  staff_org.is_base_organization,
  staff_org.ACTIVE_FLAG,
  staff_org.MEMBER_STATUS,
  staff.NYC_USER_ID,
  staff_org.USER_STATUS,
  staff_org.MEMBER_INACTIVE_DATE,
  staff_org.ADMIN_PERMISSION,
  staff.TERMS_CONDITIONS_ACCEPTED,
  staff.USER_DN,
  staff_org.PERMISSION_LEVEL,
  staff_org.PERMISSION_TYPE
FROM
  HHSA_APP.STAFF_ORGANIZATION staff_org
  LEFT JOIN  HHSA_APP.STAFF_DETAILS staff ON staff.staff_id = staff_org.staff_id
  LEFT JOIN HHSA_APP.MEMBER_TITLE mem on MEMBER_ID = staff_org.TITLE
WHERE (CURRENT_DATE - TRUNC(staff_org.REPORTING_MODIFIED_DATE) <= 3)
OR
(CURRENT_DATE - TRUNC(staff.REPORTING_MODIFIED_DATE) <= 3);
]


----------
Lookup Transformation [LKP_staff_org_detail_P1]: Lookup override sql to create cache: ;
SELECT  staff_org.STAFF_ID AS STAFF_ID,  staff_org.ORGANIZATION_ID AS ORGANIZATION_ID 
FROM STAFF_ORGANIZATION staff_org, 
STAFF_DETAILS staff,
MEMBER_TITLE mem
WHERE 
staff_org.STAFF_ID = staff.staff_id
AND mem.MEMBER_ID = staff_org.TITLE
AND 
---mem.MEMBER_NAME ='Executive Director / Chief Executive Officer (or equivalent)' 
---AND 
UPPER(staff_org.MEMBER_STATUS)='ACTIVE' 
AND UPPER(staff_org.USER_STATUS)='YES' ORDER BY ORGANIZATION_ID,STAFF_ID;


----------
Lookup Transformation [LKP_staff_org_detail_P3]: Lookup override sql to create cache: ---;
SELECT  staff_org.STAFF_ID AS STAFF_ID,  staff_org.ORGANIZATION_ID AS ORGANIZATION_ID FROM HHSA_APP.STAFF_ORGANIZATION staff_org, 
HHSA_APP.STAFF_DETAILS staff,
HHSA_APP.MEMBER_TITLE mem
WHERE 
staff_org.STAFF_ID = staff.staff_id
AND mem.MEMBER_ID = staff_org.TITLE
AND 
(mem.MEMBER_NAME ='Executive Director / Chief Executive Officer (or equivalent)' OR mem.MEMBER_NAME='Executive' OR mem.MEMBER_NAME='Manager')
AND staff_org.PERMISSION_TYPE='FP' AND UPPER(staff_org.PERMISSION_LEVEL)='LEVEL 2'
AND UPPER(staff_org.MEMBER_STATUS)='ACTIVE' ORDER BY ORGANIZATION_ID,STAFF_ID;

-----------;
select * from contract
order by created_date desc;

update contract 
set ext_ct_number = contract_title, status_id = 118
where contract_title = 'BAQC020400';
COMMIT;


select * from invoice_details
order by created_date desc;

select * from invoice 
order by created_date desc;


AutomationOrg 25

Sheltering Arms Children and Family Services, Inc.


select distinct '1 - ROW: 4) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = '0000939109' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('Sheltering Arms Children and Family Services, Inc.')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> '0000939109' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'Sheltering Arms Children and Family Services, Inc.' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = '0000939109';

/* Check if EPIN(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_AWARD_EPIN in('26019P0009565');

/* Check for latest INTEGRATION_ID, REF_APT_EPIN_ID and PROCUREMENT_EPIN_ID in REF_APT_EPIN_MASTER in the TST database. */
select 'INTEGRATION_ID' as Col, max(INTEGRATION_ID) as MAX_VAL, cast (substr(max(INTEGRATION_ID),-10) as NUMBER) + 1 as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID like('MANUAL000%') union all
select 'REF_APT_EPIN_ID' as Col, cast( max(REF_APT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(REF_APT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER union all
select 'PROCUREMENT_EPIN_ID' as Col, cast( max(PROCUREMENT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(PROCUREMENT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER;

990003867


/* Check if INTEGRATION_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID in('MANUAL0000000005797') union all

/* Check if REF_APT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where REF_APT_EPIN_ID in('990003867') union all

/* Check if PROCUREMENT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_EPIN_ID in('990003867');


/* Check if INTEGRATION_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID in('MANUAL0000000005798') union all

/* Check if REF_APT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where REF_APT_EPIN_ID in('990003867') union all

/* Check if PROCUREMENT_EPIN_ID(s) exist in the TST database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_EPIN_ID in('990003867');



SET autocommit off
SET define off
whenever SQLERROR exit rollback

insert into HHSA_APP.REF_APT_EPIN_MASTER (DESCRIPTION, PROCUREMENT_AWARD_EPIN, EPIN_TYPE, AWARD_AMOUNT, AWARDED_VENDOR_NAME, VENDOR_FMS_ID, CONTRACT_START_DATE, CONTRACT_END_DATE, PROJECT_PROGRAM, AGENCY_DIVISION, AGENCY_ID, AWARD_AGENCY_ID, CONTRACT_ID, DATE_SENT_TO_COMPTROLLER, PROCUREMENT_START_DATE, REGISTRATION_DATE, MOCS_APPROVAL_DATE, APT_MILESTONE, AWARD_EPIN_ID, PROCUREMENT_METHOD, INTEGRATION_ID, REF_APT_EPIN_ID, PROCUREMENT_EPIN_ID, CREATED_DATE, CREATED_BY_USERID, MODIFIED_DATE, MODIFIED_BY_USERID) values ('9565 - RHY Drop In','26019P0009565','C','1310854','Sheltering Arms Children and Family Services, Inc.','0000939109',to_timestamp('01-JAN-19','DD-MON-RR HH.MI.SS.FF AM'),to_timestamp('30-JUN-22','DD-MON-RR HH.MI.SS.FF AM'),'Runaway and Homeless Youth (RHY) Services','DYCD','260','260',null,null,null,null,null,null,null,'RQS','MANUAL0000000005798','990003867','990003867',systimestamp,'HHSA_APP_ETL',systimestamp,'HHSA_APP_ETL');

commit;


Organization.Organization legal name updated to  'Sheltering Arms Children and Family Services, Inc.' there are two rows in ref_vendror_v ;
---- ref_vendor_v tin # different --- LGL_NM is same;  (if the REF_VENDOR_V.TIN is the same for the both rows it will both show in the Add vendor to "Assignees list in HHS"---;
ref_vendor_v    (REF_VENDOR_V_LGL_NM is to put back to excel before running the others ;
----

----
vend_cust_cd = 0000939109
----
select * from INVOICE_DETAILS
order by created_date desc;

----
select * from Invoice 
order by created_date desc;
----
invoice_number = 190200628;

select * from stg_invoice_details;
select * from assignment
order by created_date desc;

select * from stg_invoice_assignment_details;  --- inserting two rows;

select * from stg_invoice_advance_details;



select * from sub_budget
where SUB_BUDGET_ID = 7583;


Your organization's account request has been successfully submitted.---;
You will receive a system notification following the City's review.---;
Dear Tim Forthew,---;
Your account request was received and is being reviewed. We will notify you once your account request has been approved. ---;
Thank you,---;
Mayor's Office of Contract Services ---;
If you have any questions or need assistance, please reach out to MOCS at help@mocs.nyc.gov. ---;
This is an automatically generated e-mail, please do not reply ----;
-----------------------;HRA and DHS
Please update 
$$START_DT=02-06-2019 
$$AGENCY=DHS 
$OutputFileName=DHS
in /informatica/pc/ParamFiles/HHSA_AGENCY_OUTBOUND_STARTER_KIT_param.prm and
then run the following workflows in the PRD environment.

wf_AGENCY_PAYMENT_OUTBOUND_STARTER_KIT 
wf_AGENCY_BUDGET_OUTBOUND_STARTER_KIT 
wf_AGENCY_CONTRACT_OUTBOUND_STARTER_KIT 
wf_AGENCY_INVOICE_OUTBOUND_STARTER_KIT 
wf_AGENCY_PROCUREMENT_OUTBOUND_STARTER_KIT

INC000002511192 ;  ----;
INC000002511306 ;  ----;


------
------

------------
EPIN
---

select * from 
ref_vendor_v
where VEND_CUST_CD = '0000939109';  TIN = 41-3160025 same or different  duplicate in ref_VENDOR_V;   ---2;

select * from ref_apt_epin_master 
where VENDOR_FMS_ID = '0000939109';    ---1;

SELECT ORGANIZATION_LEGAL_NAME, VENDOR_FMS_ID, EIN_ID_NN
FROM ORGANIZATION
WHERE ORGANIZATION_LEGAL_NAME IN (SELECT lgl_nm FROM REF_VENDOR_V WHERE VEND_CUST_CD = '0000939109');   ---1;   --- ORGANIZATION. vendor_fms_ID WAS NULL ; updated here --- does not impact inflight (dups do);



------

-------

-------
-------
-----Log pacsweb hra issues log

https://citypointwss.csc.nycnet/sites/HHSAccelerator/Shared%20Documents/Enterprise_and_Administration/Integrated_Project_Management/Accelerator%20Support%20Status/HRA%20Inteface%20Issues.xlsx

-------
-------

-----------------------------
HRA invoice reject 
-----------------------------

SELECT C.EXT_CT_NUMBER,
C.CONTRACT_TITLE,
EM.ENTRY_TYPE,
SB.SUB_BUDGET_NAME,
SII.BUDGET_ID,
(CASE WHEN IEA.ERROR_CODE = 'ERR001' THEN NULL  ELSE (SELECT F.FISCAL_YEAR FROM HHSA_APP.FISCAL_YEAR F WHERE F.FISCAL_YEAR_ID = B.FISCAL_YEAR_ID) END) as FISCAL_YEAR,
SII.PROVIDER_INVOICE_NUMBER,
SII.AGENCY_INVOICE_NUMBER,
  SID.INVOICE_AMOUNT,
(CASE WHEN IEA.ERROR_CODE IN ('ERR014','ERR015','ERR016','ERR017','ERR018','ERR019','ERR020','ERR028','ERR029') THEN SID.SUB_BUDGET_ID ELSE NULL END) as SUB_BUDGET_ID, 
 'Invoice' as ENTITY,  
 (CASE WHEN (IEA.ERROR_CODE IN ('ERR015','ERR016','ERR017','ERR018','ERR019','ERR028','ERR029')) THEN SID.ENTRY_TYPE_ID ELSE NULL END) as ENTRY_TYPE_ID,
(CASE WHEN  IEA.ERROR_CODE IN ('ERR016','ERR017','ERR018','ERR019','ERR029') THEN SID.LINE_ITEM_ID ELSE NULL END) as LINE_ITEM_ID, 
 (CASE WHEN  IEA.ERROR_CODE = 'ERR020' THEN SIASD.VEND_CUST_CD ELSE NULL END) as VEND_CUST_CD,
(CASE WHEN  IEA.ERROR_CODE IN ('ERR021','ERR022') THEN SIADD.BUDGET_ADVANCE_NUMBER ELSE NULL END) as BUDGET_ADVANCE_NUMBER,
IEA.ERROR_CODE as MSG_CD,
IEA.ERROR_DESC as MSG
FROM
(SELECT PK_ID, XML_CHECK FROM HHSA_APP.STG_INVOICE_INFORMATION WHERE XML_CHECK like 'ERR%' AND XML_CHECK IS NOT NULL
  UNION
SELECT FK_ID, XML_CHECK FROM HHSA_APP.STG_INVOICE_DETAILS  WHERE XML_CHECK like 'ERR%' AND XML_CHECK IS NOT NULL
  UNION
SELECT FK_ID, XML_CHECK FROM HHSA_APP.STG_INVOICE_ASSIGNMENT_DETAILS WHERE XML_CHECK like 'ERR%' AND XML_CHECK IS NOT NULL
  UNION
SELECT FK_ID, XML_CHECK FROM HHSA_APP.STG_INVOICE_ADVANCE_DETAILS  WHERE XML_CHECK like 'ERR%' AND XML_CHECK IS NOT NULL) IV,
    HHSA_APP.STG_INVOICE_INFORMATION SII,
    HHSA_APP.STG_INVOICE_DETAILS SID,
    HHSA_APP.STG_INVOICE_ASSIGNMENT_DETAILS SIASD,
    HHSA_APP.STG_INVOICE_ADVANCE_DETAILS SIADD,
    HHSA_APP.INTERFACE_ERROR_MASTER IEA,
    HHSA_APP.BUDGET B,
    HHSA_APP.CONTRACT C,
    HHSA_APP.ENTRY_TYPE_MASTER EM
    ,HHSA_APP.SUB_BUDGET SB
WHERE
    --IV.PK_ID = SII.PK_ID(+)
    SII.PK_ID = IV.PK_ID
AND IV.PK_ID = SID.FK_ID(+)
AND IV.PK_ID = SIASD.FK_ID(+)
AND IV.PK_ID = SIADD.FK_ID(+)
AND IV.XML_CHECK = IEA.ERROR_CODE(+)
AND SII.BUDGET_ID = B.BUDGET_ID(+)
AND B.CONTRACT_ID=C.CONTRACT_ID
AND SID.SUB_BUDGET_ID=SB.SUB_BUDGET_ID
AND EM.ENTRY_TYPE_ID=SID.ENTRY_TYPE_ID
AND SII.XML_CHECK like 'ERR%'
AND ( SID.XML_CHECK(+) like 'ERR%' AND SIASD.XML_CHECK(+) like 'ERR%' AND SIADD.XML_CHECK(+) like 'ERR%');

----
----
----- 
------
Production:
------
------
------
------
------
------
------
SELECT C.EXT_CT_NUMBER,
C.CONTRACT_TITLE,
EM.ENTRY_TYPE,
SB.SUB_BUDGET_NAME,
SII.BUDGET_ID,
(CASE WHEN IEA.ERROR_CODE = 'ERR001' THEN NULL  ELSE (SELECT F.FISCAL_YEAR FROM HHSA_APP.FISCAL_YEAR F WHERE F.FISCAL_YEAR_ID = B.FISCAL_YEAR_ID) END) as FISCAL_YEAR,
SII.PROVIDER_INVOICE_NUMBER,
SII.AGENCY_INVOICE_NUMBER,
  SID.INVOICE_AMOUNT,
(CASE WHEN IEA.ERROR_CODE IN ('ERR014','ERR015','ERR016','ERR017','ERR018','ERR019','ERR020','ERR028','ERR029') THEN SID.SUB_BUDGET_ID ELSE NULL END) as SUB_BUDGET_ID, 
 'Invoice' as ENTITY,  
 (CASE WHEN (IEA.ERROR_CODE IN ('ERR015','ERR016','ERR017','ERR018','ERR019','ERR028','ERR029')) THEN SID.ENTRY_TYPE_ID ELSE NULL END) as ENTRY_TYPE_ID,
(CASE WHEN  IEA.ERROR_CODE IN ('ERR016','ERR017','ERR018','ERR019','ERR029') THEN SID.LINE_ITEM_ID ELSE NULL END) as LINE_ITEM_ID, 
 (CASE WHEN  IEA.ERROR_CODE = 'ERR020' THEN SIASD.VEND_CUST_CD ELSE NULL END) as VEND_CUST_CD,
(CASE WHEN  IEA.ERROR_CODE IN ('ERR021','ERR022') THEN SIADD.BUDGET_ADVANCE_NUMBER ELSE NULL END) as BUDGET_ADVANCE_NUMBER,
IEA.ERROR_CODE as MSG_CD,
IEA.ERROR_DESC as MSG
FROM
(SELECT PK_ID, XML_CHECK FROM HHSA_APP.STG_INVOICE_INFORMATION WHERE XML_CHECK like 'ERR%' AND XML_CHECK IS NOT NULL
  UNION
SELECT FK_ID, XML_CHECK FROM HHSA_APP.STG_INVOICE_DETAILS  WHERE XML_CHECK like 'ERR%' AND XML_CHECK IS NOT NULL
  UNION
SELECT FK_ID, XML_CHECK FROM HHSA_APP.STG_INVOICE_ASSIGNMENT_DETAILS WHERE XML_CHECK like 'ERR%' AND XML_CHECK IS NOT NULL
  UNION
SELECT FK_ID, XML_CHECK FROM HHSA_APP.STG_INVOICE_ADVANCE_DETAILS  WHERE XML_CHECK like 'ERR%' AND XML_CHECK IS NOT NULL) IV,
    HHSA_APP.STG_INVOICE_INFORMATION SII,
    HHSA_APP.STG_INVOICE_DETAILS SID,
    HHSA_APP.STG_INVOICE_ASSIGNMENT_DETAILS SIASD,
    HHSA_APP.STG_INVOICE_ADVANCE_DETAILS SIADD,
    HHSA_APP.INTERFACE_ERROR_MASTER IEA,
    HHSA_APP.BUDGET B,
    HHSA_APP.CONTRACT C,
    HHSA_APP.ENTRY_TYPE_MASTER EM
    ,HHSA_APP.SUB_BUDGET SB
WHERE
    --IV.PK_ID = SII.PK_ID(+)
    SII.PK_ID = IV.PK_ID
AND IV.PK_ID = SID.FK_ID(+)
AND IV.PK_ID = SIASD.FK_ID(+)
AND IV.PK_ID = SIADD.FK_ID(+)
AND IV.XML_CHECK = IEA.ERROR_CODE(+)
AND SII.BUDGET_ID = B.BUDGET_ID(+)
AND B.CONTRACT_ID=C.CONTRACT_ID
AND SID.SUB_BUDGET_ID=SB.SUB_BUDGET_ID
AND EM.ENTRY_TYPE_ID=SID.ENTRY_TYPE_ID
AND SII.XML_CHECK like 'ERR%'
AND ( SID.XML_CHECK(+) like 'ERR%' AND SIASD.XML_CHECK(+) like 'ERR%' AND SIADD.XML_CHECK(+) like 'ERR%');

-----;
select * from HHSA_APP.MILESTONE
where MILESTONE_ID = 32064;

select * from HHSA_APP.MILESTONE
Where MILESTONE = 'PACS Milestone Advances'
and SUB_BUDGET_ID = 133276 ;

select * from HHSA_APP.SUB_BUDGET
where SUB_BUDGET_ID = 133276;

select * from HHSA_APP.BUDGET 
where BUDGET_ID = 26275;

Select * from 
HHSA_APP.INVOICE
where MODIFIED_BY_USERID = 'Interface_ETL'
ORDER BY CREATED_DATE desc;

-----;
----;Incident 
----Add the incident in the title of the email.
RE: Request INC000002384149
----
RemedyITSM_PRD@bb.nyc.gov ;
----;

select distinct '1 - ROW: 4) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = '0000939109' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('Sheltering Arms Children and Family Services, Inc.')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> '0000939109' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'Sheltering Arms Children and Family Services, Inc.' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = '0000939109';

----;kena issue;
select VENDOR_FMS_ID  from 
HHSA_APP.ref_apt_epin_master
where PROCUREMENT_AWARD_EPIN = '801SBS190044'
order by created_date desc;                     ----- VENDOR_FMS_ID = '0002588055;

INC000002508178
801SBS190044   ----;
The vendor code is listed with apostrophe and that needs to be removed in order to inflight-----;


select * from 
HHSA_APP.ref_apt_epin_master
where vendor_fms_id like '''%';

--register contract---;
select C.status_id, C.AGENCY_ID, C.AWARD_AGENCY_ID, C.* from 
HHSA_APP.contract C
where C.EXT_CT_NUMBER = 'CT10402019995920' or C.ext_epin = '04019D00CS087';    ----CONTRACT_TYPE+ID  =1  ----set STATUS_ID = 118;

----;
/* AWARDED_VENDOR_NAME / VENDOR_FMS_ID: */
select distinct '1 - ROW: 4) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = ' 0001118432' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('Sunnyside Community Services, Inc.')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> ' 0001118432' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'Sunnyside Community Services, Inc.' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = ' 0001118432';


/* Check if EPIN(s) exist in the  database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_AWARD_EPIN in('04018D0020217A001');


/* Check for latest INTEGRATION_ID, REF_APT_EPIN_ID and PROCUREMENT_EPIN_ID in REF_APT_EPIN_MASTER in the  database. */
select 'INTEGRATION_ID' as Col, max(INTEGRATION_ID) as MAX_VAL, cast (substr(max(INTEGRATION_ID),-10) as NUMBER) + 1 as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID like('MANUAL000%') union all
select 'REF_APT_EPIN_ID' as Col, cast( max(REF_APT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(REF_APT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER union all
select 'PROCUREMENT_EPIN_ID' as Col, cast( max(PROCUREMENT_EPIN_ID) as VARCHAR2(30)) as MAX_VAL, max(PROCUREMENT_EPIN_ID + 1) as MAX_PLUS_ONE from HHSA_APP.REF_APT_EPIN_MASTER;

MANUAL0000000006263
990015739
990015734

/* Check if INTEGRATION_ID(s) exist in the PRD database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where INTEGRATION_ID in('MANUAL0000000006264') union all

/* Check if REF_APT_EPIN_ID(s) exist in the PRD database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where REF_APT_EPIN_ID in('990015740') union all

/* Check if PROCUREMENT_EPIN_ID(s) exist in the PRD database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_EPIN_ID in('990015735');


/* AWARDED_VENDOR_NAME / VENDOR_FMS_ID: */
select distinct '1 - ROW: 4) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = ' 0001118432' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('Sunnyside Community Services, Inc.')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> ' 0001118432' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'Sunnyside Community Services, Inc.' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = ' 0001118432' union all 
select distinct '2 - ROW: 5) ' as NUM_ROW, CASE WHEN v.VEND_CUST_CD = ' 0000938968' AND upper(trim(o.ORGANIZATION_LEGAL_NAME)) = upper(trim('The Children''s Aid Society')) THEN 'VERIFIED' WHEN v.VEND_CUST_CD IS NULL THEN 'VEND_CUST_CD IS NULL' WHEN O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'ORGANIZATION_LEGAL_NAME IS NULL' WHEN v.VEND_CUST_CD IS NULL AND  O.ORGANIZATION_LEGAL_NAME IS NULL THEN 'BOTH NULLS' WHEN v.VEND_CUST_CD <> ' 0000938968' THEN 'VEND_CUST_CD NOT VERIFIED' WHEN O.ORGANIZATION_LEGAL_NAME <> 'SOMETHING' THEN 'CHECK ORGANIZATION_LEGAL_NAME' ELSE 'ELSE CASE' END AS "VERIFICATION",'The Children''s Aid Society' as NAME_PROVIDED, o.ORGANIZATION_LEGAL_NAME, v.LGL_NM as REF_VENDOR_V_LGL_NM, v.VEND_CUST_CD from HHSA_APP.ORGANIZATION o right outer join HHSA_APP.REF_VENDOR_V v on o.EIN_ID_NN = v.TIN where v.VEND_CUST_CD = ' 0000938968';

-------;
/* Check if EPIN(s) exist in the  database. This query should return 0 records. */
select * from HHSA_APP.REF_APT_EPIN_MASTER where PROCUREMENT_AWARD_EPIN in('04018D0020217A001','04018D0020213A001');

already exists;
04018D0020213A001


select status_id from HHSA_APP.CONTRACT
WHERE EXT_EPIN in('04018D0020217A001','04018D0020213A001')
order by created_date desc;
select * from HHSA_APP.STATUS_MASTER_R2_R3;
----------;
-----;




























































select C.CONTRACT_AMOUNT , C.*
from 
HHSA_APP.contract C
where C.ext_CT_NUmber = 'CT126020160002795'
and contract_type_id = 1
order by C.contract_type_id ;   ------1915192;




select sum(C.CONTRACT_AMOUNT)
from 
HHSA_APP.contract C
where C.ext_CT_NUmber = 'CT126020160002795'
and contract_type_id not in (1)
order by C.contract_type_id ; 






select * from HHSA_APP.REF_APT_EPIN_MASTER
where PROCUREMENT_AWARD_EPIN in ('26019P0099359', '26019P0099360', '26018I0005')
order by created_date desc;


SELECT * 
FROM 
HHSA_APP.STG_NON_APT_EPIN;









------
.
------------


------------------------------
